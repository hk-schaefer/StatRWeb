<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />


<meta name="author" content="Hartmut Schaefer" />

<meta name="date" content="2024-04-30" />

<title>Project 2</title>

<script src="site_libs/header-attrs-2.22/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/flatly.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<script src="site_libs/navigation-1.1/codefolding.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>



<style type="text/css">
  code {
    white-space: pre;
  }
  .sourceCode {
    overflow: visible;
  }
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  { color: #cccccc; background-color: #303030; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ffcfaf; } /* Alert */
code span.an { color: #7f9f7f; font-weight: bold; } /* Annotation */
code span.at { } /* Attribute */
code span.bn { color: #dca3a3; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #f0dfaf; } /* ControlFlow */
code span.ch { color: #dca3a3; } /* Char */
code span.cn { color: #dca3a3; font-weight: bold; } /* Constant */
code span.co { color: #7f9f7f; } /* Comment */
code span.cv { color: #7f9f7f; font-weight: bold; } /* CommentVar */
code span.do { color: #7f9f7f; } /* Documentation */
code span.dt { color: #dfdfbf; } /* DataType */
code span.dv { color: #dcdccc; } /* DecVal */
code span.er { color: #c3bf9f; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #c0bed1; } /* Float */
code span.fu { color: #efef8f; } /* Function */
code span.im { } /* Import */
code span.in { color: #7f9f7f; font-weight: bold; } /* Information */
code span.kw { color: #f0dfaf; } /* Keyword */
code span.op { color: #f0efd0; } /* Operator */
code span.ot { color: #efef8f; } /* Other */
code span.pp { color: #ffcfaf; font-weight: bold; } /* Preprocessor */
code span.sc { color: #dca3a3; } /* SpecialChar */
code span.ss { color: #cc9393; } /* SpecialString */
code span.st { color: #cc9393; } /* String */
code span.va { } /* Variable */
code span.vs { color: #cc9393; } /* VerbatimString */
code span.wa { color: #7f9f7f; font-weight: bold; } /* Warning */

.sourceCode .row {
  width: 100%;
}
.sourceCode {
  overflow-x: auto;
}
.code-folding-btn {
  margin-right: -30px;
}
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>







<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->
<style type="text/css">
.code-folding-btn { margin-bottom: 4px; }
</style>



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}

.tocify-subheader {
  display: inline;
}
.tocify-subheader .tocify-item {
  font-size: 0.95em;
}

</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">Portfolio: Statistics with R</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about1.html">ABOUT Inference</a>
</li>
<li>
  <a href="project1.html">Code: Inferential Stat</a>
</li>
<li>
  <a href="about2.html">ABOUT Linear Regression</a>
</li>
<li>
  <a href="project2.html">Code: Linear Reg.</a>
</li>
<li>
  <a href="about3.html">ABOUT Logistic Regression</a>
</li>
<li>
  <a href="project3.html">Code: Logistic Reg.</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">

<div class="btn-group pull-right float-right">
<button type="button" class="btn btn-default btn-xs btn-secondary btn-sm dropdown-toggle" data-toggle="dropdown" data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><span>Code</span> <span class="caret"></span></button>
<ul class="dropdown-menu dropdown-menu-right" style="min-width: 50px;">
<li><a id="rmd-show-all-code" href="#">Show All Code</a></li>
<li><a id="rmd-hide-all-code" href="#">Hide All Code</a></li>
</ul>
</div>



<h1 class="title toc-ignore">Project 2</h1>
<h4 class="author">Hartmut Schaefer</h4>
<h4 class="date">2024-04-30</h4>

</div>


<div id="linear-regression" class="section level1">
<h1>Linear Regression</h1>
<p><strong>Load packages</strong></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(statsr)</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a><span class="fu">library</span>(GGally)          <span class="co"># ------------------- extension of ggplot2</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a><span class="fu">library</span>(data.table)      <span class="co"># ------------------- table calculation</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a><span class="fu">library</span>(patchwork)       <span class="co"># ------------------- additional visualization tool</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a><span class="fu">library</span>(moments)         <span class="co"># ------------------- package to calculate Skewness</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a><span class="fu">library</span>(broom)           <span class="co"># ------------------- Convert stat obj. into tibbles</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a><span class="fu">library</span>(modeldata)       <span class="co"># ------------------- Sampling data for modeling</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a><span class="fu">library</span>(knitr)           <span class="co"># ------------------- support print of tables</span></span></code></pre></div>
<p><strong>Load data</strong></p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&quot;~/R/StatRWeb/Data/movies.Rdata&quot;</span>)</span></code></pre></div>
<p><br />
</p>
<div id="introduction" class="section level2">
<h2>Introduction</h2>
<div id="project-instruction" class="section level4">
<h4>Project Instruction</h4>
<p>Your boss has just acquired data about how much audiences and critics
like movies as well as many other variables about the movies. The
dataset includes information from <a
href="https://www.rottentomatoes.com/">Rotten Tomatos</a> and <a
href="https://www.imdb.com/">IMDB</a>.</p>
<p>She is interested in learning what attributes make a movie popular.
She is also interested in learning something new about movies. She wants
your team to figure it all out.</p>
<p>As part of this project you will complete exploratory data analysis
(EDA), modeling, and prediction.<br />
<br />
</p>
</div>
</div>
<div id="part-1-data" class="section level2">
<h2>Part 1: Data</h2>
<p>The dataset was provided by the course <a
href="https://www.coursera.org/specializations/statistics"><strong>Data
Analysis with R, Duke University</strong></a> hosted on Coursera.<br />
</p>
<p>The dataset is a sample set of 651 observations with 33 variables.
Below the list of all variables and their meanings. The column
“important” indicates whether the variable is worthwhile to be
considered in the model building or not.</p>
<table style="width:100%;">
<colgroup>
<col width="12%" />
<col width="72%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">variable_name</th>
<th align="left">meaning</th>
<th align="left">data_type</th>
<th align="left">important</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">title</td>
<td align="left">Title of movie</td>
<td align="left">chr</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">title_type</td>
<td align="left">Type of movie (Documentary, Feature Film, TV
Movie)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">genre</td>
<td align="left">Genre of movie (Action &amp; Adventure, Comedy,
Documentary, Drama, Horror, Mystery &amp; Suspense, Other)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">runtime</td>
<td align="left">Runtime of movie (in minutes)</td>
<td align="left">num</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">mpaa_rating</td>
<td align="left">MPAA rating of the movie (G, PG, PG-13, R,
Unrated)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">studio</td>
<td align="left">Studio that produced the movie</td>
<td align="left">factor</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">thtr_rel_year</td>
<td align="left">Year the movie is released in theaters</td>
<td align="left">num</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">thtr_rel_month</td>
<td align="left">Month the movie is released in theaters</td>
<td align="left">num</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">thtr_rel_day</td>
<td align="left">Day of the month the movie is released in theaters</td>
<td align="left">num</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">dvd_rel_year</td>
<td align="left">Year the movie is released on DVD</td>
<td align="left">num</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">dvd_rel_month</td>
<td align="left">Month the movie is released on DVD</td>
<td align="left">num</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">dvd_rel_day</td>
<td align="left">Day of the month the movie is released on DVD</td>
<td align="left">num</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">imdb_rating</td>
<td align="left">Rating on IMDB</td>
<td align="left">num</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">imdb_num_votes</td>
<td align="left">Number of votes on IMDB</td>
<td align="left">num</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">critics_rating</td>
<td align="left">Categorical variable for critics rating on Rotten
Tomatoes (Certified Fresh, Fresh, Rotten)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">critics_score</td>
<td align="left">Critics score on Rotten Tomatoes</td>
<td align="left">num</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">audience_rating</td>
<td align="left">Categorical variable for audience rating on Rotten
Tomatoes (Spilled, Upright)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">audience_score</td>
<td align="left">Audience score on Rotten Tomatoes</td>
<td align="left">num</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">best_pic_nom</td>
<td align="left">Whether or not the movie was nominated for a best
picture Oscar (no, yes)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">best_pic_win</td>
<td align="left">Whether or not the movie won a best picture Oscar (no,
yes)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">best_actor_win</td>
<td align="left">Whether or not one of the main actors in the movie ever
won an Oscar (no, yes)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">best_actress_win</td>
<td align="left">Whether or not one of the main actresses in the movie
ever won an Oscar (no, yes)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">best_dir_win</td>
<td align="left">Whether or not the director of the movie ever won an
Oscar (no, yes)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="even">
<td align="left">top200_box</td>
<td align="left">Whether or not the movie is in the Top 200 Box Office
list on BoxOfficeMojo (no, yes)</td>
<td align="left">factor</td>
<td align="left">yes</td>
</tr>
<tr class="odd">
<td align="left">director</td>
<td align="left">Director of the movie</td>
<td align="left">chr</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">actor1</td>
<td align="left">First main actor/actress in the abridged cast of the
movie</td>
<td align="left">chr</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">actor2</td>
<td align="left">Second main actor/actress in the abridged cast of the
movie</td>
<td align="left">chr</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">actor3</td>
<td align="left">Third main actor/actress in the abridged cast of the
movie</td>
<td align="left">chr</td>
<td align="left">no</td>
</tr>
<tr class="odd">
<td align="left">actor4</td>
<td align="left">Fourth main actor/actress in the abridged cast of the
movie</td>
<td align="left">chr</td>
<td align="left">no</td>
</tr>
<tr class="even">
<td align="left">actor5</td>
<td align="left">Fifth main actor/actress in the abridged cast of the
movie</td>
<td align="left">chr</td>
<td align="left">no</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
<div id="important-variables" class="section level4">
<h4>Important variables</h4>
<p><br />
</p>
<p><strong>IMBd rating</strong></p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="fu">summary</span>(movies<span class="sc">$</span>imdb_rating)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   1.900   5.900   6.600   6.493   7.300   9.000</code></pre>
<p><em>The Internet Movie Database</em> (IMDb) ratings are based on the
votes of registered users. Each user can vote only once, and the votes
are then aggregated and summarized into a single rating. <a
href="https://www.imdb.com/list/ls076459507/">Link</a><br />
</p>
<table>
<thead>
<tr class="header">
<th>IMDb Rating</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>1/10</code></td>
<td>god-awful</td>
</tr>
<tr class="even">
<td><code>2/10</code></td>
<td>awful</td>
</tr>
<tr class="odd">
<td><code>3/10</code></td>
<td>bad</td>
</tr>
<tr class="even">
<td><code>4/10</code></td>
<td>nice try, but no cigar</td>
</tr>
<tr class="odd">
<td><code>5/10</code></td>
<td>meh</td>
</tr>
<tr class="even">
<td><code>6/10</code></td>
<td>not bad</td>
</tr>
<tr class="odd">
<td><code>7/10</code></td>
<td>good</td>
</tr>
<tr class="even">
<td><code>8/10</code></td>
<td>very good</td>
</tr>
<tr class="odd">
<td><code>9/10</code></td>
<td>excellent</td>
</tr>
<tr class="even">
<td><code>10/10</code></td>
<td>masterpiece</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
<p><strong>IMDb number of votes</strong></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="fu">summary</span>(movies<span class="sc">$</span>imdb_num_votes)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##     180    4546   15116   57533   58301  893008</code></pre>
<p>The IMDb number of votes tells us about the movie’s popularity,
audience interest, quality of perception, and longevity. A high rating
with a significant number of votes is more credible than a high rating
with only a few votes. <a
href="https://www.bing.com/search?q=imdb+number+of+votes%2C+what+does+this+tell+us&amp;qs=n&amp;form=QBRE&amp;sp=-1&amp;ghc=1&amp;lq=0&amp;pq=imdb+number+of+votes%2C+what+does+this+tell+us&amp;sc=13-44&amp;sk=&amp;cvid=72B5BB35C4C34F08AE4318A75C6CC22B&amp;ghsh=0&amp;ghacc=0&amp;ghpl=">Link
MS Bing Copilot</a><br />
<br />
</p>
<p><strong>title_type</strong></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a>movies <span class="sc">%&gt;%</span> </span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>  <span class="fu">group_by</span>(title_type) <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   title_type       n
##   &lt;fct&gt;        &lt;int&gt;
## 1 Documentary     55
## 2 Feature Film   591
## 3 TV Movie         5</code></pre>
<p><br />
<br />
</p>
<p><strong>genre</strong></p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a>movies <span class="sc">%&gt;%</span> </span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>  <span class="fu">group_by</span>(genre) <span class="sc">%&gt;%</span> </span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 11 × 2
##    genre                         n
##    &lt;fct&gt;                     &lt;int&gt;
##  1 Action &amp; Adventure           65
##  2 Animation                     9
##  3 Art House &amp; International    14
##  4 Comedy                       87
##  5 Documentary                  52
##  6 Drama                       305
##  7 Horror                       23
##  8 Musical &amp; Performing Arts    12
##  9 Mystery &amp; Suspense           59
## 10 Other                        16
## 11 Science Fiction &amp; Fantasy     9</code></pre>
<p><br />
<br />
</p>
<p><strong>mpaa_rating</strong></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>movies <span class="sc">%&gt;%</span> </span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a>  <span class="fu">group_by</span>(mpaa_rating) <span class="sc">%&gt;%</span> </span>
<span id="cb11-3"><a href="#cb11-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   mpaa_rating     n
##   &lt;fct&gt;       &lt;int&gt;
## 1 G              19
## 2 NC-17           2
## 3 PG            118
## 4 PG-13         133
## 5 R             329
## 6 Unrated        50</code></pre>
<p>Motion Picture Association (MPA) rating and meaning: <a
href="https://en.wikipedia.org/wiki/Motion_Picture_Association_film_rating_system">Link</a></p>
<table>
<thead>
<tr class="header">
<th>Rating</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>G</code></td>
<td>general audience</td>
</tr>
<tr class="even">
<td><code>NC-17</code></td>
<td>adults only</td>
</tr>
<tr class="odd">
<td><code>PG</code></td>
<td>parental guidance suggested</td>
</tr>
<tr class="even">
<td><code>PG-13</code></td>
<td>parents strongly cautioned</td>
</tr>
<tr class="odd">
<td><code>R</code></td>
<td>restricted</td>
</tr>
<tr class="even">
<td><code>Unrated</code></td>
<td>not rated</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
<p><strong>studio</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a>fct_studio <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span> </span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a>  <span class="fu">group_by</span>(studio) <span class="sc">%&gt;%</span> </span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>  <span class="fu">arrange</span>(<span class="fu">desc</span>(n))</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a><span class="fu">head</span>(fct_studio)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 2
##   studio                               n
##   &lt;fct&gt;                            &lt;int&gt;
## 1 Paramount Pictures                  37
## 2 Warner Bros. Pictures               30
## 3 Sony Pictures Home Entertainment    27
## 4 Universal Pictures                  23
## 5 Warner Home Video                   19
## 6 20th Century Fox                    18</code></pre>
<p>212 distinct entries. Requires a lot of data cleaning, since several
of the same studio corporations are listed under different names. We
believe that the studio corporation will not influence the movie
popularity much and, therefore, drop this class.<br />
<br />
<br />
</p>
<p><strong>critics rating</strong></p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" tabindex="-1"></a> movies <span class="sc">%&gt;%</span> </span>
<span id="cb15-2"><a href="#cb15-2" tabindex="-1"></a>  <span class="fu">group_by</span>(critics_rating) <span class="sc">%&gt;%</span> </span>
<span id="cb15-3"><a href="#cb15-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 3 × 2
##   critics_rating      n
##   &lt;fct&gt;           &lt;int&gt;
## 1 Certified Fresh   135
## 2 Fresh             209
## 3 Rotten            307</code></pre>
<p>Tomatometer rating by critics and meaning: <a
href="https://www.rottentomatoes.com/about#whatisthetomatometer">Link</a></p>
<table>
<colgroup>
<col width="39%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th>Rating</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Certified Fresh</code></td>
<td>Tomatometer score &gt; 75% and &gt; 5 reviews from top critics,
&gt;40 reviews from critics</td>
</tr>
<tr class="even">
<td><code>Fresh</code></td>
<td>Tomatometer score &gt; 75% (not perfect but majority gave a thumb
up)</td>
</tr>
<tr class="odd">
<td><code>Rotten</code></td>
<td>Tomatometer score &lt; 60% (movie failed)</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
<p><strong>critics score</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" tabindex="-1"></a><span class="fu">summary</span>(movies<span class="sc">$</span>critics_score)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##    1.00   33.00   61.00   57.69   83.00  100.00</code></pre>
<p><br />
Score range: [0 - 100]</p>
<p><br />
<br />
</p>
<p><strong>audience_rating</strong></p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" tabindex="-1"></a> movies <span class="sc">%&gt;%</span> </span>
<span id="cb19-2"><a href="#cb19-2" tabindex="-1"></a>  <span class="fu">group_by</span>(audience_rating) <span class="sc">%&gt;%</span> </span>
<span id="cb19-3"><a href="#cb19-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 2 × 2
##   audience_rating     n
##   &lt;fct&gt;           &lt;int&gt;
## 1 Spilled           275
## 2 Upright           376</code></pre>
<p>Rotten Tomatoes rating by audience and meaning: <a
href="https://www.rottentomatoes.com/about#whatisthetomatometer">Link</a></p>
<table>
<colgroup>
<col width="39%" />
<col width="60%" />
</colgroup>
<thead>
<tr class="header">
<th>Rating</th>
<th>Meaning</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><code>Spilled</code></td>
<td>&lt; 60% of audience gave the movie a star rating of 3.5 or
higher</td>
</tr>
<tr class="even">
<td><code>Upright</code></td>
<td>&gt; 60% of audience gave the movie a star rating of 3.5 or
higher</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
<p><strong>audience_score</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" tabindex="-1"></a><span class="fu">summary</span>(movies<span class="sc">$</span>audience_score)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   11.00   46.00   65.00   62.36   80.00   97.00</code></pre>
<p><br />
</p>
<p>Score range: [0 - 100]<br />
<br />
</p>
</div>
<div id="check-scope-of-inference" class="section level4">
<h4>Check scope of inference</h4>
<p>The data were collected from 1970 to 2014. The ratings are a sample
from the audience on voluntary basis or from selected groups of movie
critics. So we can’t claim that they were collected by random sampling.
Usually, audience rating is biased towards the extremes. We therefore
cannot infer the statistics to the general population, i.e. movie
popularity for all people in the US. We can only infer the statistic on
new data collected under the same method as our sample dataset.<br />
</p>
<p><br />
<br />
<br />
</p>
</div>
</div>
<div id="part-2-research-question" class="section level2">
<h2>Part 2: Research question</h2>
<p><strong>Research question</strong><br />
</p>
<p>Can the Internet Movie Database (IMDb) rating be explained by factors
such as:</p>
<ol style="list-style-type: lower-alpha">
<li>type, genre, run-time, release timing</li>
<li>other rating measures (e.g, Tomato-measure)</li>
<li>nomination and awards<br />
</li>
</ol>
<p><strong>Task:</strong></p>
<p>Create a multiple linear model of best fit using only significant
strong predictors to answer the questions, of type:</p>
<p><span class="math display">\[
  \begin{aligned}
\widehat{imdb\_rating} &amp;= \hat{\beta}_0 + \hat{\beta}_1 \times {x_1}
+ \hat{\beta}_2 \times {x_2} + . . .\end{aligned}
\]</span></p>
<ul>
<li>Response (target) variable: <code>imdb_rating</code></li>
<li>Explanatory (predictor) variables: <code>all others</code><br />
</li>
</ul>
<p>For the model building and testing split the movie dataset by random
sampling into training and test datasets.<br />
<br />
</p>
<p><strong>Steps:</strong></p>
<ol style="list-style-type: decimal">
<li>Exploratory data analysis</li>
<li>Modeling</li>
<li>Prediction</li>
</ol>
<p><br />
<br />
<br />
</p>
</div>
<div id="part-3-eda" class="section level2">
<h2>Part 3: EDA</h2>
<div id="exploratory-data-analysis" class="section level4">
<h4>(Exploratory Data Analysis)</h4>
<p><strong>Prepare the dataset</strong></p>
<p>Remove variables that carry no information about the IMDb rating.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" tabindex="-1"></a>movies_select <span class="ot">&lt;-</span> movies <span class="sc">%&gt;%</span> </span>
<span id="cb23-2"><a href="#cb23-2" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>studio,</span>
<span id="cb23-3"><a href="#cb23-3" tabindex="-1"></a>         <span class="sc">-</span>director,</span>
<span id="cb23-4"><a href="#cb23-4" tabindex="-1"></a>         <span class="sc">-</span>actor1,</span>
<span id="cb23-5"><a href="#cb23-5" tabindex="-1"></a>         <span class="sc">-</span>actor2,</span>
<span id="cb23-6"><a href="#cb23-6" tabindex="-1"></a>         <span class="sc">-</span>actor3,</span>
<span id="cb23-7"><a href="#cb23-7" tabindex="-1"></a>         <span class="sc">-</span>actor4,</span>
<span id="cb23-8"><a href="#cb23-8" tabindex="-1"></a>         <span class="sc">-</span>actor5,</span>
<span id="cb23-9"><a href="#cb23-9" tabindex="-1"></a>         <span class="sc">-</span>imdb_url,</span>
<span id="cb23-10"><a href="#cb23-10" tabindex="-1"></a>         <span class="sc">-</span>rt_url)</span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>Check for NAs and replace</strong></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" tabindex="-1"></a><span class="co"># List NAs in all columns</span></span>
<span id="cb24-2"><a href="#cb24-2" tabindex="-1"></a><span class="fu">colSums</span>(<span class="fu">is.na</span>(movies_select))</span></code></pre></div>
<pre><code>##            title       title_type            genre          runtime 
##                0                0                0                1 
##      mpaa_rating    thtr_rel_year   thtr_rel_month     thtr_rel_day 
##                0                0                0                0 
##     dvd_rel_year    dvd_rel_month      dvd_rel_day      imdb_rating 
##                8                8                8                0 
##   imdb_num_votes   critics_rating    critics_score  audience_rating 
##                0                0                0                0 
##   audience_score     best_pic_nom     best_pic_win   best_actor_win 
##                0                0                0                0 
## best_actress_win     best_dir_win       top200_box 
##                0                0                0</code></pre>
<p>NAs in “dvd_rel_dates” are not relevant for the model as we will see
later. There is one NA in runtime of the movie, listed below.<br />
</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" tabindex="-1"></a><span class="co"># Substitue NA in variable runtime</span></span>
<span id="cb26-2"><a href="#cb26-2" tabindex="-1"></a>movies_select <span class="sc">%&gt;%</span> </span>
<span id="cb26-3"><a href="#cb26-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">is.na</span>(runtime)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-4"><a href="#cb26-4" tabindex="-1"></a>  <span class="fu">select</span>(title, genre, runtime)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   title              genre       runtime
##   &lt;chr&gt;              &lt;fct&gt;         &lt;dbl&gt;
## 1 The End of America Documentary      NA</code></pre>
<p>According to <a
href="https://en.wikipedia.org/wiki/The_End_of_America_(film)">Wikipedia</a>
the movie’s runtime is 73 min. We will replace NA with 73 min.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" tabindex="-1"></a>row_id <span class="ot">&lt;-</span> <span class="fu">which</span>(movies_select<span class="sc">$</span>title <span class="sc">==</span> <span class="st">&quot;The End of America&quot;</span>)</span>
<span id="cb28-2"><a href="#cb28-2" tabindex="-1"></a>col_id <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">colnames</span>(movies_select) <span class="sc">==</span> <span class="st">&quot;runtime&quot;</span>)</span>
<span id="cb28-3"><a href="#cb28-3" tabindex="-1"></a></span>
<span id="cb28-4"><a href="#cb28-4" tabindex="-1"></a>movies_select[row_id, col_id] <span class="ot">&lt;-</span> <span class="dv">73</span></span>
<span id="cb28-5"><a href="#cb28-5" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" tabindex="-1"></a>movies_select <span class="sc">%&gt;%</span> </span>
<span id="cb28-7"><a href="#cb28-7" tabindex="-1"></a>  <span class="fu">filter</span>(title <span class="sc">==</span> <span class="st">&quot;The End of America&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb28-8"><a href="#cb28-8" tabindex="-1"></a>  <span class="fu">select</span>(title, genre, runtime)</span></code></pre></div>
<pre><code>## # A tibble: 1 × 3
##   title              genre       runtime
##   &lt;chr&gt;              &lt;fct&gt;         &lt;dbl&gt;
## 1 The End of America Documentary      73</code></pre>
<p><br />
<br />
</p>
<p><strong>Add computed new variables</strong></p>
<p>For time series dependency analysis, we will create a date vector for
theater release:</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" tabindex="-1"></a><span class="co"># Make date : theater and dvd release date</span></span>
<span id="cb30-2"><a href="#cb30-2" tabindex="-1"></a>movies_select <span class="ot">&lt;-</span> movies_select <span class="sc">%&gt;%</span> </span>
<span id="cb30-3"><a href="#cb30-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">thtr_rel_date =</span> <span class="fu">make_date</span>(thtr_rel_year, thtr_rel_month, thtr_rel_day))</span></code></pre></div>
<p><br />
Re-arrange the column sequence and summarize the variables.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" tabindex="-1"></a>movies_select <span class="ot">&lt;-</span> movies_select <span class="sc">%&gt;%</span> </span>
<span id="cb31-2"><a href="#cb31-2" tabindex="-1"></a>  <span class="fu">select</span>(imdb_rating,</span>
<span id="cb31-3"><a href="#cb31-3" tabindex="-1"></a>         title_type,</span>
<span id="cb31-4"><a href="#cb31-4" tabindex="-1"></a>         genre,</span>
<span id="cb31-5"><a href="#cb31-5" tabindex="-1"></a>         runtime,</span>
<span id="cb31-6"><a href="#cb31-6" tabindex="-1"></a>         mpaa_rating,</span>
<span id="cb31-7"><a href="#cb31-7" tabindex="-1"></a>         imdb_num_votes,</span>
<span id="cb31-8"><a href="#cb31-8" tabindex="-1"></a>         critics_rating,</span>
<span id="cb31-9"><a href="#cb31-9" tabindex="-1"></a>         critics_score,</span>
<span id="cb31-10"><a href="#cb31-10" tabindex="-1"></a>         audience_rating,</span>
<span id="cb31-11"><a href="#cb31-11" tabindex="-1"></a>         audience_score,</span>
<span id="cb31-12"><a href="#cb31-12" tabindex="-1"></a>         best_pic_nom,</span>
<span id="cb31-13"><a href="#cb31-13" tabindex="-1"></a>         best_pic_win,</span>
<span id="cb31-14"><a href="#cb31-14" tabindex="-1"></a>         best_actor_win,</span>
<span id="cb31-15"><a href="#cb31-15" tabindex="-1"></a>         best_actress_win,</span>
<span id="cb31-16"><a href="#cb31-16" tabindex="-1"></a>         best_dir_win,</span>
<span id="cb31-17"><a href="#cb31-17" tabindex="-1"></a>         top200_box,</span>
<span id="cb31-18"><a href="#cb31-18" tabindex="-1"></a>         thtr_rel_year,</span>
<span id="cb31-19"><a href="#cb31-19" tabindex="-1"></a>         thtr_rel_month,</span>
<span id="cb31-20"><a href="#cb31-20" tabindex="-1"></a>         dvd_rel_year,</span>
<span id="cb31-21"><a href="#cb31-21" tabindex="-1"></a>         dvd_rel_month,</span>
<span id="cb31-22"><a href="#cb31-22" tabindex="-1"></a>         thtr_rel_date)</span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>Split data into training and test data</strong></p>
<p>To test our model(s) we will split the dataset into three portions.
One for training (70%), one for verification (20%) used during model
building and one for final testing (10%).</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">9876</span>)</span>
<span id="cb32-2"><a href="#cb32-2" tabindex="-1"></a>index <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">3</span>, <span class="fu">nrow</span>(movies_select), <span class="at">replace =</span> <span class="cn">TRUE</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.2</span>, <span class="fl">0.1</span>))</span>
<span id="cb32-3"><a href="#cb32-3" tabindex="-1"></a>train <span class="ot">&lt;-</span> movies_select[index <span class="sc">==</span> <span class="dv">1</span>,]</span>
<span id="cb32-4"><a href="#cb32-4" tabindex="-1"></a>verify <span class="ot">&lt;-</span> movies_select[index <span class="sc">==</span> <span class="dv">2</span>,]</span>
<span id="cb32-5"><a href="#cb32-5" tabindex="-1"></a>test <span class="ot">&lt;-</span> movies_select[index <span class="sc">==</span> <span class="dv">3</span>,]</span></code></pre></div>
<p><br />
</p>
<p>Add row-id to the train dataset, required for outlier identification
and removal.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" tabindex="-1"></a><span class="co"># Add row-id</span></span>
<span id="cb33-2"><a href="#cb33-2" tabindex="-1"></a>train <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb33-3"><a href="#cb33-3" tabindex="-1"></a>  <span class="fu">rowid_to_column</span>(<span class="at">var=</span><span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
<p><br />
<br />
</p>
</div>
<div id="eda-numerical-variables" class="section level3">
<h3>EDA numerical variables</h3>
<p>First, let’s explore how much each independent variable contributes
to the outcome of the response variable by single linear regression. We
also want to check for linearity, distributions and outliers.<br />
</p>
<p>Below an overview of all numerical variables showing their
relationships and correlation values.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" tabindex="-1"></a><span class="co"># Compare variables</span></span>
<span id="cb34-2"><a href="#cb34-2" tabindex="-1"></a><span class="fu">ggpairs</span>(train, <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">7</span>,<span class="dv">9</span>,<span class="dv">11</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-25-1.png" width="768" /><br />
We can see from the table that the correlation between the response
variable <code>imdb_rating</code> and the variables
<code>runtime</code>, <code>imdb_num_votes</code> is weak, but strong
for variables <code>critics_score</code> and
<code>audience_score</code>. We also see, that there is a strong
correlation (colinearity) between <code>critics_score</code> and
<code>audience_score</code>.<br />
<br />
<br />
</p>
<p><strong>0. imdb_rating (response variable)</strong></p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb35-2"><a href="#cb35-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> imdb_rating)) <span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="dv">0</span>,<span class="dv">10</span>)<span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;IMDb_rating - distribution&quot;</span>)</span>
<span id="cb35-6"><a href="#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="#cb35-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb35-8"><a href="#cb35-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating)) <span class="sc">+</span></span>
<span id="cb35-9"><a href="#cb35-9" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb35-10"><a href="#cb35-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb35-11"><a href="#cb35-11" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb35-12"><a href="#cb35-12" tabindex="-1"></a></span>
<span id="cb35-13"><a href="#cb35-13" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-26-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" tabindex="-1"></a><span class="fu">summary</span>(train<span class="sc">$</span>imdb_rating)</span></code></pre></div>
<pre><code>##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
##   2.300   5.900   6.700   6.503   7.300   8.500</code></pre>
<p><br />
</p>
<p>The distribution is slightly left-skewed. The overall shape is close
to a bell curve. We have three extreme data points smaller than
3.0. </p>
<p>Extreme data points in <code>imdb_rating</code>;</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" tabindex="-1"></a><span class="co"># Extreme data points: &lt; 3</span></span>
<span id="cb38-2"><a href="#cb38-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb38-3"><a href="#cb38-3" tabindex="-1"></a>  <span class="fu">filter</span>(imdb_rating <span class="sc">&lt;</span> <span class="dv">3</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb38-4"><a href="#cb38-4" tabindex="-1"></a>  <span class="fu">select</span>(ID, imdb_rating, title_type, genre, runtime)</span></code></pre></div>
<pre><code>## # A tibble: 3 × 5
##      ID imdb_rating title_type   genre              runtime
##   &lt;int&gt;       &lt;dbl&gt; &lt;fct&gt;        &lt;fct&gt;                &lt;dbl&gt;
## 1    36         2.7 Feature Film Drama                  106
## 2   133         2.4 Feature Film Action &amp; Adventure     118
## 3   246         2.3 Feature Film Action &amp; Adventure      86</code></pre>
<p>These data points have the ID 36, 133 and 246. We will follow up on
them later in the analysis.<br />
</p>
<p>Next, we will check each single relationship between response and
predictor variable for linearity and distribution. We will then identify
and remove extreme or potential influential points and decide whether to
include the variable as potential predictor in the model.<br />
<br />
</p>
<p><strong>1. imdb_rating ~ runtime</strong></p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" tabindex="-1"></a><span class="co"># ---------------------------------------------------- check runtime (raw data)</span></span>
<span id="cb40-2"><a href="#cb40-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb40-3"><a href="#cb40-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> (runtime))) <span class="sc">+</span> </span>
<span id="cb40-4"><a href="#cb40-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-5"><a href="#cb40-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Runtime (raw data)&quot;</span>)</span>
<span id="cb40-6"><a href="#cb40-6" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb40-8"><a href="#cb40-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> (runtime), <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb40-9"><a href="#cb40-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb40-10"><a href="#cb40-10" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb40-12"><a href="#cb40-12" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" tabindex="-1"></a></span>
<span id="cb40-14"><a href="#cb40-14" tabindex="-1"></a><span class="co"># ---------------------------------------------- check runtime (log-transform)</span></span>
<span id="cb40-15"><a href="#cb40-15" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb40-16"><a href="#cb40-16" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(runtime))) <span class="sc">+</span> </span>
<span id="cb40-17"><a href="#cb40-17" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-18"><a href="#cb40-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Runtime (log(raw data))&quot;</span>)</span>
<span id="cb40-19"><a href="#cb40-19" tabindex="-1"></a></span>
<span id="cb40-20"><a href="#cb40-20" tabindex="-1"></a></span>
<span id="cb40-21"><a href="#cb40-21" tabindex="-1"></a>p4 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb40-22"><a href="#cb40-22" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(runtime), <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb40-23"><a href="#cb40-23" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb40-24"><a href="#cb40-24" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb40-25"><a href="#cb40-25" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb40-26"><a href="#cb40-26" tabindex="-1"></a></span>
<span id="cb40-27"><a href="#cb40-27" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3 <span class="sc">+</span> p4) </span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-28-1.png" width="768" /></p>
<p><br />
The raw data show extremes on the left and right side and strong
deviation from linearity. The raw data are not suitable to be used
directly in the linear model. We, therefore, will modify the predictor
variable by applying different transformations.<br />
</p>
<p>Log transform of raw data normalizes the distribution, but we still
see non-linearity issues on the extreme ends on left and right. We will
therefore truncated the most extreme data points. The thresholds were
selected by trail and error to maximize the effect while keeping the
number of truncated data points to a minimum.<br />
</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" tabindex="-1"></a><span class="co"># truncate runtime</span></span>
<span id="cb41-2"><a href="#cb41-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb41-3"><a href="#cb41-3" tabindex="-1"></a>  <span class="fu">filter</span>(runtime <span class="sc">&lt;</span> <span class="dv">75</span> <span class="sc">|</span> runtime <span class="sc">&gt;</span> <span class="dv">180</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb41-4"><a href="#cb41-4" tabindex="-1"></a>  <span class="fu">select</span>(ID, imdb_rating, title_type, genre, runtime)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##      ID imdb_rating title_type   genre       runtime
##   &lt;int&gt;       &lt;dbl&gt; &lt;fct&gt;        &lt;fct&gt;         &lt;dbl&gt;
## 1    38         7.3 Documentary  Documentary      65
## 2   166         7.8 Documentary  Documentary     267
## 3   204         6.7 Feature Film Animation        74
## 4   238         7.5 Documentary  Documentary      73
## 5   334         6.4 Feature Film Animation        68
## 6   415         7   Documentary  Documentary      40</code></pre>
<p>Only six data points are outside of range 75-180 min runtime. We will
truncate runtime accordingly.<br />
</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" tabindex="-1"></a><span class="co"># Truncate runtime (&lt;75 -&gt; 75, &gt;180 -&gt; 180)</span></span>
<span id="cb43-2"><a href="#cb43-2" tabindex="-1"></a>train<span class="sc">$</span>runtime <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(train<span class="sc">$</span>runtime <span class="sc">&lt;</span> <span class="dv">75</span>, <span class="dv">75</span>, train<span class="sc">$</span>runtime)</span>
<span id="cb43-3"><a href="#cb43-3" tabindex="-1"></a>train<span class="sc">$</span>runtime <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(train<span class="sc">$</span>runtime <span class="sc">&gt;</span> <span class="dv">180</span>, <span class="dv">180</span>, train<span class="sc">$</span>runtime)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" tabindex="-1"></a><span class="co"># ---------------------------------------------- check runtime (cutoff extremes)</span></span>
<span id="cb44-2"><a href="#cb44-2" tabindex="-1"></a>p5 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb44-3"><a href="#cb44-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> (runtime))) <span class="sc">+</span> </span>
<span id="cb44-4"><a href="#cb44-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">fill =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-5"><a href="#cb44-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Runtime (removed extremes)&quot;</span>,</span>
<span id="cb44-6"><a href="#cb44-6" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;runtime between 75 to 180 min&quot;</span>)</span>
<span id="cb44-7"><a href="#cb44-7" tabindex="-1"></a></span>
<span id="cb44-8"><a href="#cb44-8" tabindex="-1"></a>p6 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb44-9"><a href="#cb44-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> (runtime), <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb44-11"><a href="#cb44-11" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F,  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-12"><a href="#cb44-12" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F,  <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb44-13"><a href="#cb44-13" tabindex="-1"></a>        </span>
<span id="cb44-14"><a href="#cb44-14" tabindex="-1"></a></span>
<span id="cb44-15"><a href="#cb44-15" tabindex="-1"></a><span class="co"># ------------------------------ check runtime (cutoff extremes + log-transform)</span></span>
<span id="cb44-16"><a href="#cb44-16" tabindex="-1"></a>p7 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb44-17"><a href="#cb44-17" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(runtime))) <span class="sc">+</span> </span>
<span id="cb44-18"><a href="#cb44-18" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">&quot;darkgray&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-19"><a href="#cb44-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Runtime (removed extremes + log)&quot;</span>,</span>
<span id="cb44-20"><a href="#cb44-20" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;runtime between 75 to 180 min&quot;</span>)</span>
<span id="cb44-21"><a href="#cb44-21" tabindex="-1"></a></span>
<span id="cb44-22"><a href="#cb44-22" tabindex="-1"></a></span>
<span id="cb44-23"><a href="#cb44-23" tabindex="-1"></a>p8 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb44-24"><a href="#cb44-24" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(runtime), <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb44-25"><a href="#cb44-25" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb44-26"><a href="#cb44-26" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb44-27"><a href="#cb44-27" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)</span>
<span id="cb44-28"><a href="#cb44-28" tabindex="-1"></a></span>
<span id="cb44-29"><a href="#cb44-29" tabindex="-1"></a>(p5 <span class="sc">+</span> p6) <span class="sc">/</span> (p7 <span class="sc">+</span> p8)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-32-1.png" width="768" /><br />
The regression line is now linear, with some small deviation on both
ends. The distribution is still right-skewed and the data points are
concentrated on the left side. Applying a log-transform on top of the
removed extreme version improves the data point distribution. The
linearity of the regression line is acceptable.<br />
<br />
</p>
<p>Simple model evaluation:</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb45-2"><a href="#cb45-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> <span class="fu">log</span>(runtime), <span class="at">data =</span> train)</span>
<span id="cb45-3"><a href="#cb45-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ log(runtime), data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3043 -0.6065  0.0927  0.7792  2.2584 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   -0.9252     1.4467  -0.640    0.523    
## log(runtime)   1.5992     0.3113   5.138  4.1e-07 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.063 on 463 degrees of freedom
## Multiple R-squared:  0.05394,    Adjusted R-squared:  0.0519 
## F-statistic:  26.4 on 1 and 463 DF,  p-value: 4.103e-07</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb47-2"><a href="#cb47-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-34-1.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-34-2.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-34-3.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-34-4.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-34-5.png" width="672" /><br />
</p>
<p>Residuals are distributed evenly over the range. Variable explains
5.39 % of response. It is a weak estimator but it will be used in the
model. There are about 3 outliers and 1 influential point that may have
to be removed.<br />
</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" tabindex="-1"></a><span class="co"># Register influential points and outliers</span></span>
<span id="cb48-2"><a href="#cb48-2" tabindex="-1"></a>v1_runtime <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">133</span>, <span class="dv">246</span>, <span class="dv">249</span>)</span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>2. imdb_rating ~ imdb_num_votes</strong></p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" tabindex="-1"></a><span class="co"># -------------------------------------------------- check imdb_num_votes (raw)</span></span>
<span id="cb49-2"><a href="#cb49-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb49-3"><a href="#cb49-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> imdb_num_votes)) <span class="sc">+</span></span>
<span id="cb49-4"><a href="#cb49-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2500</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-5"><a href="#cb49-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;IMDb votes (raw data)&quot;</span>)</span>
<span id="cb49-6"><a href="#cb49-6" tabindex="-1"></a></span>
<span id="cb49-7"><a href="#cb49-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb49-8"><a href="#cb49-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_num_votes)) <span class="sc">+</span></span>
<span id="cb49-9"><a href="#cb49-9" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb49-10"><a href="#cb49-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-11"><a href="#cb49-11" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb49-12"><a href="#cb49-12" tabindex="-1"></a></span>
<span id="cb49-13"><a href="#cb49-13" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb49-14"><a href="#cb49-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> (imdb_num_votes), <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb49-15"><a href="#cb49-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb49-16"><a href="#cb49-16" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-17"><a href="#cb49-17" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb49-18"><a href="#cb49-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb49-19"><a href="#cb49-19" tabindex="-1"></a></span>
<span id="cb49-20"><a href="#cb49-20" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-36-1.png" width="768" /></p>
<p><br />
The distribution is extremely right skewed. The regression line is
dominated by several extreme points (right) with large leverage and high
influence. We cannot use this data in its raw form for linear
regression. We will try to remove to mitigate the influence of the
extreme data points points by truncation, cut-off and
log-transformation.<br />
</p>
<p>Calculate threshold for cut_off: threshold = 3rd quartile + 1.5 *
IQR</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" tabindex="-1"></a><span class="co"># Calculate cut_off margin for extreme values (1.5 * IQR)</span></span>
<span id="cb50-2"><a href="#cb50-2" tabindex="-1"></a>imdb_extreme <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb50-3"><a href="#cb50-3" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">iqr =</span> <span class="fu">IQR</span>(imdb_num_votes),</span>
<span id="cb50-4"><a href="#cb50-4" tabindex="-1"></a>            <span class="at">q3 =</span> <span class="fu">quantile</span>(imdb_num_votes, <span class="fl">0.75</span>),</span>
<span id="cb50-5"><a href="#cb50-5" tabindex="-1"></a>            <span class="at">cut_off =</span> q3 <span class="sc">+</span> <span class="fl">1.5</span> <span class="sc">*</span> iqr</span>
<span id="cb50-6"><a href="#cb50-6" tabindex="-1"></a>            )</span>
<span id="cb50-7"><a href="#cb50-7" tabindex="-1"></a>cut_off <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(imdb_extreme<span class="sc">$</span>cut_off)</span>
<span id="cb50-8"><a href="#cb50-8" tabindex="-1"></a>cut_off</span></code></pre></div>
<pre><code>## [1] 129892</code></pre>
<p>The cutoff value for extreme values is at about 130,000.</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" tabindex="-1"></a><span class="co"># Number of values to be affected by cut_off</span></span>
<span id="cb52-2"><a href="#cb52-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb52-3"><a href="#cb52-3" tabindex="-1"></a>  <span class="fu">filter</span>(imdb_num_votes <span class="sc">&gt;=</span> cut_off) <span class="sc">%&gt;%</span> </span>
<span id="cb52-4"><a href="#cb52-4" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>())</span></code></pre></div>
<pre><code>## # A tibble: 1 × 1
##       n
##   &lt;int&gt;
## 1    50</code></pre>
<p><br />
</p>
<p>Using the upper cut-off threshold would remove 50 data points. We
would only do this if the variable shows a high correlation to the
response variable.<br />
</p>
<p><strong>Transformation 1: Truncation`</strong></p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" tabindex="-1"></a><span class="co"># truncating</span></span>
<span id="cb54-2"><a href="#cb54-2" tabindex="-1"></a>train_trun <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb54-3"><a href="#cb54-3" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb54-4"><a href="#cb54-4" tabindex="-1"></a>    <span class="at">imdb_num_votes_trun =</span> <span class="fu">case_when</span>(</span>
<span id="cb54-5"><a href="#cb54-5" tabindex="-1"></a>      imdb_num_votes <span class="sc">&lt;</span> cut_off <span class="sc">~</span> imdb_num_votes,</span>
<span id="cb54-6"><a href="#cb54-6" tabindex="-1"></a>      imdb_num_votes <span class="sc">&gt;=</span> cut_off <span class="sc">~</span> cut_off)</span>
<span id="cb54-7"><a href="#cb54-7" tabindex="-1"></a>  )</span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" tabindex="-1"></a><span class="co"># ----------------------------------------- check imdb_num_votes (truncated)</span></span>
<span id="cb55-2"><a href="#cb55-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train_trun <span class="sc">%&gt;%</span> </span>
<span id="cb55-3"><a href="#cb55-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> imdb_num_votes_trun)) <span class="sc">+</span></span>
<span id="cb55-4"><a href="#cb55-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2500</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb55-5"><a href="#cb55-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;IMDb votes (truncated at 130K)&quot;</span>)</span>
<span id="cb55-6"><a href="#cb55-6" tabindex="-1"></a></span>
<span id="cb55-7"><a href="#cb55-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train_trun <span class="sc">%&gt;%</span> </span>
<span id="cb55-8"><a href="#cb55-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_num_votes_trun)) <span class="sc">+</span></span>
<span id="cb55-9"><a href="#cb55-9" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb55-10"><a href="#cb55-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb55-11"><a href="#cb55-11" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb55-12"><a href="#cb55-12" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> train_trun <span class="sc">%&gt;%</span> </span>
<span id="cb55-14"><a href="#cb55-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> (imdb_num_votes_trun), <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb55-15"><a href="#cb55-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb55-16"><a href="#cb55-16" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb55-17"><a href="#cb55-17" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb55-18"><a href="#cb55-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb55-19"><a href="#cb55-19" tabindex="-1"></a></span>
<span id="cb55-20"><a href="#cb55-20" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-42-1.png" width="768" /></p>
<p><br />
</p>
<p>Model with truncated data</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" tabindex="-1"></a><span class="co"># simple model</span></span>
<span id="cb56-2"><a href="#cb56-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> (imdb_num_votes_trun), <span class="at">data =</span> train_trun)</span>
<span id="cb56-3"><a href="#cb56-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ (imdb_num_votes_trun), data = train_trun)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.5653 -0.5584  0.0885  0.7327  2.2440 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)         6.239e+00  6.388e-02  97.673  &lt; 2e-16 ***
## imdb_num_votes_trun 7.144e-06  1.121e-06   6.372 4.51e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.048 on 463 degrees of freedom
## Multiple R-squared:  0.08062,    Adjusted R-squared:  0.07864 
## F-statistic:  40.6 on 1 and 463 DF,  p-value: 4.51e-10</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span></code></pre></div>
<p><br />
<code>imdb_num_votes_trun</code> slope coefficient is almost “zero”. R2
= 8.06. The variable has not much information about the response
variable.<br />
<br />
</p>
<p><strong>Transformation 2: Cut-off extreme data from
<code>imdb_num_votes</code></strong></p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" tabindex="-1"></a><span class="co"># ----------------------------------------- check imdb_num_votes (remove extreme)</span></span>
<span id="cb59-2"><a href="#cb59-2" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb59-4"><a href="#cb59-4" tabindex="-1"></a>  <span class="fu">filter</span>(imdb_num_votes <span class="sc">&lt;=</span> cut_off) <span class="sc">%&gt;%</span> </span>
<span id="cb59-5"><a href="#cb59-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> imdb_num_votes)) <span class="sc">+</span></span>
<span id="cb59-6"><a href="#cb59-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">2500</span>, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-7"><a href="#cb59-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;IMDb votes (removed extreme)&quot;</span>)</span>
<span id="cb59-8"><a href="#cb59-8" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb59-10"><a href="#cb59-10" tabindex="-1"></a>  <span class="fu">filter</span>(imdb_num_votes <span class="sc">&lt;=</span> cut_off) <span class="sc">%&gt;%</span> </span>
<span id="cb59-11"><a href="#cb59-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_num_votes)) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb59-13"><a href="#cb59-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-14"><a href="#cb59-14" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb59-15"><a href="#cb59-15" tabindex="-1"></a></span>
<span id="cb59-16"><a href="#cb59-16" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb59-17"><a href="#cb59-17" tabindex="-1"></a>  <span class="fu">filter</span>(imdb_num_votes <span class="sc">&lt;=</span> cut_off) <span class="sc">%&gt;%</span> </span>
<span id="cb59-18"><a href="#cb59-18" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> imdb_num_votes, <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb59-19"><a href="#cb59-19" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb59-20"><a href="#cb59-20" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-21"><a href="#cb59-21" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb59-22"><a href="#cb59-22" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb59-23"><a href="#cb59-23" tabindex="-1"></a></span>
<span id="cb59-24"><a href="#cb59-24" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-46-1.png" width="768" /></p>
<p><br />
</p>
<p>Model with filtered data</p>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" tabindex="-1"></a><span class="co"># simple model</span></span>
<span id="cb60-2"><a href="#cb60-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> (imdb_num_votes), </span>
<span id="cb60-3"><a href="#cb60-3" tabindex="-1"></a>                       <span class="at">data =</span>  <span class="fu">filter</span>(train, imdb_num_votes <span class="sc">&lt;=</span> cut_off))</span>
<span id="cb60-4"><a href="#cb60-4" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ (imdb_num_votes), data = filter(train, 
##     imdb_num_votes &lt;= cut_off))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.3450 -0.5955  0.0949  0.7707  2.1993 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    6.291e+00  6.928e-02  90.814   &lt;2e-16 ***
## imdb_num_votes 4.037e-06  1.729e-06   2.335     0.02 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.08 on 413 degrees of freedom
## Multiple R-squared:  0.01303,    Adjusted R-squared:  0.01064 
## F-statistic:  5.45 on 1 and 413 DF,  p-value: 0.02004</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span></code></pre></div>
<p><br />
<code>imdb_num_votes_trun</code> slope coefficient is almost “zero”. R2
= 1.3. F-statistic = 5.5. The variable has almost no information about
the response variable.<br />
<br />
</p>
<p><strong>Transformation 3: Log10 of
<code>imdb_num_votes</code></strong></p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" tabindex="-1"></a><span class="co"># ----------------------------------------- check imdb_num_votes (log-trans)</span></span>
<span id="cb63-2"><a href="#cb63-2" tabindex="-1"></a></span>
<span id="cb63-3"><a href="#cb63-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb63-4"><a href="#cb63-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(imdb_num_votes))) <span class="sc">+</span></span>
<span id="cb63-5"><a href="#cb63-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">fill =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-6"><a href="#cb63-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;IMDb votes (log10-transformed)&quot;</span>)</span>
<span id="cb63-7"><a href="#cb63-7" tabindex="-1"></a></span>
<span id="cb63-8"><a href="#cb63-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb63-9"><a href="#cb63-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">log10</span>(imdb_num_votes))) <span class="sc">+</span></span>
<span id="cb63-10"><a href="#cb63-10" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb63-11"><a href="#cb63-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb63-13"><a href="#cb63-13" tabindex="-1"></a></span>
<span id="cb63-14"><a href="#cb63-14" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb63-15"><a href="#cb63-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(imdb_num_votes), <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb63-16"><a href="#cb63-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb63-17"><a href="#cb63-17" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-18"><a href="#cb63-18" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb63-19"><a href="#cb63-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb63-20"><a href="#cb63-20" tabindex="-1"></a></span>
<span id="cb63-21"><a href="#cb63-21" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> p3</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-49-1.png" width="768" /></p>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" tabindex="-1"></a><span class="co"># simple model</span></span>
<span id="cb64-2"><a href="#cb64-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> <span class="fu">log10</span>(imdb_num_votes), <span class="at">data =</span> train)</span>
<span id="cb64-3"><a href="#cb64-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ log10(imdb_num_votes), data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.4344 -0.5373  0.1093  0.7626  2.2633 
## 
## Coefficients:
##                       Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)             5.1670     0.2995  17.250  &lt; 2e-16 ***
## log10(imdb_num_votes)   0.3171     0.0701   4.523 7.75e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.07 on 463 degrees of freedom
## Multiple R-squared:  0.04232,    Adjusted R-squared:  0.04025 
## F-statistic: 20.46 on 1 and 463 DF,  p-value: 7.745e-06</code></pre>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb66-2"><a href="#cb66-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-51-1.png" width="672" /></p>
<p>For log10 transform residuals show a remaining parabolic pattern.
Truncated, cut-off and log10-transform don’t show any convincing linear
relationship. We will, therefore, drop this variable from the
model.<br />
<br />
</p>
<p><strong>3. imdb_rating ~ critics_score</strong></p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" tabindex="-1"></a><span class="co"># check critics_score</span></span>
<span id="cb67-2"><a href="#cb67-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb67-3"><a href="#cb67-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> critics_score)) <span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb67-5"><a href="#cb67-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Critics_score&quot;</span>)</span>
<span id="cb67-6"><a href="#cb67-6" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb67-8"><a href="#cb67-8" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> critics_score))<span class="sc">+</span></span>
<span id="cb67-9"><a href="#cb67-9" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb67-10"><a href="#cb67-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb67-11"><a href="#cb67-11" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb67-12"><a href="#cb67-12" tabindex="-1"></a></span>
<span id="cb67-13"><a href="#cb67-13" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb67-14"><a href="#cb67-14" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> critics_score, <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb67-15"><a href="#cb67-15" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb67-16"><a href="#cb67-16" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb67-17"><a href="#cb67-17" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb67-18"><a href="#cb67-18" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb67-19"><a href="#cb67-19" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-53-1.png" width="768" /></p>
<p><br />
Approximately good linear relationship with response variable/</p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> (critics_score), <span class="at">data =</span> train)</span>
<span id="cb68-2"><a href="#cb68-2" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ (critics_score), data = train)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.57874 -0.39075  0.04064  0.42164  2.12281 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   4.771374   0.070259   67.91   &lt;2e-16 ***
## critics_score 0.029845   0.001085   27.52   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.6734 on 463 degrees of freedom
## Multiple R-squared:  0.6206, Adjusted R-squared:  0.6197 
## F-statistic: 757.2 on 1 and 463 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb70-2"><a href="#cb70-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-55-1.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-55-2.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-55-3.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-55-4.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-55-5.png" width="672" /></p>
<p><br />
</p>
<p>Good linear approximation, random residuals, nearly normal. Variable
explains 62.06 % of response. Good candidate for the model. There are 2
influential points and 1 outlier that may have to be removed.<br />
</p>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" tabindex="-1"></a><span class="co"># Register influential points and outliers</span></span>
<span id="cb71-2"><a href="#cb71-2" tabindex="-1"></a>v2_critics_score <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">133</span>, <span class="dv">246</span>)</span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>4. imdb_rating ~ audience_score</strong></p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" tabindex="-1"></a><span class="co"># check audience_score</span></span>
<span id="cb72-2"><a href="#cb72-2" tabindex="-1"></a></span>
<span id="cb72-3"><a href="#cb72-3" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb72-4"><a href="#cb72-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> audience_score)) <span class="sc">+</span></span>
<span id="cb72-5"><a href="#cb72-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">fill =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb72-6"><a href="#cb72-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;audience_score&quot;</span>)</span>
<span id="cb72-7"><a href="#cb72-7" tabindex="-1"></a></span>
<span id="cb72-8"><a href="#cb72-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb72-9"><a href="#cb72-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> audience_score))<span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb72-11"><a href="#cb72-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb72-12"><a href="#cb72-12" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb72-13"><a href="#cb72-13" tabindex="-1"></a></span>
<span id="cb72-14"><a href="#cb72-14" tabindex="-1"></a>p3 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb72-15"><a href="#cb72-15" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> audience_score, <span class="at">y =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb72-16"><a href="#cb72-16" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb72-17"><a href="#cb72-17" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F,  <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb72-18"><a href="#cb72-18" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb72-19"><a href="#cb72-19" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;&quot;</span>)</span>
<span id="cb72-20"><a href="#cb72-20" tabindex="-1"></a></span>
<span id="cb72-21"><a href="#cb72-21" tabindex="-1"></a>(p1 <span class="sc">+</span> p2) <span class="sc">/</span> (p3)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-57-1.png" width="768" /></p>
<p><br />
Good linear approximation.<br />
</p>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> (audience_score), <span class="at">data =</span> train)</span>
<span id="cb73-2"><a href="#cb73-2" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ (audience_score), data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.1929 -0.2069  0.0844  0.2958  1.1693 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    3.578332   0.079735   44.88   &lt;2e-16 ***
## audience_score 0.046486   0.001205   38.58   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.5325 on 463 degrees of freedom
## Multiple R-squared:  0.7627, Adjusted R-squared:  0.7622 
## F-statistic:  1488 on 1 and 463 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb75-2"><a href="#cb75-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-59-1.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-59-2.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-59-3.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-59-4.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-59-5.png" width="672" /></p>
<p><br />
Random residual distribution but with small funnel effect, nearly
normal, no extreme values. Variable explains 76.27 % of response. Good
candidate for model. There are 3 outliers and 2 influential points that
may have to be removed.<br />
</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" tabindex="-1"></a><span class="co"># Register influential points and outliers</span></span>
<span id="cb76-2"><a href="#cb76-2" tabindex="-1"></a>v3_audience_score <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">36</span>, <span class="dv">133</span>, <span class="dv">246</span>, <span class="dv">94</span>, <span class="dv">155</span>)</span></code></pre></div>
<p><br />
<br />
</p>
</div>
<div id="eda-categorical-variables" class="section level3">
<h3>EDA categorical variables</h3>
<p>Overview of relationships between response variable
<code>imdb_rating</code> and categorical variables.</p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" tabindex="-1"></a><span class="co"># Compare variables</span></span>
<span id="cb77-2"><a href="#cb77-2" tabindex="-1"></a><span class="fu">ggpairs</span>(train, <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">8</span>,<span class="dv">10</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-61-1.png" width="768" /></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" tabindex="-1"></a><span class="co"># Compare variables</span></span>
<span id="cb78-2"><a href="#cb78-2" tabindex="-1"></a><span class="fu">ggpairs</span>(train, <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">12</span><span class="sc">:</span><span class="dv">17</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-62-1.png" width="768" /><br />
<br />
</p>
<p><strong>5. imdb_rating ~ title_type</strong></p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb79-2"><a href="#cb79-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb79-3"><a href="#cb79-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> title_type, <span class="at">group =</span> title_type))<span class="sc">+</span></span>
<span id="cb79-4"><a href="#cb79-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb79-5"><a href="#cb79-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb79-6"><a href="#cb79-6" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb79-7"><a href="#cb79-7" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb79-8"><a href="#cb79-8" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb79-9"><a href="#cb79-9" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span></span>
<span id="cb79-10"><a href="#cb79-10" tabindex="-1"></a>  )</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-63-1.png" width="672" /><br />
There is a linear relationship between IMDb rating and title type (blue
line).</p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb80-2"><a href="#cb80-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> title_type, <span class="at">data =</span> train)</span>
<span id="cb80-3"><a href="#cb80-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ title_type, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.0991 -0.4991  0.1009  0.7009  2.1009 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)              7.7103     0.1648  46.778  &lt; 2e-16 ***
## title_typeFeature Film  -1.3112     0.1723  -7.611 1.54e-13 ***
## title_typeTV Movie      -1.9853     0.5404  -3.674 0.000267 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.029 on 462 degrees of freedom
## Multiple R-squared:  0.1153, Adjusted R-squared:  0.1115 
## F-statistic: 30.12 on 2 and 462 DF,  p-value: 5.07e-13</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb82-2"><a href="#cb82-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-64-1.png" width="672" /></p>
<p><br />
Interpretation: Residuals do not show constant variability. Variable
explains 11.53 % of response.<br />
<br />
<br />
</p>
<p><strong>6. imdb_rating ~ genre</strong></p>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb83-2"><a href="#cb83-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb83-3"><a href="#cb83-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> <span class="fu">fct_reorder</span>(genre, imdb_rating)))<span class="sc">+</span></span>
<span id="cb83-4"><a href="#cb83-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb83-5"><a href="#cb83-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;genre&quot;</span>)<span class="sc">+</span></span>
<span id="cb83-6"><a href="#cb83-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb83-7"><a href="#cb83-7" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb83-8"><a href="#cb83-8" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb83-9"><a href="#cb83-9" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb83-10"><a href="#cb83-10" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb83-11"><a href="#cb83-11" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-65-1.png" width="672" /><br />
Each genre has distinctive different median in IMDb rating. There is a
nearly linear relationship.</p>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb84-2"><a href="#cb84-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> genre, <span class="at">data =</span> train)</span>
<span id="cb84-3"><a href="#cb84-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ genre, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.0051 -0.5051  0.0949  0.5949  2.4786 
## 
## Coefficients:
##                                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                      5.9214     0.1482  39.965  &lt; 2e-16 ***
## genreAnimation                   0.3357     0.3920   0.856 0.392233    
## genreArt House &amp; International   0.7513     0.3252   2.310 0.021333 *  
## genreComedy                     -0.1754     0.1913  -0.917 0.359652    
## genreDocumentary                 1.7841     0.2181   8.181 2.86e-15 ***
## genreDrama                       0.7836     0.1619   4.841 1.77e-06 ***
## genreHorror                     -0.2714     0.2821  -0.962 0.336475    
## genreMusical &amp; Performing Arts   1.4411     0.3704   3.890 0.000115 ***
## genreMystery &amp; Suspense          0.5013     0.2071   2.420 0.015910 *  
## genreOther                       0.6252     0.2888   2.165 0.030928 *  
## genreScience Fiction &amp; Fantasy  -0.3214     0.4191  -0.767 0.443485    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.9602 on 454 degrees of freedom
## Multiple R-squared:  0.2435, Adjusted R-squared:  0.2268 
## F-statistic: 14.61 on 10 and 454 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb86-2"><a href="#cb86-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-66-1.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-66-2.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-66-3.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-66-4.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-66-5.png" width="672" /></p>
<p><br />
Interpretation: Residuals show some constant variability. The
relationship is linear. Variable explains 24.35 % of response.<br />
<br />
<br />
</p>
<p><strong>7. imdb_rating ~ mpaa_rating</strong></p>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb87-2"><a href="#cb87-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb87-3"><a href="#cb87-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> <span class="fu">fct_reorder</span>(mpaa_rating, imdb_rating)))<span class="sc">+</span></span>
<span id="cb87-4"><a href="#cb87-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb87-5"><a href="#cb87-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;mpaa_rating&quot;</span>)<span class="sc">+</span></span>
<span id="cb87-6"><a href="#cb87-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb87-7"><a href="#cb87-7" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb87-8"><a href="#cb87-8" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb87-9"><a href="#cb87-9" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb87-10"><a href="#cb87-10" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-67-1.png" width="672" /><br />
IQR of MPAA ratings overlap in most cases. Medians show slightly linear
relationship to IMDb rating.<br />
<br />
</p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb88-2"><a href="#cb88-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> mpaa_rating, <span class="at">data =</span> train)</span>
<span id="cb88-3"><a href="#cb88-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ mpaa_rating, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2110 -0.6110  0.1297  0.7000  1.9890 
## 
## Coefficients:
##                    Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          6.7000     0.2933  22.844   &lt;2e-16 ***
## mpaa_ratingNC-17     0.3000     1.0974   0.273   0.7847    
## mpaa_ratingPG       -0.2441     0.3131  -0.780   0.4361    
## mpaa_ratingPG-13    -0.5426     0.3129  -1.734   0.0836 .  
## mpaa_ratingR        -0.1890     0.3016  -0.627   0.5312    
## mpaa_ratingUnrated   0.6703     0.3410   1.966   0.0499 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.057 on 459 degrees of freedom
## Multiple R-squared:  0.07234,    Adjusted R-squared:  0.06223 
## F-statistic: 7.158 on 5 and 459 DF,  p-value: 1.827e-06</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span></code></pre></div>
<p><br />
Interpretation: Variable explains 7.23 % of response. It is correlated
with the response variable. But we think that MPAA rating (age
appropriate) has nothing to do with movie rating. If we introduce this
variable we may mask effects from other variables, like
<code>genre</code>. Therefore, we will not include this MPAA rating into
the the model.<br />
<br />
<br />
</p>
<p><strong>8. imdb_rating ~ critics_rating</strong></p>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb91-2"><a href="#cb91-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb91-3"><a href="#cb91-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> <span class="fu">fct_reorder</span>(critics_rating, imdb_rating)))<span class="sc">+</span></span>
<span id="cb91-4"><a href="#cb91-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb91-5"><a href="#cb91-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;critics_rating&quot;</span>)<span class="sc">+</span></span>
<span id="cb91-6"><a href="#cb91-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb91-7"><a href="#cb91-7" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb91-8"><a href="#cb91-8" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb91-9"><a href="#cb91-9" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb91-10"><a href="#cb91-10" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-69-1.png" width="672" /><br />
Critics_rating medians are in a linear relationship with IMDB
rating.<br />
</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb92-2"><a href="#cb92-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> critics_rating, <span class="at">data =</span> train)</span>
<span id="cb92-3"><a href="#cb92-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ critics_rating, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.4628 -0.4628  0.0719  0.5159  2.0372 
## 
## Coefficients:
##                      Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)           7.42812    0.08451  87.893  &lt; 2e-16 ***
## critics_ratingFresh  -0.44402    0.10809  -4.108 4.72e-05 ***
## critics_ratingRotten -1.66528    0.10143 -16.418  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.8281 on 462 degrees of freedom
## Multiple R-squared:  0.4275, Adjusted R-squared:  0.425 
## F-statistic: 172.5 on 2 and 462 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb94-2"><a href="#cb94-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-70-1.png" width="672" /></p>
<p><br />
Interpretation: Residuals show no constant variability. Variable
explains 42.75 % of response. We expect that <code>critics_rating</code>
is correlated with <code>critics_score</code>.<br />
<br />
<br />
</p>
<p><strong>9. imdb_rating ~ audience_rating</strong></p>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb95-2"><a href="#cb95-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb95-3"><a href="#cb95-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> <span class="fu">fct_reorder</span>(audience_rating, imdb_rating)))<span class="sc">+</span></span>
<span id="cb95-4"><a href="#cb95-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb95-5"><a href="#cb95-5" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;audience_rating&quot;</span>)<span class="sc">+</span></span>
<span id="cb95-6"><a href="#cb95-6" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb95-7"><a href="#cb95-7" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb95-8"><a href="#cb95-8" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb95-9"><a href="#cb95-9" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb95-10"><a href="#cb95-10" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-71-1.png" width="672" /><br />
Distinctive IQR for audience rating in relation to IMDB rating.<br />
</p>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb96-2"><a href="#cb96-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> audience_rating, <span class="at">data =</span> train)</span>
<span id="cb96-3"><a href="#cb96-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ audience_rating, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -3.6487 -0.3689  0.1311  0.5311  1.5311 
## 
## Coefficients:
##                        Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)             5.56895    0.05570   99.99   &lt;2e-16 ***
## audience_ratingUpright  1.57978    0.07243   21.81   &lt;2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.7677 on 463 degrees of freedom
## Multiple R-squared:  0.5068, Adjusted R-squared:  0.5057 
## F-statistic: 475.8 on 1 and 463 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb98-2"><a href="#cb98-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-72-1.png" width="672" /></p>
<p><br />
Interpretation: Residuals show constant variability. Variable explains
50.68 % of response. We expect that <code>audience_rating</code> is
correlated with <code>audience_score</code>.<br />
<br />
<br />
</p>
<p><strong>10. imdb_rating ~ best_pic_nom</strong></p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb99-2"><a href="#cb99-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb99-3"><a href="#cb99-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> best_pic_nom))<span class="sc">+</span></span>
<span id="cb99-4"><a href="#cb99-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb99-5"><a href="#cb99-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb99-6"><a href="#cb99-6" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb99-7"><a href="#cb99-7" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb99-8"><a href="#cb99-8" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb99-9"><a href="#cb99-9" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-73-1.png" width="672" /><br />
Best_pic_nom shows distinct IMDB ratings.<br />
</p>
<div class="sourceCode" id="cb100"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb100-2"><a href="#cb100-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> best_pic_nom, <span class="at">data =</span> train)</span>
<span id="cb100-3"><a href="#cb100-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ best_pic_nom, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1585 -0.5585  0.1415  0.7415  2.0415 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      6.45848    0.05049 127.914  &lt; 2e-16 ***
## best_pic_nomyes  1.22387    0.26407   4.635 4.65e-06 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.069 on 463 degrees of freedom
## Multiple R-squared:  0.04434,    Adjusted R-squared:  0.04227 
## F-statistic: 21.48 on 1 and 463 DF,  p-value: 4.655e-06</code></pre>
<div class="sourceCode" id="cb102"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb102-2"><a href="#cb102-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-74-1.png" width="672" /></p>
<p><br />
Interpretation: Residuals show no constant variability. Variable
explains 4.43 % of response.<br />
<br />
<br />
</p>
<p><strong>12. imdb_rating ~ best_pic_win</strong></p>
<div class="sourceCode" id="cb103"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb103-2"><a href="#cb103-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb103-3"><a href="#cb103-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> best_pic_win))<span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb103-5"><a href="#cb103-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb103-6"><a href="#cb103-6" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb103-7"><a href="#cb103-7" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb103-8"><a href="#cb103-8" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb103-9"><a href="#cb103-9" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-75-1.png" width="672" /><br />
Best_pic_win shows distinct IMDB ratings.<br />
</p>
<div class="sourceCode" id="cb104"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb104-2"><a href="#cb104-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> best_pic_win, <span class="at">data =</span> train)</span>
<span id="cb104-3"><a href="#cb104-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ best_pic_win, data = train)
## 
## Residuals:
##    Min     1Q Median     3Q    Max 
## -4.192 -0.592  0.208  0.808  2.008 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)       6.4920     0.0506 128.294   &lt;2e-16 ***
## best_pic_winyes   1.3080     0.5456   2.397   0.0169 *  
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.086 on 463 degrees of freedom
## Multiple R-squared:  0.01226,    Adjusted R-squared:  0.01013 
## F-statistic: 5.748 on 1 and 463 DF,  p-value: 0.0169</code></pre>
<div class="sourceCode" id="cb106"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb106-2"><a href="#cb106-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-76-1.png" width="672" /></p>
<p><br />
Interpretation: Residuals show no constant variability. Variable
explains 1.23 % of response.<br />
<br />
<br />
</p>
<p><strong>13. imdb_rating ~ best_actor_win</strong></p>
<div class="sourceCode" id="cb107"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb107-2"><a href="#cb107-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb107-3"><a href="#cb107-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> best_actor_win))<span class="sc">+</span></span>
<span id="cb107-4"><a href="#cb107-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb107-5"><a href="#cb107-5" tabindex="-1"></a>    <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb107-6"><a href="#cb107-6" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb107-7"><a href="#cb107-7" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb107-8"><a href="#cb107-8" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb107-9"><a href="#cb107-9" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-77-1.png" width="672" /><br />
Best_actor_win shows no distinct IMDB rating. Slope of line between
medians is almost zero.<br />
</p>
<div class="sourceCode" id="cb108"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb108-2"><a href="#cb108-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> best_actor_win, <span class="at">data =</span> train)</span>
<span id="cb108-3"><a href="#cb108-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ best_actor_win, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.2910 -0.5716  0.1284  0.8284  2.0284 
## 
## Coefficients:
##                   Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)        6.47161    0.05466 118.397   &lt;2e-16 ***
## best_actor_winyes  0.21944    0.14400   1.524    0.128    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.09 on 463 degrees of freedom
## Multiple R-squared:  0.00499,    Adjusted R-squared:  0.002841 
## F-statistic: 2.322 on 1 and 463 DF,  p-value: 0.1282</code></pre>
<div class="sourceCode" id="cb110"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span></code></pre></div>
<p><br />
Interpretation: Model is not significant (F-test: p-value = 0.128),
i.e. fail to reject H0 (beta1 = 0). Variable explains only 0.5 % of
response.<br />
<br />
<br />
</p>
<p><strong>14. imdb_rating ~ best_actress_win</strong></p>
<div class="sourceCode" id="cb111"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb111-2"><a href="#cb111-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb111-3"><a href="#cb111-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> best_actress_win))<span class="sc">+</span></span>
<span id="cb111-4"><a href="#cb111-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb111-5"><a href="#cb111-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb111-6"><a href="#cb111-6" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb111-7"><a href="#cb111-7" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb111-8"><a href="#cb111-8" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb111-9"><a href="#cb111-9" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-79-1.png" width="672" /><br />
Best_actress_win shows no distinct IMDB rating. Slope of line between
medians is zero.<br />
</p>
<div class="sourceCode" id="cb112"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb112-2"><a href="#cb112-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> best_actress_win, <span class="at">data =</span> train)</span>
<span id="cb112-3"><a href="#cb112-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ best_actress_win, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1848 -0.5848  0.1244  0.8152  2.0152 
## 
## Coefficients:
##                     Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)          6.48476    0.05327 121.731   &lt;2e-16 ***
## best_actress_winyes  0.19079    0.17124   1.114    0.266    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.092 on 463 degrees of freedom
## Multiple R-squared:  0.002674,   Adjusted R-squared:  0.0005199 
## F-statistic: 1.241 on 1 and 463 DF,  p-value: 0.2658</code></pre>
<div class="sourceCode" id="cb114"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span></code></pre></div>
<p><br />
Interpretation: Model is not significant (F-test: p_value = 0.266),
i.e. fail to reject H0 (beta1 = 0). Variable explains 0.27 % of
response.<br />
<br />
<br />
</p>
<p><strong>15. imdb_rating ~ best_dir_win</strong></p>
<div class="sourceCode" id="cb115"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb115-2"><a href="#cb115-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb115-3"><a href="#cb115-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> best_dir_win))<span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb115-5"><a href="#cb115-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb115-6"><a href="#cb115-6" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb115-7"><a href="#cb115-7" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb115-8"><a href="#cb115-8" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb115-9"><a href="#cb115-9" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-81-1.png" width="672" /><br />
Best_dir_win shows a small difference in IMDB rating.<br />
</p>
<div class="sourceCode" id="cb116"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb116-2"><a href="#cb116-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> best_dir_win, <span class="at">data =</span> train)</span>
<span id="cb116-3"><a href="#cb116-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ best_dir_win, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1589 -0.5589  0.1411  0.7411  2.0411 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      6.45885    0.05178 124.731  &lt; 2e-16 ***
## best_dir_winyes  0.68782    0.20387   3.374 0.000804 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.08 on 463 degrees of freedom
## Multiple R-squared:  0.024,  Adjusted R-squared:  0.02189 
## F-statistic: 11.38 on 1 and 463 DF,  p-value: 0.0008035</code></pre>
<div class="sourceCode" id="cb118"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span>
<span id="cb118-2"><a href="#cb118-2" tabindex="-1"></a><span class="fu">plot</span>(model, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-82-1.png" width="672" /></p>
<p><br />
Interpretation: Residuals show no constant variability. Variable
explains 2.4 % of response.<br />
<br />
<br />
</p>
<p><strong>16. imdb_rating ~ top200_box</strong></p>
<div class="sourceCode" id="cb119"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb119-2"><a href="#cb119-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb119-3"><a href="#cb119-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> top200_box))<span class="sc">+</span></span>
<span id="cb119-4"><a href="#cb119-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb119-5"><a href="#cb119-5" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb119-6"><a href="#cb119-6" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb119-7"><a href="#cb119-7" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb119-8"><a href="#cb119-8" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb119-9"><a href="#cb119-9" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-83-1.png" width="672" /><br />
IQR of Top200_box shows no difference in IMDB rating.<br />
</p>
<div class="sourceCode" id="cb120"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb120-2"><a href="#cb120-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> top200_box, <span class="at">data =</span> train)</span>
<span id="cb120-3"><a href="#cb120-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ top200_box, data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1914 -0.5914  0.1086  0.8086  2.0086 
## 
## Coefficients:
##               Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    6.49143    0.05111 127.000   &lt;2e-16 ***
## top200_boxyes  0.54857    0.34855   1.574    0.116    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.09 on 463 degrees of freedom
## Multiple R-squared:  0.005322,   Adjusted R-squared:  0.003173 
## F-statistic: 2.477 on 1 and 463 DF,  p-value: 0.1162</code></pre>
<div class="sourceCode" id="cb122"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span></code></pre></div>
<p><br />
Interpretation: Model is not significant (F-test: p-value = 0.116),
i.e. fail to reject H0 (beta1 = 0). Variable explains 0.53 % of
response.<br />
<br />
<br />
</p>
<p><strong>17. imdb_rating ~ thtr_rel_month</strong></p>
<p>It may be possible that the movie rating is related to the month of
theater release, due to seasonal tradition of the audience.</p>
<div class="sourceCode" id="cb123"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb123-2"><a href="#cb123-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb123-3"><a href="#cb123-3" tabindex="-1"></a><span class="co">#  ggplot(aes(y = imdb_rating, x = as.factor(thtr_rel_month)))+</span></span>
<span id="cb123-4"><a href="#cb123-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(thtr_rel_month), imdb_rating)))<span class="sc">+</span></span>
<span id="cb123-5"><a href="#cb123-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb123-6"><a href="#cb123-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;month of theater release - in order of imdb rating&quot;</span>)<span class="sc">+</span></span>
<span id="cb123-7"><a href="#cb123-7" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb123-8"><a href="#cb123-8" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb123-9"><a href="#cb123-9" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb123-10"><a href="#cb123-10" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb123-11"><a href="#cb123-11" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-85-1.png" width="672" /><br />
The meadians of <code>thtr_rel_month</code> show almost no differences
in IMDB rating.<br />
</p>
<div class="sourceCode" id="cb124"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb124-2"><a href="#cb124-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> <span class="fu">as.factor</span>(thtr_rel_month), <span class="at">data =</span> train)</span>
<span id="cb124-3"><a href="#cb124-3" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ as.factor(thtr_rel_month), data = train)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1308 -0.5917  0.1000  0.8083  2.1028 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  6.43077    0.15183  42.354   &lt;2e-16 ***
## as.factor(thtr_rel_month)2   0.28077    0.26298   1.068    0.286    
## as.factor(thtr_rel_month)3   0.12378    0.24368   0.508    0.612    
## as.factor(thtr_rel_month)4  -0.13077    0.25102  -0.521    0.603    
## as.factor(thtr_rel_month)5  -0.05264    0.24600  -0.214    0.831    
## as.factor(thtr_rel_month)6  -0.04914    0.21799  -0.225    0.822    
## as.factor(thtr_rel_month)7  -0.07401    0.23548  -0.314    0.753    
## as.factor(thtr_rel_month)8   0.34256    0.25102   1.365    0.173    
## as.factor(thtr_rel_month)9  -0.03355    0.23739  -0.141    0.888    
## as.factor(thtr_rel_month)10  0.11041    0.21577   0.512    0.609    
## as.factor(thtr_rel_month)11  0.06090    0.23739   0.257    0.798    
## as.factor(thtr_rel_month)12  0.30508    0.21371   1.428    0.154    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.095 on 453 degrees of freedom
## Multiple R-squared:  0.01859,    Adjusted R-squared:  -0.005242 
## F-statistic:  0.78 on 11 and 453 DF,  p-value: 0.6602</code></pre>
<div class="sourceCode" id="cb126"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span></code></pre></div>
<p><br />
Interpretation: Model is not significant (F-test: p-value = 0.660),
i.e. fail to reject H0 (beta1 = 0). Variable explains 1.86 % of
response.<br />
<br />
<br />
</p>
<p><strong>18. imdb_rating ~ dvd_rel_month</strong></p>
<p>It may be possible that the movie rating is related to the month of
DVD release, due to seasonal tradition of the audience.</p>
<div class="sourceCode" id="cb127"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" tabindex="-1"></a><span class="co"># check title_type</span></span>
<span id="cb127-2"><a href="#cb127-2" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb127-3"><a href="#cb127-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dvd_rel_month)) <span class="sc">%&gt;%</span>   </span>
<span id="cb127-4"><a href="#cb127-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> <span class="fu">fct_reorder</span>(<span class="fu">factor</span>(dvd_rel_month), imdb_rating)))<span class="sc">+</span></span>
<span id="cb127-5"><a href="#cb127-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb127-6"><a href="#cb127-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;month of dvd release - in order of imdb rating&quot;</span>)<span class="sc">+</span></span>
<span id="cb127-7"><a href="#cb127-7" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun.y =</span> median,</span>
<span id="cb127-8"><a href="#cb127-8" tabindex="-1"></a>               <span class="at">geom =</span> <span class="st">&quot;line&quot;</span>,</span>
<span id="cb127-9"><a href="#cb127-9" tabindex="-1"></a>               <span class="fu">aes</span>(<span class="at">group =</span> <span class="dv">1</span>),</span>
<span id="cb127-10"><a href="#cb127-10" tabindex="-1"></a>               <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>,</span>
<span id="cb127-11"><a href="#cb127-11" tabindex="-1"></a>               <span class="at">size =</span> <span class="fl">0.5</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-87-1.png" width="672" /><br />
The <code>dvd_rel_month</code> shows no differences in IMDB
rating.<br />
</p>
<div class="sourceCode" id="cb128"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" tabindex="-1"></a><span class="co"># Simple model</span></span>
<span id="cb128-2"><a href="#cb128-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb128-3"><a href="#cb128-3" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(dvd_rel_month)) <span class="sc">%&gt;%</span> </span>
<span id="cb128-4"><a href="#cb128-4" tabindex="-1"></a>  <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> <span class="fu">as.factor</span>(thtr_rel_month), <span class="at">data =</span> .)</span>
<span id="cb128-5"><a href="#cb128-5" tabindex="-1"></a><span class="fu">summary</span>(model)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ as.factor(thtr_rel_month), data = .)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1308 -0.5917  0.0885  0.8083  2.1028 
## 
## Coefficients:
##                             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                  6.43077    0.15159  42.421   &lt;2e-16 ***
## as.factor(thtr_rel_month)2   0.28077    0.26257   1.069    0.286    
## as.factor(thtr_rel_month)3   0.18486    0.24561   0.753    0.452    
## as.factor(thtr_rel_month)4  -0.13077    0.25063  -0.522    0.602    
## as.factor(thtr_rel_month)5  -0.10174    0.24805  -0.410    0.682    
## as.factor(thtr_rel_month)6  -0.04914    0.21764  -0.226    0.821    
## as.factor(thtr_rel_month)7  -0.06791    0.23901  -0.284    0.776    
## as.factor(thtr_rel_month)8   0.34256    0.25063   1.367    0.172    
## as.factor(thtr_rel_month)9  -0.03355    0.23701  -0.142    0.888    
## as.factor(thtr_rel_month)10  0.11041    0.21544   0.512    0.609    
## as.factor(thtr_rel_month)11  0.06090    0.23701   0.257    0.797    
## as.factor(thtr_rel_month)12  0.30508    0.21337   1.430    0.153    
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 1.093 on 449 degrees of freedom
## Multiple R-squared:  0.01998,    Adjusted R-squared:  -0.004034 
## F-statistic: 0.832 on 11 and 449 DF,  p-value: 0.608</code></pre>
<div class="sourceCode" id="cb130"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> <span class="fu">round</span>((<span class="fu">summary</span>(model)<span class="sc">$</span>r.squared <span class="sc">*</span> <span class="dv">100</span>),<span class="dv">2</span>)</span></code></pre></div>
<p><br />
Interpretation: Model is not significant (F-test: p-value = 0.608),
i.e. fail to reject H0 (beta1 = 0). Variable explains 2 % of
response.<br />
<br />
<br />
</p>
</div>
<div id="check-colinearity" class="section level3">
<h3>Check colinearity</h3>
<p><strong>1. Colinearity between <code>critics_score</code> and
<code>audience_score</code></strong></p>
<p>Variables <code>critics_score</code> and <code>audience_score</code>
expected to be highly correlated (R = 0.73).</p>
<p>Let’s plot the relationship.</p>
<div class="sourceCode" id="cb131"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" tabindex="-1"></a><span class="co"># Correlation between critics_score and audience_score</span></span>
<span id="cb131-2"><a href="#cb131-2" tabindex="-1"></a></span>
<span id="cb131-3"><a href="#cb131-3" tabindex="-1"></a>r <span class="ot">&lt;-</span> <span class="fu">cor</span>(train<span class="sc">$</span>audience_score, train<span class="sc">$</span>critics_score)</span>
<span id="cb131-4"><a href="#cb131-4" tabindex="-1"></a>r2 <span class="ot">&lt;-</span> r<span class="sc">^</span><span class="dv">2</span></span>
<span id="cb131-5"><a href="#cb131-5" tabindex="-1"></a></span>
<span id="cb131-6"><a href="#cb131-6" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb131-7"><a href="#cb131-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> audience_score, <span class="at">y =</span> critics_score))<span class="sc">+</span></span>
<span id="cb131-8"><a href="#cb131-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.3</span> )<span class="sc">+</span></span>
<span id="cb131-9"><a href="#cb131-9" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">col =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb131-10"><a href="#cb131-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Colinearity check: critics_score vs. audience_score&quot;</span>)<span class="sc">+</span></span>
<span id="cb131-11"><a href="#cb131-11" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">15</span>, <span class="at">y=</span><span class="dv">95</span>, <span class="at">label=</span><span class="fu">paste</span>(<span class="st">&quot;R  = &quot;</span>, <span class="fu">round</span>(r, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb131-12"><a href="#cb131-12" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">x=</span><span class="dv">15</span>, <span class="at">y=</span><span class="dv">88</span>, <span class="at">label=</span><span class="fu">paste</span>(<span class="st">&quot;R2 = &quot;</span>, <span class="fu">round</span>(r2, <span class="dv">2</span>)), <span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-89-1.png" width="672" /></p>
<p>The data scores from critics and audience were collected
independently. Even though they are strongly correlated we think they
should be both used in the model.</p>
<p>In addition, <strong>Colinearity</strong> between the two variables
can be tested with the <strong>Variance Inflation Factor
(VIF)</strong>.<br />
Where VIF = 1 / (1 - R-squared): VIF &lt; 5 is acceptable.<br />
</p>
<div class="sourceCode" id="cb132"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" tabindex="-1"></a><span class="co"># Model with &quot;critics_score&quot; and &quot;audience_score&quot;</span></span>
<span id="cb132-2"><a href="#cb132-2" tabindex="-1"></a>model <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> (critics_score) <span class="sc">+</span> (audience_score), <span class="at">data =</span> train)</span>
<span id="cb132-3"><a href="#cb132-3" tabindex="-1"></a><span class="co"># summary(model)</span></span>
<span id="cb132-4"><a href="#cb132-4" tabindex="-1"></a></span>
<span id="cb132-5"><a href="#cb132-5" tabindex="-1"></a>vif_values <span class="ot">&lt;-</span> car<span class="sc">::</span><span class="fu">vif</span>(model)</span>
<span id="cb132-6"><a href="#cb132-6" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&quot;VIF scores: &quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;VIF scores: &quot;</code></pre>
<div class="sourceCode" id="cb134"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" tabindex="-1"></a>vif_values</span></code></pre></div>
<pre><code>##  critics_score audience_score 
##       2.126321       2.126321</code></pre>
<p><br />
VIF value is between 1 and 5 and indicates a moderate correlation. This
is not severe enough to remove one of these variable. <a
href="https://www.statology.org/variance-inflation-factor-r/">link</a><br />
<br />
<br />
</p>
<p><strong>2. Colinearity between <code>critics_score</code> and
<code>critics_rating</code></strong></p>
<div class="sourceCode" id="cb136"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" tabindex="-1"></a><span class="co"># Collinearty check</span></span>
<span id="cb136-2"><a href="#cb136-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb136-3"><a href="#cb136-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>critics_rating, <span class="at">y=</span>critics_score))<span class="sc">+</span></span>
<span id="cb136-4"><a href="#cb136-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb136-5"><a href="#cb136-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;IMDb_Rating ~ critics_score by critics_rating&quot;</span>)<span class="sc">+</span></span>
<span id="cb136-6"><a href="#cb136-6" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb136-7"><a href="#cb136-7" tabindex="-1"></a></span>
<span id="cb136-8"><a href="#cb136-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb136-9"><a href="#cb136-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> critics_score))<span class="sc">+</span></span>
<span id="cb136-10"><a href="#cb136-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> critics_rating))<span class="sc">+</span></span>
<span id="cb136-11"><a href="#cb136-11" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">col =</span> critics_rating), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span>
<span id="cb136-12"><a href="#cb136-12" tabindex="-1"></a></span>
<span id="cb136-13"><a href="#cb136-13" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-93-1.png" width="768" /></p>
<p><br />
Categorical variable <code>critics_rating</code> is directly derived
from <code>critics_score</code>. I.e. we can either use
<code>critics_rating</code> or <code>critics_score</code>.
<code>critics_score</code> is preferred because it contains more
information.<br />
<br />
</p>
<p><strong>3. Colinearity between <code>audience_score</code> and
<code>audience_rating</code></strong></p>
<div class="sourceCode" id="cb137"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" tabindex="-1"></a><span class="co"># Collinearty check</span></span>
<span id="cb137-2"><a href="#cb137-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb137-3"><a href="#cb137-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>audience_rating, <span class="at">y=</span>audience_score))<span class="sc">+</span></span>
<span id="cb137-4"><a href="#cb137-4" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;IMDb_Rating ~ audience_score by audience_rating&quot;</span>)<span class="sc">+</span></span>
<span id="cb137-6"><a href="#cb137-6" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span>
<span id="cb137-7"><a href="#cb137-7" tabindex="-1"></a></span>
<span id="cb137-8"><a href="#cb137-8" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb137-9"><a href="#cb137-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">y =</span> imdb_rating, <span class="at">x =</span> audience_score))<span class="sc">+</span></span>
<span id="cb137-10"><a href="#cb137-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">col =</span> audience_rating))<span class="sc">+</span></span>
<span id="cb137-11"><a href="#cb137-11" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="fu">aes</span>(<span class="at">col =</span> audience_rating), <span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se=</span>F)</span>
<span id="cb137-12"><a href="#cb137-12" tabindex="-1"></a></span>
<span id="cb137-13"><a href="#cb137-13" tabindex="-1"></a>p1 <span class="sc">/</span> p2</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-95-1.png" width="768" /></p>
<p><br />
Categorical variable <code>audience_rating</code> is directly derived
from <code>audience_score</code>. I.e. we can either
use<code>audience_rating</code> or <code>audience_score</code>.
<code>audience_score</code> is preferred because it contains more
information.<br />
<br />
<br />
</p>
</div>
<div id="remove-outliers" class="section level3">
<h3>Remove outliers</h3>
<p>We will remove the identified outlier and influential points and
compare a model with and without removal.<br />
</p>
<p><strong>Remove outliers and influential points</strong></p>
<div class="sourceCode" id="cb138"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" tabindex="-1"></a><span class="co"># Create a data frame for outliers and influential points</span></span>
<span id="cb138-2"><a href="#cb138-2" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" tabindex="-1"></a>max_length <span class="ot">&lt;-</span> <span class="fu">max</span>(<span class="fu">length</span>(v1_runtime), </span>
<span id="cb138-4"><a href="#cb138-4" tabindex="-1"></a>                  <span class="fu">length</span>(v2_critics_score), </span>
<span id="cb138-5"><a href="#cb138-5" tabindex="-1"></a>                  <span class="fu">length</span>(v3_audience_score))</span>
<span id="cb138-6"><a href="#cb138-6" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" tabindex="-1"></a><span class="fu">length</span>(v1_runtime) <span class="ot">&lt;-</span> max_length</span>
<span id="cb138-8"><a href="#cb138-8" tabindex="-1"></a><span class="fu">length</span>(v2_critics_score) <span class="ot">&lt;-</span> max_length</span>
<span id="cb138-9"><a href="#cb138-9" tabindex="-1"></a><span class="fu">length</span>(v3_audience_score) <span class="ot">&lt;-</span> max_length</span>
<span id="cb138-10"><a href="#cb138-10" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" tabindex="-1"></a></span>
<span id="cb138-12"><a href="#cb138-12" tabindex="-1"></a>df_extreme <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(v1_runtime, </span>
<span id="cb138-13"><a href="#cb138-13" tabindex="-1"></a>                         v2_critics_score, </span>
<span id="cb138-14"><a href="#cb138-14" tabindex="-1"></a>                         v3_audience_score)</span>
<span id="cb138-15"><a href="#cb138-15" tabindex="-1"></a></span>
<span id="cb138-16"><a href="#cb138-16" tabindex="-1"></a>df_extreme <span class="ot">&lt;-</span> df_extreme <span class="sc">%&gt;%</span> </span>
<span id="cb138-17"><a href="#cb138-17" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">names_to =</span> <span class="st">&quot;variable&quot;</span>, <span class="at">values_to =</span> <span class="st">&quot;ID&quot;</span>)</span>
<span id="cb138-18"><a href="#cb138-18" tabindex="-1"></a></span>
<span id="cb138-19"><a href="#cb138-19" tabindex="-1"></a>df_extreme <span class="ot">&lt;-</span> df_extreme <span class="sc">%&gt;%</span> </span>
<span id="cb138-20"><a href="#cb138-20" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(ID)) <span class="sc">%&gt;%</span> </span>
<span id="cb138-21"><a href="#cb138-21" tabindex="-1"></a>  <span class="fu">arrange</span>(variable)  </span>
<span id="cb138-22"><a href="#cb138-22" tabindex="-1"></a></span>
<span id="cb138-23"><a href="#cb138-23" tabindex="-1"></a>df_extreme <span class="ot">&lt;-</span> <span class="fu">distinct</span>(df_extreme, ID, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>)</span></code></pre></div>
<p>We have identified 6 outliers or influential points for removal.</p>
<div class="sourceCode" id="cb139"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" tabindex="-1"></a><span class="co"># List of outliers</span></span>
<span id="cb139-2"><a href="#cb139-2" tabindex="-1"></a></span>
<span id="cb139-3"><a href="#cb139-3" tabindex="-1"></a>train <span class="sc">%&gt;%</span> </span>
<span id="cb139-4"><a href="#cb139-4" tabindex="-1"></a>  <span class="fu">semi_join</span>(df_extreme, <span class="at">by =</span> <span class="st">&quot;ID&quot;</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb139-5"><a href="#cb139-5" tabindex="-1"></a>  <span class="fu">select</span>(ID, imdb_rating, audience_score, critics_score, runtime)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##      ID imdb_rating audience_score critics_score runtime
##   &lt;int&gt;       &lt;dbl&gt;          &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;
## 1    36         2.7             17            17     106
## 2    94         3.5             67             4      91
## 3   133         2.4             11             3     118
## 4   155         4.1             70            29     103
## 5   246         2.3             29             2      86
## 6   249         6.3             61            67      84</code></pre>
<div class="sourceCode" id="cb141"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" tabindex="-1"></a><span class="co"># Remove outliers from training dataset using the anti_join function, </span></span>
<span id="cb141-2"><a href="#cb141-2" tabindex="-1"></a><span class="co"># drops all obs in one df1 that have a match in df2</span></span>
<span id="cb141-3"><a href="#cb141-3" tabindex="-1"></a></span>
<span id="cb141-4"><a href="#cb141-4" tabindex="-1"></a>train_clean <span class="ot">&lt;-</span> train <span class="sc">%&gt;%</span> </span>
<span id="cb141-5"><a href="#cb141-5" tabindex="-1"></a>  <span class="fu">anti_join</span>(df_extreme, <span class="at">by =</span> <span class="st">&quot;ID&quot;</span>)</span></code></pre></div>
<p><br />
</p>
<p><strong>Model without removal:</strong></p>
<div class="sourceCode" id="cb142"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" tabindex="-1"></a>m_full_raw <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> <span class="fu">log</span>(runtime) <span class="sc">+</span> critics_score <span class="sc">+</span> audience_score, <span class="at">data =</span> train)</span>
<span id="cb142-2"><a href="#cb142-2" tabindex="-1"></a><span class="fu">summary</span>(m_full_raw)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ log(runtime) + critics_score + audience_score, 
##     data = train)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -2.42345 -0.20648  0.01988  0.25511  1.21426 
## 
## Coefficients:
##                Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    1.354933   0.640425   2.116 0.034908 *  
## log(runtime)   0.503936   0.139423   3.614 0.000334 ***
## critics_score  0.012013   0.001102  10.897  &lt; 2e-16 ***
## audience_score 0.033542   0.001550  21.638  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4685 on 461 degrees of freedom
## Multiple R-squared:  0.8171, Adjusted R-squared:  0.8159 
## F-statistic: 686.6 on 3 and 461 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><br />
</p>
<p><strong>Model with removal:</strong></p>
<div class="sourceCode" id="cb144"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" tabindex="-1"></a>m_full_clean <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> <span class="fu">log</span>(runtime) <span class="sc">+</span> critics_score <span class="sc">+</span> audience_score, <span class="at">data =</span> train_clean)</span>
<span id="cb144-2"><a href="#cb144-2" tabindex="-1"></a><span class="fu">summary</span>(m_full_clean)</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ log(runtime) + critics_score + audience_score, 
##     data = train_clean)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.60477 -0.21244  0.01835  0.23691  1.16234 
## 
## Coefficients:
##                 Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)    1.5037275  0.5672928   2.651  0.00831 ** 
## log(runtime)   0.4911147  0.1235580   3.975 8.19e-05 ***
## critics_score  0.0105024  0.0009859  10.652  &lt; 2e-16 ***
## audience_score 0.0338969  0.0013879  24.423  &lt; 2e-16 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.4129 on 455 degrees of freedom
## Multiple R-squared:  0.8413, Adjusted R-squared:  0.8402 
## F-statistic: 803.9 on 3 and 455 DF,  p-value: &lt; 2.2e-16</code></pre>
<p><br />
The model with extreme values has an adjusted R2 of 0.8159, whereas the
model without extreme (i.e. removed extreme) values has an adjusted R2
of 0.8402 (Note: higher adj R2 is better). The model without extreme
values has significantly improvement over the model with extreme
values.<br />
<br />
</p>
</div>
<div id="summary-of-eda" class="section level3">
<h3>Summary of EDA</h3>
<p>The table below shows a summary of all predictors in respect of
condition fulfillment and effect on response variable. Candidates for
model predictors are marked in column “candidate” by “yes”.<br />
</p>
<p>As candidates for the model we will select 3 numerical predictors and
5 categorical predictors. In total 8 predictors.<br />
</p>
<p><img src="images/predictor_summary.png" width="100%" style="display: block; margin: auto;" /><br />
Explanation of columns:</p>
<ul>
<li><em>linear</em>: linearity checked against response variable</li>
<li><em>constant variability</em>: residuals from simple lm checked
against response variable</li>
<li><em>nearly normal</em>: distribution of variable is nearly
normal</li>
<li><em>independent</em>: independence checked between variables</li>
<li><em>R_squared %</em>: Measure how much the variable contributes to
the response in percent</li>
<li><em>Model p-value</em>: p-value from F-test if the simple model is
significant (alpha = 5%)</li>
<li><em>candidate</em>: “Yes” if variable meets all criteria to be
included in the modeling process<br />
<br />
<br />
</li>
</ul>
<p><strong>Reduce the variables in all datasets to 8
predictors</strong></p>
<div class="sourceCode" id="cb146"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" tabindex="-1"></a><span class="co"># Select predictors for model building in all datasets (train, verify, test)</span></span>
<span id="cb146-2"><a href="#cb146-2" tabindex="-1"></a></span>
<span id="cb146-3"><a href="#cb146-3" tabindex="-1"></a>train_select <span class="ot">&lt;-</span> train_clean <span class="sc">%&gt;%</span>  <span class="co"># ----------------------------- training dataset</span></span>
<span id="cb146-4"><a href="#cb146-4" tabindex="-1"></a>  <span class="fu">select</span>(imdb_rating,</span>
<span id="cb146-5"><a href="#cb146-5" tabindex="-1"></a>         runtime,</span>
<span id="cb146-6"><a href="#cb146-6" tabindex="-1"></a>         critics_score,</span>
<span id="cb146-7"><a href="#cb146-7" tabindex="-1"></a>         audience_score,</span>
<span id="cb146-8"><a href="#cb146-8" tabindex="-1"></a>         title_type,</span>
<span id="cb146-9"><a href="#cb146-9" tabindex="-1"></a>         genre,</span>
<span id="cb146-10"><a href="#cb146-10" tabindex="-1"></a>         best_pic_nom,</span>
<span id="cb146-11"><a href="#cb146-11" tabindex="-1"></a>         best_pic_win,</span>
<span id="cb146-12"><a href="#cb146-12" tabindex="-1"></a>         best_dir_win,</span>
<span id="cb146-13"><a href="#cb146-13" tabindex="-1"></a>         thtr_rel_date)</span>
<span id="cb146-14"><a href="#cb146-14" tabindex="-1"></a></span>
<span id="cb146-15"><a href="#cb146-15" tabindex="-1"></a>verify_select <span class="ot">&lt;-</span> verify <span class="sc">%&gt;%</span>   <span class="co"># ------------------------- verification dataset</span></span>
<span id="cb146-16"><a href="#cb146-16" tabindex="-1"></a>  <span class="fu">select</span>(imdb_rating,</span>
<span id="cb146-17"><a href="#cb146-17" tabindex="-1"></a>         runtime,</span>
<span id="cb146-18"><a href="#cb146-18" tabindex="-1"></a>         critics_score,</span>
<span id="cb146-19"><a href="#cb146-19" tabindex="-1"></a>         audience_score,</span>
<span id="cb146-20"><a href="#cb146-20" tabindex="-1"></a>         title_type,</span>
<span id="cb146-21"><a href="#cb146-21" tabindex="-1"></a>         genre,</span>
<span id="cb146-22"><a href="#cb146-22" tabindex="-1"></a>         best_pic_nom,</span>
<span id="cb146-23"><a href="#cb146-23" tabindex="-1"></a>         best_pic_win,</span>
<span id="cb146-24"><a href="#cb146-24" tabindex="-1"></a>         best_dir_win,</span>
<span id="cb146-25"><a href="#cb146-25" tabindex="-1"></a>         thtr_rel_date)</span>
<span id="cb146-26"><a href="#cb146-26" tabindex="-1"></a></span>
<span id="cb146-27"><a href="#cb146-27" tabindex="-1"></a>test_select <span class="ot">&lt;-</span> test <span class="sc">%&gt;%</span>   <span class="co"># ------------------------- final testing dataset</span></span>
<span id="cb146-28"><a href="#cb146-28" tabindex="-1"></a>  <span class="fu">select</span>(imdb_rating,</span>
<span id="cb146-29"><a href="#cb146-29" tabindex="-1"></a>         runtime,</span>
<span id="cb146-30"><a href="#cb146-30" tabindex="-1"></a>         critics_score,</span>
<span id="cb146-31"><a href="#cb146-31" tabindex="-1"></a>         audience_score,</span>
<span id="cb146-32"><a href="#cb146-32" tabindex="-1"></a>         title_type,</span>
<span id="cb146-33"><a href="#cb146-33" tabindex="-1"></a>         genre,</span>
<span id="cb146-34"><a href="#cb146-34" tabindex="-1"></a>         best_pic_nom,</span>
<span id="cb146-35"><a href="#cb146-35" tabindex="-1"></a>         best_pic_win,</span>
<span id="cb146-36"><a href="#cb146-36" tabindex="-1"></a>         best_dir_win,</span>
<span id="cb146-37"><a href="#cb146-37" tabindex="-1"></a>         thtr_rel_date)</span></code></pre></div>
<p><br />
</p>
<p><br />
<br />
<br />
</p>
</div>
</div>
<div id="part-4-modeling" class="section level2">
<h2>Part 4: Modeling</h2>
<p>After we have identified potential predictors we will now move to the
modeling process.</p>
<p><strong>Modeling goals</strong></p>
<ol style="list-style-type: decimal">
<li>Find the best model that fits the training dataset</li>
<li>Optimize the model for high prediction accuracy</li>
<li>Avoid over- or under-fitting, prefer the simplest and best model
(parsimonious model)</li>
</ol>
<p>We will conduct a step-by-step variable selection approach. There,
are several measures that can be used as criteria for selection:
<code>p-value</code>, <code>adjusted R-squared</code>, and others like
the Akaike Information Criterion (AIC).</p>
<p><code>adjusted R-squared</code> and <code>AIC</code> are the
preferred criteria to optimize the prediction accuracy. Since the AIC
was not part of the course we will use
<code>adjusted R-squared</code></p>
<p>For better understanding of model development we will use the
<strong>forward selection</strong> approach, and gradually add new
predictors to the model and monitor the improvements. For each model we
will run a prediction test with the verification data to monitor the
prediction accuracy.<br />
<br />
<br />
</p>
<div id="forward-selection-approach" class="section level3">
<h3>Forward selection approach</h3>
<p><strong>STEP 0: Null model (no predictor)</strong></p>
<div class="sourceCode" id="cb147"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" tabindex="-1"></a><span class="co"># Initialize an empty data frame to register each model result</span></span>
<span id="cb147-2"><a href="#cb147-2" tabindex="-1"></a>model_eval <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb147-3"><a href="#cb147-3" tabindex="-1"></a>                   <span class="at">model =</span> <span class="fu">character</span>(),</span>
<span id="cb147-4"><a href="#cb147-4" tabindex="-1"></a>                   <span class="at">variables =</span> <span class="fu">character</span>(),</span>
<span id="cb147-5"><a href="#cb147-5" tabindex="-1"></a>                   <span class="at">adjusted_R2 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb147-6"><a href="#cb147-6" tabindex="-1"></a>                   <span class="at">RMSE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb147-7"><a href="#cb147-7" tabindex="-1"></a>                   <span class="at">mean_APE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb147-8"><a href="#cb147-8" tabindex="-1"></a>                   <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span></code></pre></div>
<div class="sourceCode" id="cb148"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" tabindex="-1"></a>m0 <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> train_select)</span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>STEP 1: Add 1st predictor</strong></p>
<p><strong>1-01: imdb_rating ~ log(runtime)</strong></p>
<div class="sourceCode" id="cb149"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" tabindex="-1"></a><span class="co"># STEP 1: Add 1st predictor</span></span>
<span id="cb149-2"><a href="#cb149-2" tabindex="-1"></a>m1_01 <span class="ot">&lt;-</span> <span class="fu">update</span>(m0, . <span class="sc">~</span> . <span class="sc">+</span><span class="fu">log</span>(runtime), <span class="at">data =</span> train_select)</span>
<span id="cb149-3"><a href="#cb149-3" tabindex="-1"></a><span class="co"># summary(m1_01)</span></span>
<span id="cb149-4"><a href="#cb149-4" tabindex="-1"></a>adjR2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m1_01)<span class="sc">$</span>adj.r.squared</span>
<span id="cb149-5"><a href="#cb149-5" tabindex="-1"></a></span>
<span id="cb149-6"><a href="#cb149-6" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb149-7"><a href="#cb149-7" tabindex="-1"></a>verify_select2 <span class="ot">&lt;-</span> verify_select <span class="sc">%&gt;%</span> </span>
<span id="cb149-8"><a href="#cb149-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">predict</span>(m1_01, verify_select),</span>
<span id="cb149-9"><a href="#cb149-9" tabindex="-1"></a>         <span class="at">residual =</span> imdb_rating <span class="sc">-</span> fitted,</span>
<span id="cb149-10"><a href="#cb149-10" tabindex="-1"></a>         <span class="at">ape =</span> <span class="fu">abs</span>(residual)<span class="sc">/</span>imdb_rating)</span>
<span id="cb149-11"><a href="#cb149-11" tabindex="-1"></a><span class="co"># Accuracy measures</span></span>
<span id="cb149-12"><a href="#cb149-12" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(verify_select2<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(verify_select2))</span>
<span id="cb149-13"><a href="#cb149-13" tabindex="-1"></a>mean_ape <span class="ot">&lt;-</span> <span class="fu">mean</span>(verify_select2<span class="sc">$</span>ape) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb149-14"><a href="#cb149-14" tabindex="-1"></a></span>
<span id="cb149-15"><a href="#cb149-15" tabindex="-1"></a><span class="co"># Register model measures</span></span>
<span id="cb149-16"><a href="#cb149-16" tabindex="-1"></a>model_eval[<span class="dv">1</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;m1_01&quot;</span></span>
<span id="cb149-17"><a href="#cb149-17" tabindex="-1"></a>model_eval[<span class="dv">1</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span><span class="st">&quot;log(runtime)&quot;</span></span>
<span id="cb149-18"><a href="#cb149-18" tabindex="-1"></a>model_eval[<span class="dv">1</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> adjR2</span>
<span id="cb149-19"><a href="#cb149-19" tabindex="-1"></a>model_eval[<span class="dv">1</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> rmse</span>
<span id="cb149-20"><a href="#cb149-20" tabindex="-1"></a>model_eval[<span class="dv">1</span>,<span class="dv">5</span>] <span class="ot">&lt;-</span> mean_ape</span>
<span id="cb149-21"><a href="#cb149-21" tabindex="-1"></a></span>
<span id="cb149-22"><a href="#cb149-22" tabindex="-1"></a>model_eval[<span class="dv">1</span>,]</span></code></pre></div>
<pre><code>##   model    variables adjusted_R2     RMSE mean_APE
## 1 m1_01 log(runtime)  0.05506086 1.029952 14.07438</code></pre>
<p><br />
</p>
<p><strong>1-02: imdb_rating ~ critics_score</strong></p>
<pre><code>##   model     variables adjusted_R2      RMSE mean_APE
## 2 m1_02 critics_score    0.619931 0.7858913 11.06981</code></pre>
<p><br />
</p>
<p><strong>1-03: imdb_rating ~ audience_score</strong></p>
<pre><code>##   model      variables adjusted_R2      RMSE mean_APE
## 3 m1_03 audience_score   0.7939711 0.5796008 7.581273</code></pre>
<p><br />
</p>
<p><strong>1-04: imdb_rating ~ title_type</strong></p>
<pre><code>##   model  variables adjusted_R2     RMSE mean_APE
## 4 m1_04 title_type   0.1193321 1.013379 13.71863</code></pre>
<p><br />
</p>
<p><strong>1-05: imdb_rating ~ genre</strong></p>
<pre><code>##   model variables adjusted_R2      RMSE mean_APE
## 5 m1_05     genre   0.2397934 0.9332615 12.79177</code></pre>
<p><br />
</p>
<p><strong>1-06: imdb_rating ~ best_pic_nom</strong></p>
<pre><code>##   model    variables adjusted_R2     RMSE mean_APE
## 6 m1_06 best_pic_nom  0.04489141 1.040207 14.19323</code></pre>
<p><br />
</p>
<p><strong>1-07: imdb_rating ~ best_pic_win</strong></p>
<pre><code>##   model    variables adjusted_R2     RMSE mean_APE
## 7 m1_07 best_pic_win  0.01090741 1.049795 14.44236</code></pre>
<p><br />
</p>
<p><strong>1-08: imdb_rating ~ best_dir_win</strong></p>
<pre><code>##   model    variables adjusted_R2     RMSE mean_APE
## 8 m1_08 best_dir_win  0.02188525 1.067007 14.74622</code></pre>
<p><br />
<br />
</p>
<p><strong>Evaluation STEP 1 (1st predictor)</strong></p>
<p>Select the model with the largest adjusted R2 and compare with
smallest RMSE from verification dataset.</p>
<p>Summary STEP 1:</p>
<div class="sourceCode" id="cb158"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb158-2"><a href="#cb158-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m1&quot;</span>, model)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m1_01</td>
<td align="left">log(runtime)</td>
<td align="right">0.0550609</td>
<td align="right">1.0299521</td>
<td align="right">14.074378</td>
</tr>
<tr class="even">
<td align="left">m1_02</td>
<td align="left">critics_score</td>
<td align="right">0.6199310</td>
<td align="right">0.7858913</td>
<td align="right">11.069809</td>
</tr>
<tr class="odd">
<td align="left">m1_03</td>
<td align="left">audience_score</td>
<td align="right">0.7939711</td>
<td align="right">0.5796008</td>
<td align="right">7.581273</td>
</tr>
<tr class="even">
<td align="left">m1_04</td>
<td align="left">title_type</td>
<td align="right">0.1193321</td>
<td align="right">1.0133785</td>
<td align="right">13.718626</td>
</tr>
<tr class="odd">
<td align="left">m1_05</td>
<td align="left">genre</td>
<td align="right">0.2397934</td>
<td align="right">0.9332615</td>
<td align="right">12.791769</td>
</tr>
<tr class="even">
<td align="left">m1_06</td>
<td align="left">best_pic_nom</td>
<td align="right">0.0448914</td>
<td align="right">1.0402074</td>
<td align="right">14.193233</td>
</tr>
<tr class="odd">
<td align="left">m1_07</td>
<td align="left">best_pic_win</td>
<td align="right">0.0109074</td>
<td align="right">1.0497955</td>
<td align="right">14.442365</td>
</tr>
<tr class="even">
<td align="left">m1_08</td>
<td align="left">best_dir_win</td>
<td align="right">0.0218853</td>
<td align="right">1.0670071</td>
<td align="right">14.746223</td>
</tr>
</tbody>
</table>
<p>Best model(s):</p>
<div class="sourceCode" id="cb159"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb159-2"><a href="#cb159-2" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2) <span class="sc">|</span></span>
<span id="cb159-3"><a href="#cb159-3" tabindex="-1"></a>         RMSE <span class="sc">==</span> <span class="fu">min</span>(RMSE)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m1_03</td>
<td align="left">audience_score</td>
<td align="right">0.7939711</td>
<td align="right">0.5796008</td>
<td align="right">7.581273</td>
</tr>
</tbody>
</table>
<p>Best model is “m1_03” with variable “audience_score”.</p>
<div class="sourceCode" id="cb160"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="#cb160-1" tabindex="-1"></a><span class="co"># STEP 1: Best model</span></span>
<span id="cb160-2"><a href="#cb160-2" tabindex="-1"></a>m1 <span class="ot">&lt;-</span> m1_03</span></code></pre></div>
<p><br />
</p>
<p><strong>STEP 2: Add 2nd predictor</strong></p>
<p><strong>2-01: imdb_rating ~ audience_score +
log(runtime)</strong></p>
<div class="sourceCode" id="cb161"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="#cb161-1" tabindex="-1"></a><span class="co"># STEP 2: Add 2nd predictor</span></span>
<span id="cb161-2"><a href="#cb161-2" tabindex="-1"></a>m2_01 <span class="ot">&lt;-</span> <span class="fu">update</span>(m1, . <span class="sc">~</span> . <span class="sc">+</span><span class="fu">log</span>(runtime), <span class="at">data =</span> train_select)</span>
<span id="cb161-3"><a href="#cb161-3" tabindex="-1"></a><span class="co"># summary(m2_01)</span></span>
<span id="cb161-4"><a href="#cb161-4" tabindex="-1"></a>adjR2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m2_01)<span class="sc">$</span>adj.r.squared</span>
<span id="cb161-5"><a href="#cb161-5" tabindex="-1"></a></span>
<span id="cb161-6"><a href="#cb161-6" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb161-7"><a href="#cb161-7" tabindex="-1"></a>verify_select2 <span class="ot">&lt;-</span> verify_select <span class="sc">%&gt;%</span> </span>
<span id="cb161-8"><a href="#cb161-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">predict</span>(m2_01, verify_select),</span>
<span id="cb161-9"><a href="#cb161-9" tabindex="-1"></a>         <span class="at">residual =</span> imdb_rating <span class="sc">-</span> fitted,</span>
<span id="cb161-10"><a href="#cb161-10" tabindex="-1"></a>         <span class="at">ape =</span> <span class="fu">abs</span>(residual)<span class="sc">/</span>imdb_rating)</span>
<span id="cb161-11"><a href="#cb161-11" tabindex="-1"></a><span class="co"># Accuracy measures</span></span>
<span id="cb161-12"><a href="#cb161-12" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(verify_select2<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(verify_select2))</span>
<span id="cb161-13"><a href="#cb161-13" tabindex="-1"></a>mean_ape <span class="ot">&lt;-</span> <span class="fu">mean</span>(verify_select2<span class="sc">$</span>ape) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb161-14"><a href="#cb161-14" tabindex="-1"></a></span>
<span id="cb161-15"><a href="#cb161-15" tabindex="-1"></a><span class="co"># Register model measures</span></span>
<span id="cb161-16"><a href="#cb161-16" tabindex="-1"></a>model_eval[<span class="dv">9</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;m2_01&quot;</span></span>
<span id="cb161-17"><a href="#cb161-17" tabindex="-1"></a>model_eval[<span class="dv">9</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;audience_score+log(runtime)&quot;</span></span>
<span id="cb161-18"><a href="#cb161-18" tabindex="-1"></a>model_eval[<span class="dv">9</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> adjR2</span>
<span id="cb161-19"><a href="#cb161-19" tabindex="-1"></a>model_eval[<span class="dv">9</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> rmse</span>
<span id="cb161-20"><a href="#cb161-20" tabindex="-1"></a>model_eval[<span class="dv">9</span>,<span class="dv">5</span>] <span class="ot">&lt;-</span> mean_ape</span>
<span id="cb161-21"><a href="#cb161-21" tabindex="-1"></a></span>
<span id="cb161-22"><a href="#cb161-22" tabindex="-1"></a>model_eval[<span class="dv">9</span>,]</span></code></pre></div>
<pre><code>##   model                   variables adjusted_R2      RMSE mean_APE
## 9 m2_01 audience_score+log(runtime)   0.8008302 0.5561991 7.324255</code></pre>
<p><br />
</p>
<p><strong>2-02: imdb_rating ~ audience_score +
critics_score</strong></p>
<pre><code>##    model                    variables adjusted_R2      RMSE mean_APE
## 10 m2_02 audience_score+critics_score   0.8350502 0.5278249 7.165724</code></pre>
<p><br />
</p>
<p><strong>2-03: imdb_rating ~ audience_score + title_type</strong></p>
<pre><code>##    model                 variables adjusted_R2      RMSE mean_APE
## 11 m2_03 audience_score+title_type   0.7998508 0.5818953  7.60808</code></pre>
<p><br />
</p>
<p><strong>2-04: imdb_rating ~ audience_score + genre</strong></p>
<pre><code>##    model            variables adjusted_R2      RMSE mean_APE
## 12 m2_04 audience_score+genre   0.8206556 0.5645978 7.574256</code></pre>
<p><br />
</p>
<p><strong>2-05: imdb_rating ~ audience_score +
best_pic_nom</strong></p>
<pre><code>##    model                   variables adjusted_R2      RMSE mean_APE
## 13 m2_05 audience_score+best_pic_nom   0.7941997 0.5778187 7.561371</code></pre>
<p><br />
</p>
<p><strong>2-06: imdb_rating ~ audience_score +
best_pic_win</strong></p>
<pre><code>##    model                   variables adjusted_R2      RMSE mean_APE
## 14 m2_06 audience_score+best_pic_win   0.7938619 0.5773597 7.572537</code></pre>
<p><br />
</p>
<p><strong>2-07: imdb_rating ~ audience_score +
best_dir_win</strong></p>
<pre><code>##    model                   variables adjusted_R2      RMSE mean_APE
## 15 m2_07 audience_score+best_pic_win   0.7947924 0.5746772 7.545173</code></pre>
<p><br />
</p>
<p><strong>Evaluation STEP 2 (2nd predictor)</strong></p>
<p>Select the model with the largest adjusted R2 and compare with
smallest RMSE from verification dataset.</p>
<p>Summary STEP 2:</p>
<div class="sourceCode" id="cb169"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="#cb169-1" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb169-2"><a href="#cb169-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m2&quot;</span>, model)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m2_01</td>
<td align="left">audience_score+log(runtime)</td>
<td align="right">0.8008302</td>
<td align="right">0.5561991</td>
<td align="right">7.324255</td>
</tr>
<tr class="even">
<td align="left">m2_02</td>
<td align="left">audience_score+critics_score</td>
<td align="right">0.8350502</td>
<td align="right">0.5278249</td>
<td align="right">7.165724</td>
</tr>
<tr class="odd">
<td align="left">m2_03</td>
<td align="left">audience_score+title_type</td>
<td align="right">0.7998508</td>
<td align="right">0.5818953</td>
<td align="right">7.608080</td>
</tr>
<tr class="even">
<td align="left">m2_04</td>
<td align="left">audience_score+genre</td>
<td align="right">0.8206556</td>
<td align="right">0.5645978</td>
<td align="right">7.574256</td>
</tr>
<tr class="odd">
<td align="left">m2_05</td>
<td align="left">audience_score+best_pic_nom</td>
<td align="right">0.7941997</td>
<td align="right">0.5778187</td>
<td align="right">7.561371</td>
</tr>
<tr class="even">
<td align="left">m2_06</td>
<td align="left">audience_score+best_pic_win</td>
<td align="right">0.7938619</td>
<td align="right">0.5773597</td>
<td align="right">7.572537</td>
</tr>
<tr class="odd">
<td align="left">m2_07</td>
<td align="left">audience_score+best_pic_win</td>
<td align="right">0.7947924</td>
<td align="right">0.5746772</td>
<td align="right">7.545173</td>
</tr>
</tbody>
</table>
<p>Best model(s):</p>
<div class="sourceCode" id="cb170"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="#cb170-1" tabindex="-1"></a><span class="co"># model_eval</span></span>
<span id="cb170-2"><a href="#cb170-2" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb170-3"><a href="#cb170-3" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2) <span class="sc">|</span></span>
<span id="cb170-4"><a href="#cb170-4" tabindex="-1"></a>         RMSE <span class="sc">==</span> <span class="fu">min</span>(RMSE)))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m2_02</td>
<td align="left">audience_score+critics_score</td>
<td align="right">0.8350502</td>
<td align="right">0.5278249</td>
<td align="right">7.165724</td>
</tr>
</tbody>
</table>
<p>Best model is “m2_02” with variables “audience_score +
critics_score”.<br />
</p>
<div class="sourceCode" id="cb171"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="#cb171-1" tabindex="-1"></a><span class="co"># STEP 2: Best model</span></span>
<span id="cb171-2"><a href="#cb171-2" tabindex="-1"></a>m2 <span class="ot">&lt;-</span> m2_02</span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>STEP 3: Add 3rd predictor</strong></p>
<p><strong>3-01: imdb_rating ~ audience_score + critics_score +
log(runtime)</strong></p>
<div class="sourceCode" id="cb172"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="#cb172-1" tabindex="-1"></a><span class="co"># STEP 3: Add 3rd predictor</span></span>
<span id="cb172-2"><a href="#cb172-2" tabindex="-1"></a>m3_01 <span class="ot">&lt;-</span> <span class="fu">update</span>(m2, . <span class="sc">~</span> . <span class="sc">+</span><span class="fu">log</span>(runtime), <span class="at">data =</span> train_select)</span>
<span id="cb172-3"><a href="#cb172-3" tabindex="-1"></a><span class="co"># summary(m3_01)</span></span>
<span id="cb172-4"><a href="#cb172-4" tabindex="-1"></a>adjR2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m3_01)<span class="sc">$</span>adj.r.squared</span>
<span id="cb172-5"><a href="#cb172-5" tabindex="-1"></a></span>
<span id="cb172-6"><a href="#cb172-6" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb172-7"><a href="#cb172-7" tabindex="-1"></a>verify_select2 <span class="ot">&lt;-</span> verify_select <span class="sc">%&gt;%</span> </span>
<span id="cb172-8"><a href="#cb172-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">predict</span>(m3_01, verify_select),</span>
<span id="cb172-9"><a href="#cb172-9" tabindex="-1"></a>         <span class="at">residual =</span> imdb_rating <span class="sc">-</span> fitted,</span>
<span id="cb172-10"><a href="#cb172-10" tabindex="-1"></a>         <span class="at">ape =</span> <span class="fu">abs</span>(residual)<span class="sc">/</span>imdb_rating)</span>
<span id="cb172-11"><a href="#cb172-11" tabindex="-1"></a><span class="co"># Accuracy measures</span></span>
<span id="cb172-12"><a href="#cb172-12" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(verify_select2<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(verify_select2))</span>
<span id="cb172-13"><a href="#cb172-13" tabindex="-1"></a>mean_ape <span class="ot">&lt;-</span> <span class="fu">mean</span>(verify_select2<span class="sc">$</span>ape) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb172-14"><a href="#cb172-14" tabindex="-1"></a></span>
<span id="cb172-15"><a href="#cb172-15" tabindex="-1"></a><span class="co"># Register model measures</span></span>
<span id="cb172-16"><a href="#cb172-16" tabindex="-1"></a>model_eval[<span class="dv">16</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;m3_01&quot;</span></span>
<span id="cb172-17"><a href="#cb172-17" tabindex="-1"></a>model_eval[<span class="dv">16</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;audience_score+critics_score+log(runtime)&quot;</span></span>
<span id="cb172-18"><a href="#cb172-18" tabindex="-1"></a>model_eval[<span class="dv">16</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> adjR2</span>
<span id="cb172-19"><a href="#cb172-19" tabindex="-1"></a>model_eval[<span class="dv">16</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> rmse</span>
<span id="cb172-20"><a href="#cb172-20" tabindex="-1"></a>model_eval[<span class="dv">16</span>,<span class="dv">5</span>] <span class="ot">&lt;-</span> mean_ape</span>
<span id="cb172-21"><a href="#cb172-21" tabindex="-1"></a></span>
<span id="cb172-22"><a href="#cb172-22" tabindex="-1"></a>model_eval[<span class="dv">16</span>,]</span></code></pre></div>
<pre><code>##    model                                 variables adjusted_R2      RMSE
## 16 m3_01 audience_score+critics_score+log(runtime)   0.8402351 0.5066421
##    mean_APE
## 16 6.856302</code></pre>
<p><br />
</p>
<p><strong>3-02: imdb_rating ~ audience_score + critics_score +
title_type</strong></p>
<pre><code>##    model                               variables adjusted_R2     RMSE mean_APE
## 17 m3_02 audience_score+critics_score+title_type   0.8379259 0.531536 7.205349</code></pre>
<p><br />
</p>
<p><strong>3-03: imdb_rating ~ audience_score + critics_score +
genre</strong></p>
<pre><code>##    model                          variables adjusted_R2      RMSE mean_APE
## 18 m3_03 audience_score+critics_score+genre   0.8491622 0.5115876 7.003601</code></pre>
<p><br />
</p>
<p><strong>3-04: imdb_rating ~ audience_score + critics_score +
best_pic_nom</strong></p>
<pre><code>##    model                                 variables adjusted_R2      RMSE
## 19 m3_04 audience_score+critics_score+best_pic_nom   0.8349001 0.5272658
##    mean_APE
## 19 7.155819</code></pre>
<p><br />
</p>
<p><strong>3-05: imdb_rating ~ audience_score + critics_score +
best_pic_win</strong></p>
<pre><code>##    model                                 variables adjusted_R2      RMSE
## 20 m3_05 audience_score+critics_score+best_pic_win    0.834749 0.5270972
##    mean_APE
## 20 7.164141</code></pre>
<p><br />
</p>
<p><strong>3-06: imdb_rating ~ audience_score + critics_score +
best_dir_win</strong></p>
<pre><code>##    model                                 variables adjusted_R2      RMSE
## 21 m3_06 audience_score+critics_score+best_dir_win   0.8349479 0.5263513
##    mean_APE
## 21 7.118875</code></pre>
<p><br />
</p>
<p><strong>Evaluation STEP 3 (3rd predictor)</strong></p>
<p>Select the model with the largest adjusted R2 and compare with
smallest RMSE from verification dataset.</p>
<p>Summary STEP 3:</p>
<div class="sourceCode" id="cb179"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="#cb179-1" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb179-2"><a href="#cb179-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m3&quot;</span>, model)))</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="53%" />
<col width="15%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m3_01</td>
<td align="left">audience_score+critics_score+log(runtime)</td>
<td align="right">0.8402351</td>
<td align="right">0.5066421</td>
<td align="right">6.856301</td>
</tr>
<tr class="even">
<td align="left">m3_02</td>
<td align="left">audience_score+critics_score+title_type</td>
<td align="right">0.8379259</td>
<td align="right">0.5315360</td>
<td align="right">7.205349</td>
</tr>
<tr class="odd">
<td align="left">m3_03</td>
<td align="left">audience_score+critics_score+genre</td>
<td align="right">0.8491622</td>
<td align="right">0.5115876</td>
<td align="right">7.003601</td>
</tr>
<tr class="even">
<td align="left">m3_04</td>
<td align="left">audience_score+critics_score+best_pic_nom</td>
<td align="right">0.8349001</td>
<td align="right">0.5272658</td>
<td align="right">7.155819</td>
</tr>
<tr class="odd">
<td align="left">m3_05</td>
<td align="left">audience_score+critics_score+best_pic_win</td>
<td align="right">0.8347490</td>
<td align="right">0.5270972</td>
<td align="right">7.164141</td>
</tr>
<tr class="even">
<td align="left">m3_06</td>
<td align="left">audience_score+critics_score+best_dir_win</td>
<td align="right">0.8349479</td>
<td align="right">0.5263513</td>
<td align="right">7.118875</td>
</tr>
</tbody>
</table>
<p>Best model(s):</p>
<div class="sourceCode" id="cb180"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="#cb180-1" tabindex="-1"></a><span class="co"># model_eval</span></span>
<span id="cb180-2"><a href="#cb180-2" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb180-3"><a href="#cb180-3" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2) <span class="sc">|</span></span>
<span id="cb180-4"><a href="#cb180-4" tabindex="-1"></a>         RMSE <span class="sc">==</span> <span class="fu">min</span>(RMSE)))</span></code></pre></div>
<table>
<colgroup>
<col width="7%" />
<col width="53%" />
<col width="15%" />
<col width="12%" />
<col width="11%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m3_01</td>
<td align="left">audience_score+critics_score+log(runtime)</td>
<td align="right">0.8402351</td>
<td align="right">0.5066421</td>
<td align="right">6.856301</td>
</tr>
<tr class="even">
<td align="left">m3_03</td>
<td align="left">audience_score+critics_score+genre</td>
<td align="right">0.8491622</td>
<td align="right">0.5115876</td>
<td align="right">7.003601</td>
</tr>
</tbody>
</table>
<p>Model m3_03 has the better fit with the training data (largest
adjusted R2). Model m3_01 has the better prediction accuracy tested with
the verification data (smallest RMSE).</p>
<p>Best model is “m3_03” with variables “audience_score + critics_score
+ genre”.<br />
</p>
<p><br />
</p>
<p><strong>STEP 4: Add 4th predictor</strong></p>
<p><strong>4-01: imdb_rating ~ audience_score + critics_score + genre +
log(runtime)</strong></p>
<div class="sourceCode" id="cb181"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="#cb181-1" tabindex="-1"></a><span class="co"># STEP 4: Add 4th predictor</span></span>
<span id="cb181-2"><a href="#cb181-2" tabindex="-1"></a>m4_01 <span class="ot">&lt;-</span> <span class="fu">update</span>(m3, . <span class="sc">~</span> . <span class="sc">+</span><span class="fu">log</span>(runtime), <span class="at">data =</span> train_select)</span>
<span id="cb181-3"><a href="#cb181-3" tabindex="-1"></a><span class="co"># summary(m4_01)</span></span>
<span id="cb181-4"><a href="#cb181-4" tabindex="-1"></a>adjR2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m4_01)<span class="sc">$</span>adj.r.squared</span>
<span id="cb181-5"><a href="#cb181-5" tabindex="-1"></a></span>
<span id="cb181-6"><a href="#cb181-6" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb181-7"><a href="#cb181-7" tabindex="-1"></a>verify_select2 <span class="ot">&lt;-</span> verify_select <span class="sc">%&gt;%</span> </span>
<span id="cb181-8"><a href="#cb181-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">predict</span>(m4_01, verify_select),</span>
<span id="cb181-9"><a href="#cb181-9" tabindex="-1"></a>         <span class="at">residual =</span> imdb_rating <span class="sc">-</span> fitted,</span>
<span id="cb181-10"><a href="#cb181-10" tabindex="-1"></a>         <span class="at">ape =</span> <span class="fu">abs</span>(residual)<span class="sc">/</span>imdb_rating)</span>
<span id="cb181-11"><a href="#cb181-11" tabindex="-1"></a><span class="co"># Accuracy measures</span></span>
<span id="cb181-12"><a href="#cb181-12" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(verify_select2<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(verify_select2))</span>
<span id="cb181-13"><a href="#cb181-13" tabindex="-1"></a>mean_ape <span class="ot">&lt;-</span> <span class="fu">mean</span>(verify_select2<span class="sc">$</span>ape) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb181-14"><a href="#cb181-14" tabindex="-1"></a></span>
<span id="cb181-15"><a href="#cb181-15" tabindex="-1"></a><span class="co"># Register model measures</span></span>
<span id="cb181-16"><a href="#cb181-16" tabindex="-1"></a>model_eval[<span class="dv">22</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;m4_01&quot;</span></span>
<span id="cb181-17"><a href="#cb181-17" tabindex="-1"></a>model_eval[<span class="dv">22</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;audience_score+critics_score+genre+log(runtime)&quot;</span></span>
<span id="cb181-18"><a href="#cb181-18" tabindex="-1"></a>model_eval[<span class="dv">22</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> adjR2</span>
<span id="cb181-19"><a href="#cb181-19" tabindex="-1"></a>model_eval[<span class="dv">22</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> rmse</span>
<span id="cb181-20"><a href="#cb181-20" tabindex="-1"></a>model_eval[<span class="dv">22</span>,<span class="dv">5</span>] <span class="ot">&lt;-</span> mean_ape</span>
<span id="cb181-21"><a href="#cb181-21" tabindex="-1"></a></span>
<span id="cb181-22"><a href="#cb181-22" tabindex="-1"></a>model_eval[<span class="dv">22</span>,]</span></code></pre></div>
<pre><code>##    model                                       variables adjusted_R2      RMSE
## 22 m4_01 audience_score+critics_score+genre+log(runtime)   0.8530012 0.4915971
##    mean_APE
## 22 6.711704</code></pre>
<p><br />
</p>
<p><strong>4-02: imdb_rating ~ audience_score + critics_score + genre +
title_type</strong></p>
<pre><code>##    model                                     variables adjusted_R2      RMSE
## 23 m4_02 audience_score+critics_score+genre+title_type   0.8498681 0.5112963
##    mean_APE
## 23 6.987793</code></pre>
<p><br />
</p>
<p><strong>4-03: imdb_rating ~ audience_score + critics_score + genre +
best_pic_nom</strong></p>
<pre><code>##    model                                       variables adjusted_R2     RMSE
## 24 m4_03 audience_score+critics_score+genre+best_pic_nom    0.849263 0.510842
##    mean_APE
## 24 6.993415</code></pre>
<p><br />
</p>
<p><strong>4-04: imdb_rating ~ audience_score + critics_score + genre +
best_pic_win</strong></p>
<pre><code>##    model                                       variables adjusted_R2      RMSE
## 25 m4_04 audience_score+critics_score+genre+best_pic_win   0.8491045 0.5104337
##    mean_APE
## 25 7.003745</code></pre>
<p><br />
</p>
<p><strong>4-05: imdb_rating ~ audience_score + critics_score + genre +
best_dir_win</strong></p>
<pre><code>##    model                                       variables adjusted_R2      RMSE
## 26 m4_05 audience_score+critics_score+genre+best_dir_win   0.8496157 0.5105215
##    mean_APE
## 26 6.954537</code></pre>
<p><br />
</p>
<p><strong>Evaluation STEP 4 (4th predictor)</strong></p>
<p>Select the model with the largest adjusted R2 and compare with
smallest RMSE from verification dataset.</p>
<p>Summary STEP 4:</p>
<div class="sourceCode" id="cb187"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb187-1"><a href="#cb187-1" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb187-2"><a href="#cb187-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m4&quot;</span>, model)))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="56%" />
<col width="14%" />
<col width="11%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m4_01</td>
<td align="left">audience_score+critics_score+genre+log(runtime)</td>
<td align="right">0.8530012</td>
<td align="right">0.4915971</td>
<td align="right">6.711704</td>
</tr>
<tr class="even">
<td align="left">m4_02</td>
<td align="left">audience_score+critics_score+genre+title_type</td>
<td align="right">0.8498681</td>
<td align="right">0.5112963</td>
<td align="right">6.987793</td>
</tr>
<tr class="odd">
<td align="left">m4_03</td>
<td align="left">audience_score+critics_score+genre+best_pic_nom</td>
<td align="right">0.8492630</td>
<td align="right">0.5108420</td>
<td align="right">6.993415</td>
</tr>
<tr class="even">
<td align="left">m4_04</td>
<td align="left">audience_score+critics_score+genre+best_pic_win</td>
<td align="right">0.8491045</td>
<td align="right">0.5104337</td>
<td align="right">7.003745</td>
</tr>
<tr class="odd">
<td align="left">m4_05</td>
<td align="left">audience_score+critics_score+genre+best_dir_win</td>
<td align="right">0.8496157</td>
<td align="right">0.5105215</td>
<td align="right">6.954537</td>
</tr>
</tbody>
</table>
<p>Best model(s):</p>
<div class="sourceCode" id="cb188"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="#cb188-1" tabindex="-1"></a><span class="co"># model_eval</span></span>
<span id="cb188-2"><a href="#cb188-2" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb188-3"><a href="#cb188-3" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2) <span class="sc">|</span></span>
<span id="cb188-4"><a href="#cb188-4" tabindex="-1"></a>         RMSE <span class="sc">==</span> <span class="fu">min</span>(RMSE)))</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="7%" />
<col width="56%" />
<col width="14%" />
<col width="11%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m4_01</td>
<td align="left">audience_score+critics_score+genre+log(runtime)</td>
<td align="right">0.8530012</td>
<td align="right">0.4915971</td>
<td align="right">6.711704</td>
</tr>
</tbody>
</table>
<p>Best model is “m4_01” with variables “audience_score + critics_score
+ genre + log(runtime)”.<br />
</p>
<div class="sourceCode" id="cb189"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="#cb189-1" tabindex="-1"></a><span class="co"># STEP 2: Best model</span></span>
<span id="cb189-2"><a href="#cb189-2" tabindex="-1"></a>m4 <span class="ot">&lt;-</span> m4_01</span>
<span id="cb189-3"><a href="#cb189-3" tabindex="-1"></a><span class="co"># summary(m4)</span></span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>STEP 5: Add 5th predictor</strong></p>
<p><strong>5-01: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + title_type</strong></p>
<div class="sourceCode" id="cb190"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="#cb190-1" tabindex="-1"></a><span class="co"># STEP 5: Add 5th predictor</span></span>
<span id="cb190-2"><a href="#cb190-2" tabindex="-1"></a>m5_01 <span class="ot">&lt;-</span> <span class="fu">update</span>(m4, . <span class="sc">~</span> . <span class="sc">+</span>title_type, <span class="at">data =</span> train_select)</span>
<span id="cb190-3"><a href="#cb190-3" tabindex="-1"></a><span class="co"># summary(m5_01)</span></span>
<span id="cb190-4"><a href="#cb190-4" tabindex="-1"></a>adjR2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m5_01)<span class="sc">$</span>adj.r.squared</span>
<span id="cb190-5"><a href="#cb190-5" tabindex="-1"></a></span>
<span id="cb190-6"><a href="#cb190-6" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb190-7"><a href="#cb190-7" tabindex="-1"></a>verify_select2 <span class="ot">&lt;-</span> verify_select <span class="sc">%&gt;%</span> </span>
<span id="cb190-8"><a href="#cb190-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">predict</span>(m5_01, verify_select),</span>
<span id="cb190-9"><a href="#cb190-9" tabindex="-1"></a>         <span class="at">residual =</span> imdb_rating <span class="sc">-</span> fitted,</span>
<span id="cb190-10"><a href="#cb190-10" tabindex="-1"></a>         <span class="at">ape =</span> <span class="fu">abs</span>(residual)<span class="sc">/</span>imdb_rating)</span>
<span id="cb190-11"><a href="#cb190-11" tabindex="-1"></a><span class="co"># Accuracy measures</span></span>
<span id="cb190-12"><a href="#cb190-12" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(verify_select2<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(verify_select2))</span>
<span id="cb190-13"><a href="#cb190-13" tabindex="-1"></a>mean_ape <span class="ot">&lt;-</span> <span class="fu">mean</span>(verify_select2<span class="sc">$</span>ape) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb190-14"><a href="#cb190-14" tabindex="-1"></a></span>
<span id="cb190-15"><a href="#cb190-15" tabindex="-1"></a><span class="co"># Register model measures</span></span>
<span id="cb190-16"><a href="#cb190-16" tabindex="-1"></a>model_eval[<span class="dv">27</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;m5_01&quot;</span></span>
<span id="cb190-17"><a href="#cb190-17" tabindex="-1"></a>model_eval[<span class="dv">27</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;audience_score+critics_score+genre+log(runtime)+title_type&quot;</span></span>
<span id="cb190-18"><a href="#cb190-18" tabindex="-1"></a>model_eval[<span class="dv">27</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> adjR2</span>
<span id="cb190-19"><a href="#cb190-19" tabindex="-1"></a>model_eval[<span class="dv">27</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> rmse</span>
<span id="cb190-20"><a href="#cb190-20" tabindex="-1"></a>model_eval[<span class="dv">27</span>,<span class="dv">5</span>] <span class="ot">&lt;-</span> mean_ape</span>
<span id="cb190-21"><a href="#cb190-21" tabindex="-1"></a></span>
<span id="cb190-22"><a href="#cb190-22" tabindex="-1"></a>model_eval[<span class="dv">27</span>,]</span></code></pre></div>
<pre><code>##    model                                                  variables adjusted_R2
## 27 m5_01 audience_score+critics_score+genre+log(runtime)+title_type   0.8534625
##         RMSE mean_APE
## 27 0.4916075 6.701047</code></pre>
<p><br />
</p>
<p><strong>5-02: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + best_pic_nom</strong></p>
<pre><code>##    model                                                    variables
## 28 m5_02 audience_score+critics_score+genre+log(runtime)+best_pic_nom
##    adjusted_R2      RMSE mean_APE
## 28   0.8527545 0.4917559 6.703804</code></pre>
<p><br />
</p>
<p><strong>5-03: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + best_pic_win</strong></p>
<pre><code>##    model                                                    variables
## 29 m5_03 audience_score+critics_score+genre+log(runtime)+best_pic_win
##    adjusted_R2      RMSE mean_APE
## 29   0.8528001 0.4913087 6.702369</code></pre>
<p><br />
</p>
<p><strong>5-04: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + best_dir_win</strong></p>
<pre><code>##    model                                                    variables
## 30 m5_04 audience_score+critics_score+genre+log(runtime)+best_dir_win
##    adjusted_R2      RMSE mean_APE
## 30   0.8530153 0.4922052 6.713829</code></pre>
<p><br />
</p>
<p><strong>Evaluation STEP 5 (5th predictor)</strong></p>
<p>Select the model with the largest adjusted R2 and compare with
smallest RMSE from verification dataset.</p>
<p>Summary STEP 5:</p>
<div class="sourceCode" id="cb195"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="#cb195-1" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb195-2"><a href="#cb195-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m5&quot;</span>, model)))</span></code></pre></div>
<table>
<colgroup>
<col width="6%" />
<col width="62%" />
<col width="12%" />
<col width="10%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m5_01</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type</td>
<td align="right">0.8534625</td>
<td align="right">0.4916075</td>
<td align="right">6.701047</td>
</tr>
<tr class="even">
<td align="left">m5_02</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+best_pic_nom</td>
<td align="right">0.8527545</td>
<td align="right">0.4917559</td>
<td align="right">6.703804</td>
</tr>
<tr class="odd">
<td align="left">m5_03</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+best_pic_win</td>
<td align="right">0.8528001</td>
<td align="right">0.4913087</td>
<td align="right">6.702369</td>
</tr>
<tr class="even">
<td align="left">m5_04</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+best_dir_win</td>
<td align="right">0.8530153</td>
<td align="right">0.4922052</td>
<td align="right">6.713829</td>
</tr>
</tbody>
</table>
<p>Best model(s):</p>
<div class="sourceCode" id="cb196"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb196-1"><a href="#cb196-1" tabindex="-1"></a><span class="co"># model_eval</span></span>
<span id="cb196-2"><a href="#cb196-2" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb196-3"><a href="#cb196-3" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2) <span class="sc">|</span></span>
<span id="cb196-4"><a href="#cb196-4" tabindex="-1"></a>         RMSE <span class="sc">==</span> <span class="fu">min</span>(RMSE)))</span></code></pre></div>
<table>
<colgroup>
<col width="6%" />
<col width="62%" />
<col width="12%" />
<col width="10%" />
<col width="9%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m5_01</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type</td>
<td align="right">0.8534625</td>
<td align="right">0.4916075</td>
<td align="right">6.701047</td>
</tr>
<tr class="even">
<td align="left">m5_03</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+best_pic_win</td>
<td align="right">0.8528001</td>
<td align="right">0.4913087</td>
<td align="right">6.702369</td>
</tr>
</tbody>
</table>
<p>Model m5_01 has the better fit with the training data (largest
adjusted R2). Model m5_03 has the better prediction accuracy tested with
the verification data (smallest RMSE).</p>
<p>Best model is “m5_01”: audience_score + critics_score + genre +
log(runtime) + title_type</p>
<div class="sourceCode" id="cb197"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="#cb197-1" tabindex="-1"></a><span class="co"># STEP 2: Best model</span></span>
<span id="cb197-2"><a href="#cb197-2" tabindex="-1"></a>m5 <span class="ot">&lt;-</span> m5_01</span>
<span id="cb197-3"><a href="#cb197-3" tabindex="-1"></a><span class="co"># summary(m5)</span></span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>STEP 6: Add 6th predictor</strong></p>
<p><strong>6-01: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + title_type + best_pic_nom</strong></p>
<div class="sourceCode" id="cb198"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="#cb198-1" tabindex="-1"></a><span class="co"># STEP 6: Add 6th predictor</span></span>
<span id="cb198-2"><a href="#cb198-2" tabindex="-1"></a>m6_01 <span class="ot">&lt;-</span> <span class="fu">update</span>(m5, . <span class="sc">~</span> . <span class="sc">+</span>best_pic_nom, <span class="at">data =</span> train_select)</span>
<span id="cb198-3"><a href="#cb198-3" tabindex="-1"></a><span class="co"># summary(m6_01)</span></span>
<span id="cb198-4"><a href="#cb198-4" tabindex="-1"></a>adjR2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m6_01)<span class="sc">$</span>adj.r.squared</span>
<span id="cb198-5"><a href="#cb198-5" tabindex="-1"></a></span>
<span id="cb198-6"><a href="#cb198-6" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb198-7"><a href="#cb198-7" tabindex="-1"></a>verify_select2 <span class="ot">&lt;-</span> verify_select <span class="sc">%&gt;%</span> </span>
<span id="cb198-8"><a href="#cb198-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">predict</span>(m6_01, verify_select),</span>
<span id="cb198-9"><a href="#cb198-9" tabindex="-1"></a>         <span class="at">residual =</span> imdb_rating <span class="sc">-</span> fitted,</span>
<span id="cb198-10"><a href="#cb198-10" tabindex="-1"></a>         <span class="at">ape =</span> <span class="fu">abs</span>(residual)<span class="sc">/</span>imdb_rating)</span>
<span id="cb198-11"><a href="#cb198-11" tabindex="-1"></a><span class="co"># Accuracy measures</span></span>
<span id="cb198-12"><a href="#cb198-12" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(verify_select2<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(verify_select2))</span>
<span id="cb198-13"><a href="#cb198-13" tabindex="-1"></a>mean_ape <span class="ot">&lt;-</span> <span class="fu">mean</span>(verify_select2<span class="sc">$</span>ape) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb198-14"><a href="#cb198-14" tabindex="-1"></a></span>
<span id="cb198-15"><a href="#cb198-15" tabindex="-1"></a><span class="co"># Register model measures</span></span>
<span id="cb198-16"><a href="#cb198-16" tabindex="-1"></a>model_eval[<span class="dv">31</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;m6_01&quot;</span></span>
<span id="cb198-17"><a href="#cb198-17" tabindex="-1"></a>model_eval[<span class="dv">31</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;audience_score+critics_score+genre+log(runtime)+title_type+best_pic_nom&quot;</span></span>
<span id="cb198-18"><a href="#cb198-18" tabindex="-1"></a>model_eval[<span class="dv">31</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> adjR2</span>
<span id="cb198-19"><a href="#cb198-19" tabindex="-1"></a>model_eval[<span class="dv">31</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> rmse</span>
<span id="cb198-20"><a href="#cb198-20" tabindex="-1"></a>model_eval[<span class="dv">31</span>,<span class="dv">5</span>] <span class="ot">&lt;-</span> mean_ape</span>
<span id="cb198-21"><a href="#cb198-21" tabindex="-1"></a></span>
<span id="cb198-22"><a href="#cb198-22" tabindex="-1"></a>model_eval[<span class="dv">31</span>,]</span></code></pre></div>
<pre><code>##    model
## 31 m6_01
##                                                                  variables
## 31 audience_score+critics_score+genre+log(runtime)+title_type+best_pic_nom
##    adjusted_R2     RMSE mean_APE
## 31   0.8532161 0.491785 6.692868</code></pre>
<p><br />
</p>
<p><strong>6-02: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + title_type + best_pic_win</strong></p>
<pre><code>##    model
## 32 m6_02
##                                                                  variables
## 32 audience_score+critics_score+genre+log(runtime)+title_type+best_pic_win
##    adjusted_R2      RMSE mean_APE
## 32    0.853267 0.4913196 6.692526</code></pre>
<p><br />
</p>
<p><strong>6-03: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + title_type + best_dir_win</strong></p>
<pre><code>##    model
## 33 m6_03
##                                                                  variables
## 33 audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win
##    adjusted_R2      RMSE mean_APE
## 33   0.8534709 0.4921523 6.695027</code></pre>
<p><br />
</p>
<p><strong>Evaluation STEP 6 (6th predictor)</strong></p>
<p>Select the model with the largest adjusted R2 and compare with
smallest RMSE from verification dataset.</p>
<p>Summary STEP 6:</p>
<div class="sourceCode" id="cb202"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="#cb202-1" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb202-2"><a href="#cb202-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m6&quot;</span>, model)))</span></code></pre></div>
<table>
<colgroup>
<col width="5%" />
<col width="66%" />
<col width="11%" />
<col width="9%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m6_01</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_pic_nom</td>
<td align="right">0.8532161</td>
<td align="right">0.4917850</td>
<td align="right">6.692868</td>
</tr>
<tr class="even">
<td align="left">m6_02</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_pic_win</td>
<td align="right">0.8532670</td>
<td align="right">0.4913196</td>
<td align="right">6.692526</td>
</tr>
<tr class="odd">
<td align="left">m6_03</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win</td>
<td align="right">0.8534709</td>
<td align="right">0.4921523</td>
<td align="right">6.695027</td>
</tr>
</tbody>
</table>
<p>Best model(s):</p>
<div class="sourceCode" id="cb203"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb203-1"><a href="#cb203-1" tabindex="-1"></a><span class="co"># model_eval</span></span>
<span id="cb203-2"><a href="#cb203-2" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb203-3"><a href="#cb203-3" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2) <span class="sc">|</span></span>
<span id="cb203-4"><a href="#cb203-4" tabindex="-1"></a>         RMSE <span class="sc">==</span> <span class="fu">min</span>(RMSE)))</span></code></pre></div>
<table>
<colgroup>
<col width="5%" />
<col width="66%" />
<col width="11%" />
<col width="9%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m5_03</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+best_pic_win</td>
<td align="right">0.8528001</td>
<td align="right">0.4913087</td>
<td align="right">6.702369</td>
</tr>
<tr class="even">
<td align="left">m6_03</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win</td>
<td align="right">0.8534709</td>
<td align="right">0.4921523</td>
<td align="right">6.695027</td>
</tr>
</tbody>
</table>
<p>Model m6_03 has the better fit with the training data (largest
adjusted R2). Model m5_03 has the better prediction accuracy tested with
the verification data (smallest RMSE).</p>
<p>Best model is “m6_03”: audience_score + critics_score + genre +
log(runtime) + title_type + best_dir_win</p>
<div class="sourceCode" id="cb204"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="#cb204-1" tabindex="-1"></a><span class="co"># STEP 2: Best model</span></span>
<span id="cb204-2"><a href="#cb204-2" tabindex="-1"></a>m6 <span class="ot">&lt;-</span> m6_03</span>
<span id="cb204-3"><a href="#cb204-3" tabindex="-1"></a><span class="co"># summary(m5)</span></span></code></pre></div>
<p><br />
<br />
</p>
<p><strong>STEP 7: Add 7th predictor</strong></p>
<p><strong>7-01: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + title_type + best_dir_win + best_pic_nom</strong></p>
<div class="sourceCode" id="cb205"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="#cb205-1" tabindex="-1"></a><span class="co"># STEP 7: Add 7th predictor</span></span>
<span id="cb205-2"><a href="#cb205-2" tabindex="-1"></a>m7_01 <span class="ot">&lt;-</span> <span class="fu">update</span>(m6, . <span class="sc">~</span> . <span class="sc">+</span>best_pic_nom, <span class="at">data =</span> train_select)</span>
<span id="cb205-3"><a href="#cb205-3" tabindex="-1"></a><span class="co"># summary(m7_01)</span></span>
<span id="cb205-4"><a href="#cb205-4" tabindex="-1"></a>adjR2 <span class="ot">&lt;-</span> <span class="fu">summary</span>(m7_01)<span class="sc">$</span>adj.r.squared</span>
<span id="cb205-5"><a href="#cb205-5" tabindex="-1"></a></span>
<span id="cb205-6"><a href="#cb205-6" tabindex="-1"></a><span class="co"># Predict</span></span>
<span id="cb205-7"><a href="#cb205-7" tabindex="-1"></a>verify_select2 <span class="ot">&lt;-</span> verify_select <span class="sc">%&gt;%</span> </span>
<span id="cb205-8"><a href="#cb205-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">fitted =</span> <span class="fu">predict</span>(m7_01, verify_select),</span>
<span id="cb205-9"><a href="#cb205-9" tabindex="-1"></a>         <span class="at">residual =</span> imdb_rating <span class="sc">-</span> fitted,</span>
<span id="cb205-10"><a href="#cb205-10" tabindex="-1"></a>         <span class="at">ape =</span> <span class="fu">abs</span>(residual)<span class="sc">/</span>imdb_rating)</span>
<span id="cb205-11"><a href="#cb205-11" tabindex="-1"></a><span class="co"># Accuracy measures</span></span>
<span id="cb205-12"><a href="#cb205-12" tabindex="-1"></a>rmse <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(verify_select2<span class="sc">$</span>residual<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(verify_select2))</span>
<span id="cb205-13"><a href="#cb205-13" tabindex="-1"></a>mean_ape <span class="ot">&lt;-</span> <span class="fu">mean</span>(verify_select2<span class="sc">$</span>ape) <span class="sc">*</span> <span class="dv">100</span> </span>
<span id="cb205-14"><a href="#cb205-14" tabindex="-1"></a></span>
<span id="cb205-15"><a href="#cb205-15" tabindex="-1"></a><span class="co"># Register model measures</span></span>
<span id="cb205-16"><a href="#cb205-16" tabindex="-1"></a>model_eval[<span class="dv">34</span>,<span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="st">&quot;m7_01&quot;</span></span>
<span id="cb205-17"><a href="#cb205-17" tabindex="-1"></a>model_eval[<span class="dv">34</span>,<span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="st">&quot;audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win+best_pic_nom&quot;</span></span>
<span id="cb205-18"><a href="#cb205-18" tabindex="-1"></a>model_eval[<span class="dv">34</span>,<span class="dv">3</span>] <span class="ot">&lt;-</span> adjR2</span>
<span id="cb205-19"><a href="#cb205-19" tabindex="-1"></a>model_eval[<span class="dv">34</span>,<span class="dv">4</span>] <span class="ot">&lt;-</span> rmse</span>
<span id="cb205-20"><a href="#cb205-20" tabindex="-1"></a>model_eval[<span class="dv">34</span>,<span class="dv">5</span>] <span class="ot">&lt;-</span> mean_ape</span>
<span id="cb205-21"><a href="#cb205-21" tabindex="-1"></a></span>
<span id="cb205-22"><a href="#cb205-22" tabindex="-1"></a>model_eval[<span class="dv">34</span>,]</span></code></pre></div>
<pre><code>##    model
## 34 m7_01
##                                                                               variables
## 34 audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win+best_pic_nom
##    adjusted_R2      RMSE mean_APE
## 34   0.8532064 0.4923146  6.68744</code></pre>
<p><br />
</p>
<p><strong>7-02: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + title_type + best_dir_win + best_pic_win</strong></p>
<pre><code>##    model
## 35 m7_02
##                                                                               variables
## 35 audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win+best_pic_win
##    adjusted_R2      RMSE mean_APE
## 35   0.8531745 0.4918788 6.681094</code></pre>
<p><br />
<br />
</p>
<p><strong>Evaluation STEP 7 (7th predictor)</strong></p>
<p>Select the model with the largest adjusted R2 and compare with
smallest RMSE from verification dataset.</p>
<p>Summary STEP 7:</p>
<div class="sourceCode" id="cb208"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="#cb208-1" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb208-2"><a href="#cb208-2" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m7&quot;</span>, model)))</span></code></pre></div>
<table>
<colgroup>
<col width="4%" />
<col width="69%" />
<col width="9%" />
<col width="8%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m7_01</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win+best_pic_nom</td>
<td align="right">0.8532064</td>
<td align="right">0.4923146</td>
<td align="right">6.687440</td>
</tr>
<tr class="even">
<td align="left">m7_02</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win+best_pic_win</td>
<td align="right">0.8531745</td>
<td align="right">0.4918788</td>
<td align="right">6.681094</td>
</tr>
</tbody>
</table>
<p>Best model(s):</p>
<div class="sourceCode" id="cb209"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="#cb209-1" tabindex="-1"></a><span class="co"># model_eval</span></span>
<span id="cb209-2"><a href="#cb209-2" tabindex="-1"></a><span class="fu">kable</span>(model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb209-3"><a href="#cb209-3" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2) <span class="sc">|</span></span>
<span id="cb209-4"><a href="#cb209-4" tabindex="-1"></a>         RMSE <span class="sc">==</span> <span class="fu">min</span>(RMSE)))</span></code></pre></div>
<table>
<colgroup>
<col width="5%" />
<col width="66%" />
<col width="11%" />
<col width="9%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
<th align="right">mean_APE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m5_03</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+best_pic_win</td>
<td align="right">0.8528001</td>
<td align="right">0.4913087</td>
<td align="right">6.702369</td>
</tr>
<tr class="even">
<td align="left">m6_03</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win</td>
<td align="right">0.8534709</td>
<td align="right">0.4921523</td>
<td align="right">6.695027</td>
</tr>
</tbody>
</table>
<p>Adding a 7th predictor has not improved the model any more. According
to our manual selection approach, using adjusted R-square, as decision
criteria, the best model is:</p>
<p><strong>m6_03: imdb_rating ~ audience_score + critics_score + genre +
log(runtime) + title_type + best_dir_win</strong><br />
<br />
</p>
</div>
<div id="alternative-mass-package" class="section level3">
<h3>ALTERNATIVE: MASS package</h3>
<p>R has convenient packages that allow the whole forward and backward
step-by-step selection approach with one function call. (This was not
part of the project assignment, but we highly recommend it). A good
guide to the function can be found <a
href="https://quantifyinghealth.com/stepwise-regression-in-r/#:~:text=How%20to%20run%20forward%20stepwise%20linear%20regression%20library%28MASS%29,variables%20direction%20%3D%20%27forward%27%2C%20%23%20run%20forward%20selection">here</a></p>
<p>First, we have to modify our input dataset slightly:</p>
<div class="sourceCode" id="cb210"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="#cb210-1" tabindex="-1"></a><span class="co"># Prepare training data dataset</span></span>
<span id="cb210-2"><a href="#cb210-2" tabindex="-1"></a>train_select2 <span class="ot">&lt;-</span> train_select <span class="sc">%&gt;%</span> </span>
<span id="cb210-3"><a href="#cb210-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">runtime_log =</span> <span class="fu">log</span>(runtime)) <span class="sc">%&gt;%</span> </span>
<span id="cb210-4"><a href="#cb210-4" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>runtime,</span>
<span id="cb210-5"><a href="#cb210-5" tabindex="-1"></a>         <span class="sc">-</span>thtr_rel_date)</span></code></pre></div>
<p><br />
</p>
<p>Second, we have to build a full model and a null model:</p>
<div class="sourceCode" id="cb211"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="#cb211-1" tabindex="-1"></a><span class="co"># Build models full and null</span></span>
<span id="cb211-2"><a href="#cb211-2" tabindex="-1"></a>m_full <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> ., <span class="at">data =</span> train_select2)</span>
<span id="cb211-3"><a href="#cb211-3" tabindex="-1"></a>m_null <span class="ot">&lt;-</span> <span class="fu">lm</span>(imdb_rating <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> train_select2)</span></code></pre></div>
<p><br />
</p>
<p>Forward selection approach:</p>
<div class="sourceCode" id="cb212"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="#cb212-1" tabindex="-1"></a><span class="co"># Forward selection approach</span></span>
<span id="cb212-2"><a href="#cb212-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb212-3"><a href="#cb212-3" tabindex="-1"></a><span class="fu">step</span>(m_null, <span class="at">direction =</span> <span class="st">&quot;forward&quot;</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> m_full,</span>
<span id="cb212-4"><a href="#cb212-4" tabindex="-1"></a>                                                 <span class="at">lower =</span> m_null),</span>
<span id="cb212-5"><a href="#cb212-5" tabindex="-1"></a>     <span class="at">trace =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb212-6"><a href="#cb212-6" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ audience_score + critics_score + genre + 
##     runtime_log, data = train_select2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.47476 -0.20900  0.02308  0.24852  1.11603 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     1.7116690  0.6007292   2.849 0.004585 ** 
## audience_score                  0.0336498  0.0013899  24.210  &lt; 2e-16 ***
## critics_score                   0.0090751  0.0009844   9.219  &lt; 2e-16 ***
## genreAnimation                 -0.2790586  0.1646319  -1.695 0.090766 .  
## genreArt House &amp; International  0.0498693  0.1407809   0.354 0.723332    
## genreComedy                    -0.2068684  0.0806024  -2.567 0.010598 *  
## genreDocumentary                0.3152836  0.0982333   3.210 0.001426 ** 
## genreDrama                      0.0237413  0.0704210   0.337 0.736175    
## genreHorror                    -0.0556447  0.1184759  -0.470 0.638820    
## genreMusical &amp; Performing Arts -0.0232443  0.1564131  -0.149 0.881930    
## genreMystery &amp; Suspense         0.1731705  0.0876575   1.976 0.048825 *  
## genreOther                     -0.1143020  0.1211071  -0.944 0.345779    
## genreScience Fiction &amp; Fantasy -0.2207139  0.1744752  -1.265 0.206528    
## runtime_log                     0.4650320  0.1307605   3.556 0.000416 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3961 on 445 degrees of freedom
## Multiple R-squared:  0.8572, Adjusted R-squared:  0.853 
## F-statistic: 205.4 on 13 and 445 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb214"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="#cb214-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:MASS&quot;</span>, <span class="at">unload =</span> <span class="cn">TRUE</span>)  <span class="co"># - remove package because masking SELECT function</span></span></code></pre></div>
<p><br />
</p>
<p>Backward elimination approach:</p>
<div class="sourceCode" id="cb215"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="#cb215-1" tabindex="-1"></a><span class="co"># Backward elimination approach</span></span>
<span id="cb215-2"><a href="#cb215-2" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb215-3"><a href="#cb215-3" tabindex="-1"></a><span class="fu">step</span>(m_full, <span class="at">direction =</span> <span class="st">&quot;backward&quot;</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">upper =</span> m_full,</span>
<span id="cb215-4"><a href="#cb215-4" tabindex="-1"></a>                                                  <span class="at">lower =</span> m_null), </span>
<span id="cb215-5"><a href="#cb215-5" tabindex="-1"></a>     <span class="at">trace =</span> <span class="dv">0</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb215-6"><a href="#cb215-6" tabindex="-1"></a>  <span class="fu">summary</span>()</span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = imdb_rating ~ critics_score + audience_score + genre + 
##     runtime_log, data = train_select2)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -1.47476 -0.20900  0.02308  0.24852  1.11603 
## 
## Coefficients:
##                                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)                     1.7116690  0.6007292   2.849 0.004585 ** 
## critics_score                   0.0090751  0.0009844   9.219  &lt; 2e-16 ***
## audience_score                  0.0336498  0.0013899  24.210  &lt; 2e-16 ***
## genreAnimation                 -0.2790586  0.1646319  -1.695 0.090766 .  
## genreArt House &amp; International  0.0498693  0.1407809   0.354 0.723332    
## genreComedy                    -0.2068684  0.0806024  -2.567 0.010598 *  
## genreDocumentary                0.3152836  0.0982333   3.210 0.001426 ** 
## genreDrama                      0.0237413  0.0704210   0.337 0.736175    
## genreHorror                    -0.0556447  0.1184759  -0.470 0.638820    
## genreMusical &amp; Performing Arts -0.0232443  0.1564131  -0.149 0.881930    
## genreMystery &amp; Suspense         0.1731705  0.0876575   1.976 0.048825 *  
## genreOther                     -0.1143020  0.1211071  -0.944 0.345779    
## genreScience Fiction &amp; Fantasy -0.2207139  0.1744752  -1.265 0.206528    
## runtime_log                     0.4650320  0.1307605   3.556 0.000416 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.3961 on 445 degrees of freedom
## Multiple R-squared:  0.8572, Adjusted R-squared:  0.853 
## F-statistic: 205.4 on 13 and 445 DF,  p-value: &lt; 2.2e-16</code></pre>
<div class="sourceCode" id="cb217"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="#cb217-1" tabindex="-1"></a><span class="fu">detach</span>(<span class="st">&quot;package:MASS&quot;</span>, <span class="at">unload =</span> <span class="cn">TRUE</span>) <span class="co"># - remove package because masking SELECT function</span></span></code></pre></div>
<p><br />
</p>
<p>Forward and backward approach arriving at the same model:<br />
<strong>imdb_rating ~ critics_score + audience_score + genre +
runtime_log</strong><br />
<br />
</p>
</div>
<div id="model-selection" class="section level3">
<h3>Model selection</h3>
<p>Plotting the model performance over each step, measured by adjusted
R-squared from training data and RMSE from verfication data:</p>
<div class="sourceCode" id="cb218"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="#cb218-1" tabindex="-1"></a><span class="co"># Plot stepwise improvement of adjusted R2 and RMSE</span></span>
<span id="cb218-2"><a href="#cb218-2" tabindex="-1"></a></span>
<span id="cb218-3"><a href="#cb218-3" tabindex="-1"></a><span class="co"># Create a data frame for best model by each step</span></span>
<span id="cb218-4"><a href="#cb218-4" tabindex="-1"></a>model_eval_best <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">character</span>(),</span>
<span id="cb218-5"><a href="#cb218-5" tabindex="-1"></a>                   <span class="at">variables =</span> <span class="fu">character</span>(),</span>
<span id="cb218-6"><a href="#cb218-6" tabindex="-1"></a>                   <span class="at">adjusted_R2 =</span> <span class="fu">numeric</span>(),</span>
<span id="cb218-7"><a href="#cb218-7" tabindex="-1"></a>                   <span class="at">RMSE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb218-8"><a href="#cb218-8" tabindex="-1"></a>                   <span class="at">mean_APE =</span> <span class="fu">numeric</span>(),</span>
<span id="cb218-9"><a href="#cb218-9" tabindex="-1"></a>                   <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb218-10"><a href="#cb218-10" tabindex="-1"></a></span>
<span id="cb218-11"><a href="#cb218-11" tabindex="-1"></a>model_eval_best[<span class="dv">1</span>,] <span class="ot">&lt;-</span> model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb218-12"><a href="#cb218-12" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m1&quot;</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-13"><a href="#cb218-13" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2))</span>
<span id="cb218-14"><a href="#cb218-14" tabindex="-1"></a></span>
<span id="cb218-15"><a href="#cb218-15" tabindex="-1"></a>model_eval_best[<span class="dv">2</span>,] <span class="ot">&lt;-</span> model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb218-16"><a href="#cb218-16" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m2&quot;</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-17"><a href="#cb218-17" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2))</span>
<span id="cb218-18"><a href="#cb218-18" tabindex="-1"></a></span>
<span id="cb218-19"><a href="#cb218-19" tabindex="-1"></a>model_eval_best[<span class="dv">3</span>,] <span class="ot">&lt;-</span> model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb218-20"><a href="#cb218-20" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m3&quot;</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-21"><a href="#cb218-21" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2))</span>
<span id="cb218-22"><a href="#cb218-22" tabindex="-1"></a>   </span>
<span id="cb218-23"><a href="#cb218-23" tabindex="-1"></a>model_eval_best[<span class="dv">4</span>,] <span class="ot">&lt;-</span> model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb218-24"><a href="#cb218-24" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m4&quot;</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-25"><a href="#cb218-25" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2))</span>
<span id="cb218-26"><a href="#cb218-26" tabindex="-1"></a></span>
<span id="cb218-27"><a href="#cb218-27" tabindex="-1"></a>model_eval_best[<span class="dv">5</span>,] <span class="ot">&lt;-</span> model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb218-28"><a href="#cb218-28" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m5&quot;</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-29"><a href="#cb218-29" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2))</span>
<span id="cb218-30"><a href="#cb218-30" tabindex="-1"></a></span>
<span id="cb218-31"><a href="#cb218-31" tabindex="-1"></a>model_eval_best[<span class="dv">6</span>,] <span class="ot">&lt;-</span> model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb218-32"><a href="#cb218-32" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m6&quot;</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-33"><a href="#cb218-33" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2))</span>
<span id="cb218-34"><a href="#cb218-34" tabindex="-1"></a></span>
<span id="cb218-35"><a href="#cb218-35" tabindex="-1"></a>model_eval_best[<span class="dv">7</span>,] <span class="ot">&lt;-</span> model_eval <span class="sc">%&gt;%</span> </span>
<span id="cb218-36"><a href="#cb218-36" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">grepl</span>(<span class="st">&quot;m7&quot;</span>, model)) <span class="sc">%&gt;%</span> </span>
<span id="cb218-37"><a href="#cb218-37" tabindex="-1"></a>  <span class="fu">filter</span>(adjusted_R2 <span class="sc">==</span> <span class="fu">max</span>(adjusted_R2))</span>
<span id="cb218-38"><a href="#cb218-38" tabindex="-1"></a></span>
<span id="cb218-39"><a href="#cb218-39" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> model_eval_best <span class="sc">%&gt;%</span></span>
<span id="cb218-40"><a href="#cb218-40" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> adjusted_R2, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb218-41"><a href="#cb218-41" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb218-42"><a href="#cb218-42" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb218-43"><a href="#cb218-43" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.76</span>, <span class="fl">0.86</span>)<span class="sc">+</span></span>
<span id="cb218-44"><a href="#cb218-44" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model selection by adj. R-squared&quot;</span>,</span>
<span id="cb218-45"><a href="#cb218-45" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Higher is better&quot;</span>)<span class="sc">+</span></span>
<span id="cb218-46"><a href="#cb218-46" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb218-47"><a href="#cb218-47" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb218-48"><a href="#cb218-48" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb218-49"><a href="#cb218-49" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span>
<span id="cb218-50"><a href="#cb218-50" tabindex="-1"></a></span>
<span id="cb218-51"><a href="#cb218-51" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> model_eval_best <span class="sc">%&gt;%</span></span>
<span id="cb218-52"><a href="#cb218-52" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> model, <span class="at">y =</span> RMSE, <span class="at">group =</span> <span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb218-53"><a href="#cb218-53" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb218-54"><a href="#cb218-54" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb218-55"><a href="#cb218-55" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">0.45</span>, <span class="fl">0.6</span>)<span class="sc">+</span></span>
<span id="cb218-56"><a href="#cb218-56" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;RMSE from verification data&quot;</span>,</span>
<span id="cb218-57"><a href="#cb218-57" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Lower is better&quot;</span>)<span class="sc">+</span></span>
<span id="cb218-58"><a href="#cb218-58" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;&quot;</span>)<span class="sc">+</span></span>
<span id="cb218-59"><a href="#cb218-59" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb218-60"><a href="#cb218-60" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb218-61"><a href="#cb218-61" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span>
<span id="cb218-62"><a href="#cb218-62" tabindex="-1"></a></span>
<span id="cb218-63"><a href="#cb218-63" tabindex="-1"></a>p1 <span class="sc">+</span> p2</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-167-1.png" width="768" /></p>
<table style="width:100%;">
<colgroup>
<col width="5%" />
<col width="75%" />
<col width="10%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">model</th>
<th align="left">variables</th>
<th align="right">adjusted_R2</th>
<th align="right">RMSE</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">m1_03</td>
<td align="left">audience_score</td>
<td align="right">0.7939711</td>
<td align="right">0.5796008</td>
</tr>
<tr class="even">
<td align="left">m2_02</td>
<td align="left">audience_score+critics_score</td>
<td align="right">0.8350502</td>
<td align="right">0.5278249</td>
</tr>
<tr class="odd">
<td align="left">m3_03</td>
<td align="left">audience_score+critics_score+genre</td>
<td align="right">0.8491622</td>
<td align="right">0.5115876</td>
</tr>
<tr class="even">
<td align="left">m4_01</td>
<td align="left">audience_score+critics_score+genre+log(runtime)</td>
<td align="right">0.8530012</td>
<td align="right">0.4915971</td>
</tr>
<tr class="odd">
<td align="left">m5_01</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type</td>
<td align="right">0.8534625</td>
<td align="right">0.4916075</td>
</tr>
<tr class="even">
<td align="left">m6_03</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win</td>
<td align="right">0.8534709</td>
<td align="right">0.4921523</td>
</tr>
<tr class="odd">
<td align="left">m7_01</td>
<td
align="left">audience_score+critics_score+genre+log(runtime)+title_type+best_dir_win+best_pic_nom</td>
<td align="right">0.8532064</td>
<td align="right">0.4923146</td>
</tr>
</tbody>
</table>
<p><br />
</p>
<p>Comparing the three best models by adjusted R2 and RMSE:<br />
</p>
<p>In respect of adjusted R2, model m6_03 would be the best fitted model
using 6 predictors. Looking at the left graph adjusted R2 reaches a
plateau at model m4_01 and is flattening out through m5_01 and m6_03. In
respect of RMSE, model m4_01 would result in the best prediction using
the verification dataset.<br />
</p>
<p>Comparing the three best models by coefficient estimates and their
p-values</p>
<div class="sourceCode" id="cb219"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="#cb219-1" tabindex="-1"></a><span class="co"># Compare models by coefficient estimates and their p-values</span></span>
<span id="cb219-2"><a href="#cb219-2" tabindex="-1"></a>df_m4 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">summary</span>(m4_01)) </span>
<span id="cb219-3"><a href="#cb219-3" tabindex="-1"></a>df_m5 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">summary</span>(m5_01)) </span>
<span id="cb219-4"><a href="#cb219-4" tabindex="-1"></a>df_m6 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(<span class="fu">summary</span>(m6)) </span>
<span id="cb219-5"><a href="#cb219-5" tabindex="-1"></a></span>
<span id="cb219-6"><a href="#cb219-6" tabindex="-1"></a>variables <span class="ot">&lt;-</span> <span class="fu">as.character</span>(df_m6<span class="sc">$</span>term)</span>
<span id="cb219-7"><a href="#cb219-7" tabindex="-1"></a>estimates_m4 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(df_m4<span class="sc">$</span>estimate),<span class="dv">4</span>)</span>
<span id="cb219-8"><a href="#cb219-8" tabindex="-1"></a>estimates_m5 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(df_m5<span class="sc">$</span>estimate),<span class="dv">4</span>)</span>
<span id="cb219-9"><a href="#cb219-9" tabindex="-1"></a>estimates_m6 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(df_m6<span class="sc">$</span>estimate),<span class="dv">4</span>)</span>
<span id="cb219-10"><a href="#cb219-10" tabindex="-1"></a>p_value_m4 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(df_m4<span class="sc">$</span>p.value), <span class="dv">4</span>)</span>
<span id="cb219-11"><a href="#cb219-11" tabindex="-1"></a>p_value_m5 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(df_m5<span class="sc">$</span>p.value), <span class="dv">4</span>)</span>
<span id="cb219-12"><a href="#cb219-12" tabindex="-1"></a>p_value_m6 <span class="ot">&lt;-</span> <span class="fu">round</span>(<span class="fu">as.numeric</span>(df_m6<span class="sc">$</span>p.value), <span class="dv">4</span>)</span>
<span id="cb219-13"><a href="#cb219-13" tabindex="-1"></a></span>
<span id="cb219-14"><a href="#cb219-14" tabindex="-1"></a>max_length <span class="ot">&lt;-</span> <span class="fu">length</span>(variables)</span>
<span id="cb219-15"><a href="#cb219-15" tabindex="-1"></a><span class="fu">length</span>(estimates_m4) <span class="ot">&lt;-</span> max_length</span>
<span id="cb219-16"><a href="#cb219-16" tabindex="-1"></a><span class="fu">length</span>(estimates_m5) <span class="ot">&lt;-</span> max_length</span>
<span id="cb219-17"><a href="#cb219-17" tabindex="-1"></a><span class="fu">length</span>(p_value_m4) <span class="ot">&lt;-</span> max_length</span>
<span id="cb219-18"><a href="#cb219-18" tabindex="-1"></a><span class="fu">length</span>(p_value_m5) <span class="ot">&lt;-</span> max_length</span>
<span id="cb219-19"><a href="#cb219-19" tabindex="-1"></a></span>
<span id="cb219-20"><a href="#cb219-20" tabindex="-1"></a>df_compare <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(variables,</span>
<span id="cb219-21"><a href="#cb219-21" tabindex="-1"></a>                         estimates_m4,</span>
<span id="cb219-22"><a href="#cb219-22" tabindex="-1"></a>                         estimates_m5,</span>
<span id="cb219-23"><a href="#cb219-23" tabindex="-1"></a>                         estimates_m6,</span>
<span id="cb219-24"><a href="#cb219-24" tabindex="-1"></a>                         p_value_m4,</span>
<span id="cb219-25"><a href="#cb219-25" tabindex="-1"></a>                         p_value_m5,</span>
<span id="cb219-26"><a href="#cb219-26" tabindex="-1"></a>                         p_value_m6)</span></code></pre></div>
<table style="width:100%;">
<colgroup>
<col width="30%" />
<col width="12%" />
<col width="12%" />
<col width="12%" />
<col width="10%" />
<col width="10%" />
<col width="10%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">variables</th>
<th align="right">estimates_m4</th>
<th align="right">estimates_m5</th>
<th align="right">estimates_m6</th>
<th align="right">p_value_m4</th>
<th align="right">p_value_m5</th>
<th align="right">p_value_m6</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.7117</td>
<td align="right">1.8661</td>
<td align="right">1.9665</td>
<td align="right">0.0046</td>
<td align="right">0.0029</td>
<td align="right">0.0019</td>
</tr>
<tr class="even">
<td align="left">audience_score</td>
<td align="right">0.0336</td>
<td align="right">0.0334</td>
<td align="right">0.0334</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
<tr class="odd">
<td align="left">critics_score</td>
<td align="right">0.0091</td>
<td align="right">0.0091</td>
<td align="right">0.0090</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
<td align="right">0.0000</td>
</tr>
<tr class="even">
<td align="left">genreAnimation</td>
<td align="right">-0.2791</td>
<td align="right">-0.2791</td>
<td align="right">-0.2749</td>
<td align="right">0.0908</td>
<td align="right">0.0902</td>
<td align="right">0.0953</td>
</tr>
<tr class="odd">
<td align="left">genreArt House &amp; International</td>
<td align="right">0.0499</td>
<td align="right">0.0515</td>
<td align="right">0.0601</td>
<td align="right">0.7233</td>
<td align="right">0.7144</td>
<td align="right">0.6698</td>
</tr>
<tr class="even">
<td align="left">genreComedy</td>
<td align="right">-0.2069</td>
<td align="right">-0.2105</td>
<td align="right">-0.2112</td>
<td align="right">0.0106</td>
<td align="right">0.0094</td>
<td align="right">0.0091</td>
</tr>
<tr class="odd">
<td align="left">genreDocumentary</td>
<td align="right">0.3153</td>
<td align="right">0.2423</td>
<td align="right">0.2470</td>
<td align="right">0.0014</td>
<td align="right">0.1835</td>
<td align="right">0.1752</td>
</tr>
<tr class="even">
<td align="left">genreDrama</td>
<td align="right">0.0237</td>
<td align="right">0.0313</td>
<td align="right">0.0348</td>
<td align="right">0.7362</td>
<td align="right">0.6567</td>
<td align="right">0.6217</td>
</tr>
<tr class="odd">
<td align="left">genreHorror</td>
<td align="right">-0.0556</td>
<td align="right">-0.0593</td>
<td align="right">-0.0555</td>
<td align="right">0.6388</td>
<td align="right">0.6167</td>
<td align="right">0.6392</td>
</tr>
<tr class="even">
<td align="left">genreMusical &amp; Performing Arts</td>
<td align="right">-0.0232</td>
<td align="right">-0.0469</td>
<td align="right">-0.0368</td>
<td align="right">0.8819</td>
<td align="right">0.7793</td>
<td align="right">0.8263</td>
</tr>
<tr class="odd">
<td align="left">genreMystery &amp; Suspense</td>
<td align="right">0.1732</td>
<td align="right">0.1735</td>
<td align="right">0.1785</td>
<td align="right">0.0488</td>
<td align="right">0.0481</td>
<td align="right">0.0423</td>
</tr>
<tr class="even">
<td align="left">genreOther</td>
<td align="right">-0.1143</td>
<td align="right">-0.0881</td>
<td align="right">-0.0833</td>
<td align="right">0.3458</td>
<td align="right">0.4696</td>
<td align="right">0.4944</td>
</tr>
<tr class="odd">
<td align="left">genreScience Fiction &amp; Fantasy</td>
<td align="right">-0.2207</td>
<td align="right">-0.2241</td>
<td align="right">-0.2324</td>
<td align="right">0.2065</td>
<td align="right">0.1990</td>
<td align="right">0.1833</td>
</tr>
<tr class="even">
<td align="left">log(runtime)</td>
<td align="right">0.4650</td>
<td align="right">0.4512</td>
<td align="right">0.4312</td>
<td align="right">0.0004</td>
<td align="right">0.0006</td>
<td align="right">0.0012</td>
</tr>
<tr class="odd">
<td align="left">title_typeFeature Film</td>
<td align="right">NA</td>
<td align="right">-0.0802</td>
<td align="right">-0.0866</td>
<td align="right">NA</td>
<td align="right">0.6322</td>
<td align="right">0.6056</td>
</tr>
<tr class="even">
<td align="left">title_typeTV Movie</td>
<td align="right">NA</td>
<td align="right">-0.4398</td>
<td align="right">-0.4429</td>
<td align="right">NA</td>
<td align="right">0.0943</td>
<td align="right">0.0921</td>
</tr>
<tr class="odd">
<td align="left">best_dir_winyes</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.0790</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">0.3118</td>
</tr>
</tbody>
</table>
<p>The p-values for added variables <code>title_type:FeatureFilm</code>,
<code>title_type:TVMovie</code> (m5_01) and
<code>best_dir_win:yes</code> (m6_03) are all greater than 0.05,
i.e. not significant and don’t add much information to the model
anymore. The coefficient estimates do not vary much between the
different models.<br />
</p>
<p>We are in favor of model m4_01 because:</p>
<ul>
<li>the adjust R2 is close to the maximum</li>
<li>it is the simpler model (parsimonious model)</li>
<li>it has the best prediction accuracy (smallest RMSE)</li>
<li>the p-values for <code>title_type</code> and
<code>best_dir_win</code> are not significant</li>
<li>it matches the results from forward and backward approach of the
MASS::step function<br />
</li>
</ul>
<p>Our best model candidate is therefore: <strong>m4_01:
<code>audience_score + critics_score + genre + log(runtime)</code></strong><br />
</p>
<p>Finally, we have to check that the model meets all required
conditions.<br />
</p>
<p><br />
</p>
</div>
<div id="model-condition-check" class="section level3">
<h3>Model condition check</h3>
<p><strong>Quick model check</strong></p>
<div class="sourceCode" id="cb220"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="#cb220-1" tabindex="-1"></a>m_final <span class="ot">&lt;-</span> m4_01</span>
<span id="cb220-2"><a href="#cb220-2" tabindex="-1"></a><span class="co"># summary(m_final)</span></span>
<span id="cb220-3"><a href="#cb220-3" tabindex="-1"></a><span class="fu">plot</span>(m_final, <span class="at">which =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-173-1.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-173-2.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-173-3.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-173-4.png" width="672" /><img src="project2_files/figure-html/unnamed-chunk-173-5.png" width="672" /></p>
<p><br />
Plot 1 (Residual distribution): equally distributed, no remaining
non-linear pattern<br />
Plot 2 (qq-plot): nearly normal distributed, but with some remaining
left skew<br />
Plot 3 (normalized residuals): linear but negative slope, i.e. higher
residuals on left side<br />
Plot 4 (Cook’s distance): still 3 remaining influential points (355, 46.
322)<br />
Plot 5 (Leverage): still 3 larger leverage points (355, 46, 322)<br />
</p>
<p>Removing these three influential point would improve the model of
best fit further. But this will not guarantee that our model will also
perform better in predicting data points from a test dataset that are
outside of our training data.<br />
<br />
<br />
</p>
<p><strong>1. Check for normality of residual</strong></p>
<div class="sourceCode" id="cb221"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb221-1"><a href="#cb221-1" tabindex="-1"></a><span class="co"># Normality check</span></span>
<span id="cb221-2"><a href="#cb221-2" tabindex="-1"></a></span>
<span id="cb221-3"><a href="#cb221-3" tabindex="-1"></a><span class="co"># add fitted values and residuals to data frame</span></span>
<span id="cb221-4"><a href="#cb221-4" tabindex="-1"></a>train_select2 <span class="ot">&lt;-</span> train_select</span>
<span id="cb221-5"><a href="#cb221-5" tabindex="-1"></a>train_select2<span class="sc">$</span>fitted <span class="ot">&lt;-</span> m_final<span class="sc">$</span>fitted.values</span>
<span id="cb221-6"><a href="#cb221-6" tabindex="-1"></a>train_select2<span class="sc">$</span>residuals <span class="ot">&lt;-</span> m_final<span class="sc">$</span>residuals</span>
<span id="cb221-7"><a href="#cb221-7" tabindex="-1"></a></span>
<span id="cb221-8"><a href="#cb221-8" tabindex="-1"></a>train_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb221-9"><a href="#cb221-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> residuals))<span class="sc">+</span></span>
<span id="cb221-10"><a href="#cb221-10" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill =</span> <span class="st">&quot;darkgrey&quot;</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>)<span class="sc">+</span></span>
<span id="cb221-11"><a href="#cb221-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model check: Normal distribution&quot;</span>)<span class="sc">+</span></span>
<span id="cb221-12"><a href="#cb221-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb221-13"><a href="#cb221-13" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb221-14"><a href="#cb221-14" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-174-1.png" width="672" /><br />
The model residuals are <strong>nearly normal distributed</strong> with
a small left skew.<br />
<br />
<br />
</p>
<p><strong>2. Constant variability (homoscedasticity)</strong></p>
<div class="sourceCode" id="cb222"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb222-1"><a href="#cb222-1" tabindex="-1"></a><span class="co"># Homoscedasticity check</span></span>
<span id="cb222-2"><a href="#cb222-2" tabindex="-1"></a>train_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb222-3"><a href="#cb222-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> <span class="fu">abs</span>(residuals)))<span class="sc">+</span></span>
<span id="cb222-4"><a href="#cb222-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb222-5"><a href="#cb222-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb222-6"><a href="#cb222-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb222-7"><a href="#cb222-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model check: Variability&quot;</span>)<span class="sc">+</span></span>
<span id="cb222-8"><a href="#cb222-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb222-9"><a href="#cb222-9" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb222-10"><a href="#cb222-10" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-175-1.png" width="672" /><br />
Due to some outliers (top) the residual variability shows some uneven
distribution. Removing these outliers would optimize the model fit but
not the prediction accuracy of real world data. To improve the model we
may have to add some non-linear relationship (e.g. interaction terms).
As for now, we will accept this condition.<br />
<br />
<br />
</p>
<p><strong>3. Autocorrelation check (time series check)</strong></p>
<div class="sourceCode" id="cb223"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="#cb223-1" tabindex="-1"></a><span class="co"># Autocorrelation check: Idependence of residuals along time axis</span></span>
<span id="cb223-2"><a href="#cb223-2" tabindex="-1"></a>train_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb223-3"><a href="#cb223-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> thtr_rel_date, <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb223-4"><a href="#cb223-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb223-5"><a href="#cb223-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb223-6"><a href="#cb223-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">linetype =</span> <span class="dv">1</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb223-7"><a href="#cb223-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model check: Autocorrelation&quot;</span>)<span class="sc">+</span></span>
<span id="cb223-8"><a href="#cb223-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb223-9"><a href="#cb223-9" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb223-10"><a href="#cb223-10" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-176-1.png" width="672" /><br />
The residuals are randomly distributed along the time axis. We don’t see
any autocorrelation pattern.<br />
<br />
<br />
</p>
<p><strong>4a. Linearity check - <code>residuals</code> vs
<code>audience_score</code></strong></p>
<div class="sourceCode" id="cb224"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="#cb224-1" tabindex="-1"></a><span class="co"># Linearity check: audience_score</span></span>
<span id="cb224-2"><a href="#cb224-2" tabindex="-1"></a>train_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb224-3"><a href="#cb224-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> audience_score, <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb224-4"><a href="#cb224-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb224-5"><a href="#cb224-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb224-6"><a href="#cb224-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb224-7"><a href="#cb224-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model check: Linearity - audience_score&quot;</span>)<span class="sc">+</span></span>
<span id="cb224-8"><a href="#cb224-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb224-9"><a href="#cb224-9" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb224-10"><a href="#cb224-10" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-177-1.png" width="672" /><br />
Some deviation form linearity visible for <code>audience_score</code>
below 30. The low ratings cannot be expressed well with the linear
model. However, most of the data points (&gt;30) are modeled
correctly.<br />
<br />
</p>
<p><strong>4b. Linearity check - <code>residuals</code> vs
<code>critics_score</code></strong></p>
<div class="sourceCode" id="cb225"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="#cb225-1" tabindex="-1"></a><span class="co"># Linearity check: critics_score</span></span>
<span id="cb225-2"><a href="#cb225-2" tabindex="-1"></a>train_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb225-3"><a href="#cb225-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> critics_score, <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb225-4"><a href="#cb225-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb225-5"><a href="#cb225-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb225-6"><a href="#cb225-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb225-7"><a href="#cb225-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model check: Linearity - critics_score&quot;</span>)<span class="sc">+</span></span>
<span id="cb225-8"><a href="#cb225-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb225-9"><a href="#cb225-9" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb225-10"><a href="#cb225-10" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-178-1.png" width="672" /><br />
Some deviation form linearity visible for <code>critics_score</code>
below 30. The low ratings cannot be expressed well with the linear
model. However, most of the data points (&gt;30) are modeled
correctly.<br />
<br />
</p>
<p><strong>4c. Variability check - <code>residuals</code> vs
<code>genre</code></strong></p>
<div class="sourceCode" id="cb226"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb226-1"><a href="#cb226-1" tabindex="-1"></a><span class="co"># Variability check: genres</span></span>
<span id="cb226-2"><a href="#cb226-2" tabindex="-1"></a>train_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb226-3"><a href="#cb226-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">fct_reorder</span>(genre, residuals) , <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb226-4"><a href="#cb226-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">position =</span> <span class="fu">position_dodge</span>(<span class="at">width =</span> <span class="dv">2</span>), <span class="at">color =</span> <span class="st">&quot;lightblue&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span></span>
<span id="cb226-5"><a href="#cb226-5" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb226-6"><a href="#cb226-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model check: Variability - genre&quot;</span>)<span class="sc">+</span></span>
<span id="cb226-7"><a href="#cb226-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb226-8"><a href="#cb226-8" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb226-9"><a href="#cb226-9" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb226-10"><a href="#cb226-10" tabindex="-1"></a>  <span class="fu">coord_flip</span>()</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-179-1.png" width="672" /><br />
There are large differences in the variability between the levels,
caused by outliers with residual &gt; |1|, in total 9 data points.
However, due to large sample size we will proceed with the model.<br />
<br />
</p>
<p><strong>4d. Linearity check - <code>residuals</code> vs
<code>log(runtime)</code></strong></p>
<div class="sourceCode" id="cb227"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="#cb227-1" tabindex="-1"></a><span class="co"># Linearity check: log(runtime)</span></span>
<span id="cb227-2"><a href="#cb227-2" tabindex="-1"></a>train_select2 <span class="sc">%&gt;%</span> </span>
<span id="cb227-3"><a href="#cb227-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log</span>(runtime), <span class="at">y =</span> residuals))<span class="sc">+</span></span>
<span id="cb227-4"><a href="#cb227-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb227-5"><a href="#cb227-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb227-6"><a href="#cb227-6" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">linetype =</span> <span class="st">&quot;dashed&quot;</span>, <span class="at">se =</span> F, <span class="at">color =</span> <span class="st">&quot;blue&quot;</span>)<span class="sc">+</span></span>
<span id="cb227-7"><a href="#cb227-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Model check: Linearity - log(runtime)&quot;</span>)<span class="sc">+</span></span>
<span id="cb227-8"><a href="#cb227-8" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb227-9"><a href="#cb227-9" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb227-10"><a href="#cb227-10" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-180-1.png" width="672" /><br />
The residuals are very well linear distributed. However, we see some
differences in variability. There are several outliers in the lower part
(residual &lt; -1). Due to the large data size we will accept the
model.<br />
<br />
<br />
</p>
<p><strong>Summary condition check</strong></p>
<ol style="list-style-type: decimal">
<li><em>Linearity</em>: Is met. We don’t see a dominant non-linear trend
line in the residuals, except for the lower value range which not
perfectly described by a linear model.<br />
</li>
<li><em>Nearly normal distribution</em>: Is met. However, distribution
is slightly left-skewed due to some extreme values in the negative
range. The sample size is large and we can accept the condition.<br />
</li>
<li><em>Constant variability (homoscedasticity)</em>: Is acceptable. The
residual variability is wider for lower fitted values and narrower for
higher fitted values. </li>
<li><em>Residuals in order of data collection (autocorrelation)</em>: Is
met. The residuals are randomly distributed. No pattern due to order of
collection noticeable.<br />
</li>
<li><em>Residuals against each predictor</em>: all numerical predictors
are linear but but some non-constant variability in the residuals is
visible. The categorical predictor <code>genre</code> is linear but also
shows some larger variability in the residuals between the
categories.<br />
<br />
<br />
<br />
</li>
</ol>
</div>
<div id="summary-modeling" class="section level3">
<h3>Summary Modeling</h3>
<p>The best model was selected by a step-by-step forward selection
approach using the adjusted R-squared measure. The model selection was
further optimized by minimizing the number of predictors by criteria
significance and best model prediction. </p>
<p>The best fitted model has 3 numerical predictors and 1 categorical
predictor with 10 levels, in total 13 predictors:</p>
<p><span class="math display">\[
  \begin{aligned}
  \widehat{imdb\_rating} = b0\\
  &amp;+ b1 \times (critics\_score) + b2 \times (audience\_score) +
  b3 \times (genreAnima) + b4 \times (genreArt)\\
  &amp;+ b5 \times (genreComedy) + b6 \times (genreDrama) + b7 \times
(genreDocu)
  + b8 \times  (genreHorror)\\
  &amp;+ b9 \times (genreMusical) + b10 \times (genreMystery) + b11
\times (genreOther) +
  b12 \times (genreSF)\\
  &amp;+ b13 \times (runtime\_log)
  \end{aligned}
\]</span></p>
<p>Overall the linear model is a reasonable estimate for the given
dataset. However, movies with lower IMDb ratings show a higher
variability in critics and audience scores. For movies with mid or high
ratings the variability is much smaller.<br />
<br />
<br />
</p>
</div>
<div id="answer-the-research-questions" class="section level3">
<h3>Answer the research questions</h3>
<p><strong>a) Can the Internet Movie Database (IMDb) rating be explained
by title_type, genre, or runtime?</strong></p>
<p>The IMDb rating increases by 0.47 points per unit of log(runtime),
i.e. the longer the movie the better the rating on average, when all
other variables are hold constant.</p>
<p>Furthermore, the the IMDb rating increases by 0.32 points for genre
“documentary”, increases by 0.17 points for genre “mystery”, decreases
by 0.21 points for genre “comedy”, and decreases by 0.28 points for
genre “animation” on average, when all other variables are hold
constant.<br />
<br />
</p>
<p><strong>b) Can the Internet Movie Database (IMDb) rating be explained
by other rating measures, such as “Tomatomeasure” critics score or
audience score?</strong></p>
<p>The IMDb rating increases by 0.03 points per unit audience score
(scale 1 -100) and increases by 0.01 points per unit critics score
(scale 1-100) on average, when all other variables are hold constant.
I.e. audience scores have a 3-time stronger relationship with IMDb
rating than critics scores.<br />
<br />
</p>
<p><strong>c) Can the Internet Movie Database (IMDb) rating be explained
by Academy awards or nominations?</strong></p>
<p>Academy awards or nominations for best picture have a minor effect
(increase by 0.08) on the IMDb rating but are not significant. Academy
awards of best actor, actress or director have almost no impact and are
not significant.<br />
<br />
</p>
<p><strong>Note</strong></p>
<p>The model describes only existing relationships between independent
variables and IMDb rating. We cannot draw causation from these findings.
Furthermore, we cannot use the model to make predictions for movie
ratings that are outside of the time frame (1970 -2014). We also cannot
infer the model to the popularity of movies in the general public, but
only to data that are collected with the same variables and
measures.<br />
</p>
<p><br />
</p>
<p><br />
<br />
<br />
</p>
</div>
</div>
<div id="part-5-prediction" class="section level2">
<h2>Part 5: Prediction</h2>
<p>As final step, we will test the model with a test dataset, that was
separated from the training data. We will use our final model and
predict the response variable (imdb_rating_hat) and compare it with the
true value.</p>
<p>As measure of accuracy we will use the Root Mean Square Error (RMSE).
Finally, we will look into residual plots to get some insight into their
distribution and remaining patterns.<br />
</p>
<div id="the-final-model" class="section level3">
<h3>The final model</h3>
<p>In the previous chapter we identified the best fitted model with 3
numerical predictors and 1 categorical predictor with 10 levels, in
total 13 predictors:</p>
<p><span class="math display">\[
  \begin{aligned}
  \widehat{imdb\_rating} = b0\\
  &amp;+ b1 \times (audience\_score) + b2 \times (critics\_score) +
  b3 \times (genreAnima) + b4 \times (genreArt)\\
  &amp;+ b5 \times (genreComedy) + b6 \times (genreDocu) + b7 \times
(genreDrama)
  + b8 \times  (genreHorror)\\
  &amp;+ b9 \times (genreMusical) + b10 \times (genreMystery) + b11
\times (genreOther) +
  b12 \times (genreSF)\\
  &amp;+ b13 \times (runtime\_log)
  \end{aligned}
\]</span><br />
</p>
<table style="width:100%;">
<colgroup>
<col width="42%" />
<col width="15%" />
<col width="13%" />
<col width="15%" />
<col width="13%" />
</colgroup>
<thead>
<tr class="header">
<th align="left">term</th>
<th align="right">estimate</th>
<th align="right">std.error</th>
<th align="right">statistic</th>
<th align="right">p.value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">(Intercept)</td>
<td align="right">1.7116690</td>
<td align="right">0.6007292</td>
<td align="right">2.8493188</td>
<td align="right">0.0045846</td>
</tr>
<tr class="even">
<td align="left">audience_score</td>
<td align="right">0.0336498</td>
<td align="right">0.0013899</td>
<td align="right">24.2101883</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="left">critics_score</td>
<td align="right">0.0090751</td>
<td align="right">0.0009844</td>
<td align="right">9.2192044</td>
<td align="right">0.0000000</td>
</tr>
<tr class="even">
<td align="left">genreAnimation</td>
<td align="right">-0.2790586</td>
<td align="right">0.1646319</td>
<td align="right">-1.6950460</td>
<td align="right">0.0907662</td>
</tr>
<tr class="odd">
<td align="left">genreArt House &amp; International</td>
<td align="right">0.0498693</td>
<td align="right">0.1407809</td>
<td align="right">0.3542333</td>
<td align="right">0.7233319</td>
</tr>
<tr class="even">
<td align="left">genreComedy</td>
<td align="right">-0.2068684</td>
<td align="right">0.0806024</td>
<td align="right">-2.5665297</td>
<td align="right">0.0105983</td>
</tr>
<tr class="odd">
<td align="left">genreDocumentary</td>
<td align="right">0.3152836</td>
<td align="right">0.0982333</td>
<td align="right">3.2095396</td>
<td align="right">0.0014257</td>
</tr>
<tr class="even">
<td align="left">genreDrama</td>
<td align="right">0.0237413</td>
<td align="right">0.0704210</td>
<td align="right">0.3371334</td>
<td align="right">0.7361753</td>
</tr>
<tr class="odd">
<td align="left">genreHorror</td>
<td align="right">-0.0556447</td>
<td align="right">0.1184759</td>
<td align="right">-0.4696712</td>
<td align="right">0.6388200</td>
</tr>
<tr class="even">
<td align="left">genreMusical &amp; Performing Arts</td>
<td align="right">-0.0232443</td>
<td align="right">0.1564131</td>
<td align="right">-0.1486086</td>
<td align="right">0.8819298</td>
</tr>
<tr class="odd">
<td align="left">genreMystery &amp; Suspense</td>
<td align="right">0.1731705</td>
<td align="right">0.0876575</td>
<td align="right">1.9755352</td>
<td align="right">0.0488249</td>
</tr>
<tr class="even">
<td align="left">genreOther</td>
<td align="right">-0.1143020</td>
<td align="right">0.1211071</td>
<td align="right">-0.9438095</td>
<td align="right">0.3457791</td>
</tr>
<tr class="odd">
<td align="left">genreScience Fiction &amp; Fantasy</td>
<td align="right">-0.2207139</td>
<td align="right">0.1744752</td>
<td align="right">-1.2650161</td>
<td align="right">0.2065276</td>
</tr>
<tr class="even">
<td align="left">log(runtime)</td>
<td align="right">0.4650320</td>
<td align="right">0.1307605</td>
<td align="right">3.5563642</td>
<td align="right">0.0004163</td>
</tr>
</tbody>
</table>
<p><br />
</p>
</div>
<div id="prediction-accuracy" class="section level3">
<h3>Prediction accuracy</h3>
<p><strong>Predict <code>imdb_rating_hat</code> for TRAINING data,
compute RMSE</strong></p>
<div class="sourceCode" id="cb228"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="#cb228-1" tabindex="-1"></a><span class="co"># Predict from training data</span></span>
<span id="cb228-2"><a href="#cb228-2" tabindex="-1"></a>train_predict <span class="ot">&lt;-</span> train_select <span class="sc">%&gt;%</span> </span>
<span id="cb228-3"><a href="#cb228-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">data.frame</span>(<span class="fu">predict</span>(m_final, <span class="at">newdata =</span> train_select, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)))</span>
<span id="cb228-4"><a href="#cb228-4" tabindex="-1"></a></span>
<span id="cb228-5"><a href="#cb228-5" tabindex="-1"></a>train_predict <span class="ot">&lt;-</span> train_predict <span class="sc">%&gt;%</span> </span>
<span id="cb228-6"><a href="#cb228-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> imdb_rating <span class="sc">-</span> fit,</span>
<span id="cb228-7"><a href="#cb228-7" tabindex="-1"></a>         <span class="at">interval =</span> (imdb_rating <span class="sc">&gt;=</span> lwr <span class="sc">&amp;</span> imdb_rating <span class="sc">&lt;=</span> upr))</span>
<span id="cb228-8"><a href="#cb228-8" tabindex="-1"></a></span>
<span id="cb228-9"><a href="#cb228-9" tabindex="-1"></a><span class="co"># Accuracy measure of model is mean of absolute percent error</span></span>
<span id="cb228-10"><a href="#cb228-10" tabindex="-1"></a>rmse_train <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(train_predict<span class="sc">$</span>res<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(train_predict))</span>
<span id="cb228-11"><a href="#cb228-11" tabindex="-1"></a></span>
<span id="cb228-12"><a href="#cb228-12" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;RMSE training = &quot;</span>, <span class="fu">round</span>(rmse_train, <span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;RMSE training = 0.39001&quot;</code></pre>
<p><br />
<strong>Predict <code>imdb_rating_hat</code> for TEST data, compute
RMSE</strong></p>
<div class="sourceCode" id="cb230"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="#cb230-1" tabindex="-1"></a><span class="co"># Predict from training data</span></span>
<span id="cb230-2"><a href="#cb230-2" tabindex="-1"></a>test_predict <span class="ot">&lt;-</span> test_select <span class="sc">%&gt;%</span> </span>
<span id="cb230-3"><a href="#cb230-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">data.frame</span>(<span class="fu">predict</span>(m_final, <span class="at">newdata =</span> test_select, <span class="at">interval =</span> <span class="st">&quot;prediction&quot;</span>)))</span>
<span id="cb230-4"><a href="#cb230-4" tabindex="-1"></a></span>
<span id="cb230-5"><a href="#cb230-5" tabindex="-1"></a>test_predict <span class="ot">&lt;-</span> test_predict <span class="sc">%&gt;%</span> </span>
<span id="cb230-6"><a href="#cb230-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">res =</span> imdb_rating <span class="sc">-</span> fit,</span>
<span id="cb230-7"><a href="#cb230-7" tabindex="-1"></a>         <span class="at">interval =</span> (imdb_rating <span class="sc">&gt;=</span> lwr <span class="sc">&amp;</span> imdb_rating <span class="sc">&lt;=</span> upr))</span>
<span id="cb230-8"><a href="#cb230-8" tabindex="-1"></a></span>
<span id="cb230-9"><a href="#cb230-9" tabindex="-1"></a><span class="co"># Accuracy measure of model is mean of absolute percent error</span></span>
<span id="cb230-10"><a href="#cb230-10" tabindex="-1"></a>rmse_test <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="fu">sum</span>(test_predict<span class="sc">$</span>res<span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="fu">nrow</span>(test_predict))</span>
<span id="cb230-11"><a href="#cb230-11" tabindex="-1"></a></span>
<span id="cb230-12"><a href="#cb230-12" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste0</span>(<span class="st">&quot;RMSE test = &quot;</span>, <span class="fu">round</span>(rmse_test, <span class="dv">5</span>)))</span></code></pre></div>
<pre><code>## [1] &quot;RMSE test = 0.49809&quot;</code></pre>
<p><br />
</p>
<p>The RMSE for the test dataset is 0.498 and the RMSE of the training
dataset is 0.39. I.e. about 0.1 points larger than the RMSE of the
training data set. This is expected because the model was fitted to the
training dataset and not to the test dataset, hence the training RMSE is
smaller.<br />
<br />
</p>
</div>
<div id="interpret-prediction-interval" class="section level3">
<h3>Interpret prediction interval</h3>
<p><br />
</p>
<p><strong>Example 1: highest <code>imdb_rating</code></strong></p>
<table>
<colgroup>
<col width="13%" />
<col width="12%" />
<col width="16%" />
<col width="7%" />
<col width="10%" />
<col width="7%" />
<col width="8%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">audience_score</th>
<th align="right">critics_score</th>
<th align="left">genre</th>
<th align="right">runtime</th>
<th align="right">imdb_rating</th>
<th align="right">fit</th>
<th align="right">res</th>
<th align="right">lwr</th>
<th align="right">upr</th>
<th align="left">interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">97</td>
<td align="right">97</td>
<td align="left">Mystery &amp; Suspense</td>
<td align="right">202</td>
<td align="right">9</td>
<td align="right">8.497676</td>
<td align="right">0.5023236</td>
<td align="right">7.692482</td>
<td align="right">9.302871</td>
<td align="left">TRUE</td>
</tr>
</tbody>
</table>
<p><br />
<br />
<span class="math display">\[
  \begin{aligned}
  \widehat{imdb\_rating\_9.0} = b0\\
  &amp;+ b1 \times (97) + b2 \times (97) + b3 \times (0) + b4 \times (0)
+ b5 \times (0) + b6 \times (0) + b7 \times (0)\\
  &amp;+ b8 \times  (0) + b9 \times (0) + b10 \times (1) + b11 \times
(0) + b12 \times (0) + b13 \times (202\_log)
  \end{aligned}
\]</span><br />
</p>
<p>We are 95% sure that the average <code>imdb_rating</code> is between
7.7 and 9.3 points, for an <code>audience_score</code> of 97,
<code>critics_score</code> of 97, <code>genre</code> “Mystery &amp;
Suspense” and <code>runtime</code> of 202 minutes. The true value is 9.0
points which is inside the interval and is a good prediction.<br />
<br />
<br />
</p>
<p><strong>Example 2: lowest <code>imdb_rating</code></strong></p>
<table>
<colgroup>
<col width="14%" />
<col width="13%" />
<col width="6%" />
<col width="7%" />
<col width="11%" />
<col width="8%" />
<col width="9%" />
<col width="8%" />
<col width="8%" />
<col width="8%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">audience_score</th>
<th align="right">critics_score</th>
<th align="left">genre</th>
<th align="right">runtime</th>
<th align="right">imdb_rating</th>
<th align="right">fit</th>
<th align="right">res</th>
<th align="right">lwr</th>
<th align="right">upr</th>
<th align="left">interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">23</td>
<td align="right">10</td>
<td align="left">Comedy</td>
<td align="right">85</td>
<td align="right">3.4</td>
<td align="right">4.435473</td>
<td align="right">-1.035473</td>
<td align="right">3.648125</td>
<td align="right">5.222821</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p><br />
<br />
<span class="math display">\[
  \begin{aligned}
  \widehat{imdb\_rating\_3.4} = b0\\
  &amp;+ b1 \times (10) + b2 \times (23) + b3 \times (0) + b4 \times (0)
+ b5 \times (1) + b6 \times (0) + b7 \times (0)\\
  &amp;+ b8 \times  (0) + b9 \times (0) + b10 \times (0) + b11 \times
(0) + b12 \times (0) + b13 \times (85\_log)
  \end{aligned}
\]</span><br />
</p>
<p>We are 95% sure that the average <code>imdb_rating</code> is between
3.6 and 5.2 points, for an <code>audience_score</code> of 23,
<code>critics_score</code> of 10, <code>genre</code> “Comedy” and
<code>runtime</code> of 85 minutes. The true value, however, is 3.4
points which is outside the interval and is a bad prediction.<br />
<br />
<br />
</p>
</div>
<div id="prediction-diagnostics" class="section level3">
<h3>Prediction diagnostics</h3>
<p><strong>Number of data points that are outside of the prediction
interval</strong></p>
<p>We noticed that for some data points the predicted interval do not
contain the true response value. We can expect that for 5% of the data
points the intervals will not contain the true value. The prediction
interval is calculated by the standard error (SE) of the point estimate
imdb_rating_hat multiplied by the t-statistics for a 95% confidence
interval.<br />
</p>
<div class="sourceCode" id="cb232"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="#cb232-1" tabindex="-1"></a>total <span class="ot">&lt;-</span> <span class="fu">length</span>(test_predict<span class="sc">$</span>fit)</span>
<span id="cb232-2"><a href="#cb232-2" tabindex="-1"></a></span>
<span id="cb232-3"><a href="#cb232-3" tabindex="-1"></a>test_predict <span class="sc">%&gt;%</span> </span>
<span id="cb232-4"><a href="#cb232-4" tabindex="-1"></a>  <span class="fu">group_by</span>(interval) <span class="sc">%&gt;%</span> </span>
<span id="cb232-5"><a href="#cb232-5" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">n =</span> <span class="fu">n</span>(),</span>
<span id="cb232-6"><a href="#cb232-6" tabindex="-1"></a>            <span class="at">per =</span> <span class="fu">round</span>(n<span class="sc">/</span>total <span class="sc">*</span><span class="dv">100</span>, <span class="dv">1</span>))</span></code></pre></div>
<pre><code>## # A tibble: 2 × 3
##   interval     n   per
##   &lt;lgl&gt;    &lt;int&gt; &lt;dbl&gt;
## 1 FALSE        6   8.3
## 2 TRUE        66  91.7</code></pre>
<p>There are 6 points out of 72 (8.3%) that are outside the prediction
interval, which is higher than 5%. There are some effects that are not
modeled correctly. On the other hand, about 92% were modeled correctly,
which is a pretty good result.<br />
</p>
<table style="width:100%;">
<colgroup>
<col width="13%" />
<col width="12%" />
<col width="16%" />
<col width="6%" />
<col width="10%" />
<col width="7%" />
<col width="9%" />
<col width="7%" />
<col width="7%" />
<col width="7%" />
</colgroup>
<thead>
<tr class="header">
<th align="right">audience_score</th>
<th align="right">critics_score</th>
<th align="left">genre</th>
<th align="right">runtime</th>
<th align="right">imdb_rating</th>
<th align="right">fit</th>
<th align="right">res</th>
<th align="right">lwr</th>
<th align="right">upr</th>
<th align="left">interval</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">35</td>
<td align="right">17</td>
<td align="left">Comedy</td>
<td align="right">97</td>
<td align="right">3.8</td>
<td align="right">4.964209</td>
<td align="right">-1.1642092</td>
<td align="right">4.178525</td>
<td align="right">5.749894</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">46</td>
<td align="right">35</td>
<td align="left">Drama</td>
<td align="right">99</td>
<td align="right">3.5</td>
<td align="right">5.737810</td>
<td align="right">-2.2378104</td>
<td align="right">4.956034</td>
<td align="right">6.519587</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">61</td>
<td align="right">41</td>
<td align="left">Drama</td>
<td align="right">94</td>
<td align="right">5.1</td>
<td align="right">6.272908</td>
<td align="right">-1.1729085</td>
<td align="right">5.490979</td>
<td align="right">7.054838</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">48</td>
<td align="right">51</td>
<td align="left">Comedy</td>
<td align="right">112</td>
<td align="right">6.6</td>
<td align="right">5.777078</td>
<td align="right">0.8229223</td>
<td align="right">4.990685</td>
<td align="right">6.563471</td>
<td align="left">FALSE</td>
</tr>
<tr class="odd">
<td align="right">63</td>
<td align="right">38</td>
<td align="left">Action &amp; Adventure</td>
<td align="right">104</td>
<td align="right">5.2</td>
<td align="right">6.336254</td>
<td align="right">-1.1362544</td>
<td align="right">5.547621</td>
<td align="right">7.124888</td>
<td align="left">FALSE</td>
</tr>
<tr class="even">
<td align="right">23</td>
<td align="right">10</td>
<td align="left">Comedy</td>
<td align="right">85</td>
<td align="right">3.4</td>
<td align="right">4.435473</td>
<td align="right">-1.0354732</td>
<td align="right">3.648125</td>
<td align="right">5.222821</td>
<td align="left">FALSE</td>
</tr>
</tbody>
</table>
<p><br />
<br />
</p>
<p><strong>Relationship between predicted values and true values
(imdb_rating vs imdb_rating_hat)</strong></p>
<div class="sourceCode" id="cb234"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="#cb234-1" tabindex="-1"></a><span class="co"># Fitted vs actual values</span></span>
<span id="cb234-2"><a href="#cb234-2" tabindex="-1"></a>test_predict <span class="sc">%&gt;%</span> </span>
<span id="cb234-3"><a href="#cb234-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> imdb_rating))<span class="sc">+</span></span>
<span id="cb234-4"><a href="#cb234-4" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">size =</span> <span class="fl">0.75</span>, <span class="at">linetype =</span> <span class="dv">6</span>) <span class="sc">+</span></span>
<span id="cb234-5"><a href="#cb234-5" tabindex="-1"></a>  <span class="fu">geom_pointrange</span>(<span class="fu">aes</span>(<span class="at">y =</span> fit, <span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr, <span class="at">color =</span> interval), <span class="at">size =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb234-6"><a href="#cb234-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Predicted values vs true values - test data&quot;</span>,</span>
<span id="cb234-7"><a href="#cb234-7" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Predicted values with prediction interval (95% confidence), n = 72&quot;</span>)<span class="sc">+</span></span>
<span id="cb234-8"><a href="#cb234-8" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="fl">3.</span>,<span class="fl">9.5</span>)<span class="sc">+</span></span>
<span id="cb234-9"><a href="#cb234-9" tabindex="-1"></a>  <span class="fu">xlim</span>(<span class="fl">3.</span>,<span class="fl">9.5</span>)<span class="sc">+</span></span>
<span id="cb234-10"><a href="#cb234-10" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;imdb_rating (truth)&quot;</span>)<span class="sc">+</span></span>
<span id="cb234-11"><a href="#cb234-11" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;imdb_rating (predicted)&quot;</span>)<span class="sc">+</span></span>
<span id="cb234-12"><a href="#cb234-12" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">color=</span><span class="fu">guide_legend</span>(<span class="at">title=</span><span class="st">&quot;In interval&quot;</span>))<span class="sc">+</span></span>
<span id="cb234-13"><a href="#cb234-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb234-14"><a href="#cb234-14" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb234-15"><a href="#cb234-15" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))<span class="sc">+</span></span>
<span id="cb234-16"><a href="#cb234-16" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">y=</span><span class="fl">3.7</span>, <span class="at">x=</span><span class="fl">8.5</span>, <span class="at">label=</span><span class="st">&quot;under estimated&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>)<span class="sc">+</span></span>
<span id="cb234-17"><a href="#cb234-17" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;text&quot;</span>, <span class="at">y=</span><span class="dv">9</span>, <span class="at">x=</span><span class="fl">4.7</span>, <span class="at">label=</span><span class="st">&quot;over estimated&quot;</span>, <span class="at">size =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-190-1.png" width="768" /><br />
</p>
<p>In the ideal case all dots should be on the straight black line.
However, the points, calculated from the model are offset from the ideal
line. There are six points whose prediction interval do not contain the
true response value (red), predominantly in the lower range.<br />
<br />
</p>
<p><strong>Distribution of residuals</strong></p>
<div class="sourceCode" id="cb235"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="#cb235-1" tabindex="-1"></a>test_predict <span class="sc">%&gt;%</span> </span>
<span id="cb235-2"><a href="#cb235-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> res))<span class="sc">+</span></span>
<span id="cb235-3"><a href="#cb235-3" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">fill=</span><span class="st">&quot;darkgrey&quot;</span>, <span class="at">col=</span><span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb235-4"><a href="#cb235-4" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residual distribution - predicted test data&quot;</span>,</span>
<span id="cb235-5"><a href="#cb235-5" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;n = 72&quot;</span>)<span class="sc">+</span></span>
<span id="cb235-6"><a href="#cb235-6" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;residuals&quot;</span>)<span class="sc">+</span></span>
<span id="cb235-7"><a href="#cb235-7" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb235-8"><a href="#cb235-8" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb235-9"><a href="#cb235-9" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-191-1.png" width="672" /><br />
</p>
<p>The distribution is left-skewed due to some extreme residuals.
Besides the few extreme values the distribution is nearly normal
distributed.<br />
<br />
</p>
<p><strong>Residual variability</strong></p>
<div class="sourceCode" id="cb236"><pre
class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="#cb236-1" tabindex="-1"></a>test_predict <span class="sc">%&gt;%</span> </span>
<span id="cb236-2"><a href="#cb236-2" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> fit, <span class="at">y =</span> <span class="fu">abs</span>(res)))<span class="sc">+</span></span>
<span id="cb236-3"><a href="#cb236-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>, <span class="at">col =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.3</span>)<span class="sc">+</span></span>
<span id="cb236-4"><a href="#cb236-4" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;lm&quot;</span>, <span class="at">se =</span> F)<span class="sc">+</span></span>
<span id="cb236-5"><a href="#cb236-5" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">&quot;loess&quot;</span>, <span class="at">se =</span> F, <span class="at">col =</span> <span class="st">&quot;red&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-6"><a href="#cb236-6" tabindex="-1"></a>  <span class="fu">ylim</span>(<span class="dv">0</span>, <span class="fl">2.5</span>)<span class="sc">+</span></span>
<span id="cb236-7"><a href="#cb236-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Residual variability of predictions&quot;</span>,</span>
<span id="cb236-8"><a href="#cb236-8" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Absolute values&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-9"><a href="#cb236-9" tabindex="-1"></a>  <span class="fu">xlab</span>(<span class="st">&quot;imdb_rating (predicted)&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-10"><a href="#cb236-10" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">&quot;abs(residuals)&quot;</span>)<span class="sc">+</span></span>
<span id="cb236-11"><a href="#cb236-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">&quot;plot&quot;</span>,</span>
<span id="cb236-12"><a href="#cb236-12" tabindex="-1"></a>        <span class="at">axis.title.y =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">1</span>),</span>
<span id="cb236-13"><a href="#cb236-13" tabindex="-1"></a>        <span class="at">axis.title.x =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="dv">0</span>))</span></code></pre></div>
<p><img src="project2_files/figure-html/unnamed-chunk-192-1.png" width="672" /><br />
The residuals variability is slightly wider on the left (lower imdb
ratings) due to some larger residuals. The trend line of the residual
distribution is pointing slightly downwards. Some wavy pattern is still
present. In the ideal case the line should be straight and flat.<br />
<br />
<br />
</p>
</div>
<div id="summary-prediction" class="section level3">
<h3>Summary Prediction</h3>
<ul>
<li>We are 95% confident that 92% of the predicted data points contain
the true response within their prediction interval, i.e. 92% of the
predictions are correct.</li>
<li>The model accuracy for the test dataset is about RMSE = 0.5 points,
and about 0.1 points less accurate than for the training dataset, which
is a reasonable good accuracy.</li>
<li>Data points with lower IMDb ratings show larger deviations from the
true value.</li>
<li>The wavy downward trend in the residual distribution suggests that
there is still some underlying non-linear component present which could
not be modeled. Refinement with a more general non-linear approach may
lead to further improvements.<br />
</li>
</ul>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->
<script>
$(document).ready(function () {
  window.initializeCodeFolding("show" === "show");
});
</script>

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = false;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
